{
  "hash": "e68298e52494824322a831e79b437bda",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Predictive Modeling - Linear Regression\"\nformat: html \n---\n\n\n### Learning Objectives of the Chapter {.unnumbered}\n\n::: {style=\"text-align: justify\"}\nAt the End of the Chapter, Students should be Able to -\n\n-   Learn about Linear Regression\n\n-   Identify Linear Relation between Variables\n\n-   Build Linear Regression Model between Variables\n\n-   Learn about How to Evaluate the Fitness of Linear Models\n\n-   Evaluate the Assumptions of Linear Regressions\n\n-   Build Multiple Regression Models and Evaluate them\n:::\n\n::: {style=\"text-align: justify\"}\n## Introduction\n\n     Discussion on predictive analytics.\n:::\n\n::: {style=\"text-align: justify\"}\n## Regression Analysis\n\n### Simple Linear Regression\n\n     Regression analysis is one of very useful predictive modeling techniques that identify the relationship between two or more variables. The objective of linear regression is to identify a linear line of best fit that can predict the outcome variable (target variable/dependent variable/response variable) for one or more independent variables(predictors). For example, we can draw a scatter diagram to see the relation between horsepower and miles per gallon (MPG). @fig-r-hrspower-mpg and @fig-py-hrspower-mpg show the relationship between horsepower and MPG in R and Python respectively. It is clear that there exists a negative relationship between horsepower and MPG and it makes sense because more power means higher fuel consumption. Similarly, there is negative relationship between vehicle weight and MPG because heavier vehicles need more energy to move (@fig-r-weight-mpg and @fig-py-weight-mpg). The equation of a simple linear regression is - $$y= mX + C$$\n\n     where $y$ = Target variable (Dependent variable); $m$ = slope or rate of change; $X$ = predictor or independent variable; and $C$ = intercept or constant.\n:::\n\n::: panel-tabset\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# loading necessary packages \nlibrary(tidyverse)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# loading the dataset \nr_df = read_csv('http://web.pdx.edu/~gerbing/data/cars.csv')\nglimpse (r_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 392\nColumns: 9\n$ Model         <chr> \"amc ambassador dpl\", \"amc gremlin\", \"amc hornet\", \"amc …\n$ MPG           <dbl> 15, 21, 18, 16, 14, 15, 18, 14, 15, 10, 15, 11, 10, 15, …\n$ Cylinders     <dbl> 8, 6, 6, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 6, 8, 8, 8, 6,…\n$ `Engine Disp` <dbl> 390, 199, 199, 304, 455, 350, 307, 454, 400, 307, 383, 3…\n$ Horsepower    <dbl> 190, 90, 97, 150, 225, 165, 130, 220, 150, 200, 170, 210…\n$ Weight        <dbl> 3850, 2648, 2774, 3433, 3086, 3693, 3504, 4354, 3761, 43…\n$ Accelerate    <dbl> 8.5, 15.0, 15.5, 12.0, 10.0, 11.5, 12.0, 9.0, 9.5, 15.0,…\n$ Year          <dbl> 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, …\n$ Origin        <chr> \"American\", \"American\", \"American\", \"American\", \"America…\n```\n\n\n:::\n:::\n\n\n## Python\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# loading necessary modules \nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt \n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n# loading the dataset \npy_df = pd.read_csv(\"http://web.pdx.edu/~gerbing/data/cars.csv\")\npy_df.info()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 392 entries, 0 to 391\nData columns (total 9 columns):\n #   Column       Non-Null Count  Dtype  \n---  ------       --------------  -----  \n 0   Model        392 non-null    object \n 1   MPG          392 non-null    float64\n 2   Cylinders    392 non-null    int64  \n 3   Engine Disp  392 non-null    float64\n 4   Horsepower   392 non-null    int64  \n 5   Weight       392 non-null    int64  \n 6   Accelerate   392 non-null    float64\n 7   Year         392 non-null    int64  \n 8   Origin       392 non-null    object \ndtypes: float64(3), int64(4), object(2)\nmemory usage: 27.7+ KB\n```\n\n\n:::\n:::\n\n:::\n\n::: panel-tabset\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(r_df, aes(x = Horsepower, y = MPG))+\n    geom_point()\n```\n\n::: {.cell-output-display}\n![Relationship between Horsepower and MPG](predictive_files/figure-html/fig-r-hrspower-mpg-1.png){#fig-r-hrspower-mpg width=672}\n:::\n:::\n\n\n## Python\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nsns.set_theme(style=\"darkgrid\")\nsns.scatterplot(x = \"Horsepower\", y = \"MPG\", data = py_df)\n```\n\n::: {.cell-output-display}\n![Relationship between Horsepower and MPG](predictive_files/figure-html/fig-py-hrspower-mpg-1.png){#fig-py-hrspower-mpg width=672}\n:::\n:::\n\n:::\n\n::: panel-tabset\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(r_df, aes(x = Weight, y = MPG))+\n    geom_point()\n```\n\n::: {.cell-output-display}\n![Relationship between Weight and MPG](predictive_files/figure-html/fig-r-weight-mpg-3.png){#fig-r-weight-mpg width=672}\n:::\n:::\n\n\n## Python\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nsns.set_theme(style=\"darkgrid\")\nsns.scatterplot(x = \"Weight\", y = \"MPG\", data = py_df)\n```\n\n::: {.cell-output-display}\n![Relationship between Weight and MPG](predictive_files/figure-html/fig-py-weight-mpg-1.png){#fig-py-weight-mpg width=672}\n:::\n:::\n\n:::\n\n::: {style=\"text-align: justify\"}\n     Now we can quantify these relationships using linear regression in which we will try to draw a line that will help us to idenfity the relation between the variables. For example, in @fig-r-reg-equation, we can see the linear line that shows the relation between horsepower and MPG. The regression equation we find is `y = 40-0.16x`, where $y$ is MPG, $x$ is Horsepower, $40$ is intercept, and $1.6$ is slope, which means one unit change of Horsepower results in 1.6 units reduction of MPG and the value of MPG is 40 when horsepower is 0. @fig-py-reg-equation shows the same results.\n\n::: panel-tabset\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggpubr)\nggplot(r_df, aes (x = Horsepower, y = MPG))+\n    geom_point()+\n    geom_smooth(method = \"lm\")+\n    stat_regline_equation(label.x = 125, label.y = 40)  # to add reg equation\n```\n\n::: {.cell-output-display}\n![Regression of Horsepower and MPG](predictive_files/figure-html/fig-r-reg-equation-3.png){#fig-r-reg-equation width=672}\n:::\n:::\n\n\n## Python\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport plotnine as p9\nfrom scipy import stats\n#calculate best fit line\nslope, intercept, r_value, p_value, std_err = stats.linregress(py_df['Horsepower'],py_df['MPG'])\npy_df['fit']=py_df.Horsepower*slope+intercept\n#format text \ntxt= 'y = {:.4f} x + {:.4f}'.format(round(slope,2), round(intercept,2))\n#create plot.\nplot=(p9.ggplot(data=py_df, mapping= p9.aes('Horsepower','MPG'))\n    + p9.geom_point(p9.aes())\n    + p9.xlab('Horsepower')+ p9.ylab(r'MPG')\n    + p9.geom_line(p9.aes(x='Horsepower', y='fit'), color='blue')\n    + p9.annotate('text', x= 150, y = 40, label = txt))\n# print the plot\nprint(plot)\n```\n\n\n::: {.cell-output-display}\n![Regression of Horsepower and MPG](predictive_files/figure-html/fig-py-reg-equation-1.png){#fig-py-reg-equation width=614}\n:::\n:::\n\n:::\n:::\n\n#### Relationship between Stock Returns and a Market Index\n\n::: {style=\"text-align: justify\"}\n     Now we will try to build a simple linear model between the return of a stock and a market index. Using `tidyquant` package from `R` or `yfinance` module from `python`, we will get share prices of different stocks and a market index. For example, we will get the share price data of Coca-Cola (NYSE:KO) and its competitor PepsiCO (NYSE:PEP). Moreover, we will collect data on US Dollar index (ICE:DX) and SPDR S&P500 ETF (NYSERCA:SPY).\n\n::: panel-tabset\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyquant)\n\ntickers = c(\"KO\", \"SPY\", \"PEP\",\"DX-Y.NYB\")\nprices <- tq_get(tickers,\n                 from = \"2019-01-01\",\n                 to = \"2023-12-31\"\n                 #,get = \"stock.prices\"\n                 )\n\ndf_stockR = prices |>\n    select(symbol, date, adjusted) |>\n    drop_na(adjusted) |>\n    pivot_wider(id_cols = date,names_from = symbol, \n    values_from = adjusted)\n\n\ndf_stockR = as_tibble(na.omit(CalculateReturns(df_stockR, method = \"log\")))\n\n# Linear Regression \nlibrary(fixest)\n# feols(KO ~ SPY, data = df_stockR)\nsummary(lm(KO ~ SPY, data = df_stockR))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = KO ~ SPY, data = df_stockR)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.086587 -0.005091  0.000230  0.005502  0.054322 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -7.427e-05  2.920e-04  -0.254    0.799    \nSPY          6.595e-01  2.198e-02  30.009   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.01034 on 1255 degrees of freedom\nMultiple R-squared:  0.4178,\tAdjusted R-squared:  0.4173 \nF-statistic: 900.5 on 1 and 1255 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nmodel = lm(KO ~ SPY, data = df_stockR)\n# adding fitted value to the dataset \ndf_stockR$fitted = fitted(model)\n# adding residual to the dataset \ndf_stockR$residual = resid(model)\n\n# We can use broom package to simplify all of these processes \nlibrary(broom)\ndf_stockR2 = df_stockR  |>\n    select(KO:DX.Y.NYB)\n\nmodel2 = lm(KO ~ SPY, data = df_stockR2) \n\ntidy(model2) # summary of model components \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term          estimate std.error statistic   p.value\n  <chr>            <dbl>     <dbl>     <dbl>     <dbl>\n1 (Intercept) -0.0000743  0.000292    -0.254 7.99e-  1\n2 SPY          0.660      0.0220      30.0   1.36e-149\n```\n\n\n:::\n\n```{.r .cell-code}\nglance(model2) # information about model fitness \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 12\n  r.squared adj.r.squared  sigma statistic   p.value    df logLik    AIC    BIC\n      <dbl>         <dbl>  <dbl>     <dbl>     <dbl> <dbl>  <dbl>  <dbl>  <dbl>\n1     0.418         0.417 0.0103      901. 1.36e-149     1  3964. -7921. -7906.\n# ℹ 3 more variables: deviance <dbl>, df.residual <int>, nobs <int>\n```\n\n\n:::\n\n```{.r .cell-code}\naugment(model2, data = df_stockR2) # adds info to the dataset \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1,257 × 10\n         KO       SPY      PEP DX.Y.NYB  .fitted   .resid    .hat .sigma .cooksd\n      <dbl>     <dbl>    <dbl>    <dbl>    <dbl>    <dbl>   <dbl>  <dbl>   <dbl>\n 1 -0.00620 -0.0242   -9.38e-3 -5.28e-3 -1.60e-2  9.81e-3 3.56e-3 0.0103 1.61e-3\n 2  0.0197   0.0329    2.03e-2 -1.25e-3  2.17e-2 -1.91e-3 5.53e-3 0.0103 9.54e-5\n 3 -0.0131   0.00785  -8.64e-3 -5.00e-3  5.11e-3 -1.82e-2 1.03e-3 0.0103 1.61e-3\n 4  0.0112   0.00935   9.54e-3  1.98e-3  6.09e-3  5.13e-3 1.14e-3 0.0103 1.41e-4\n 5 -0.0194   0.00466  -2.83e-2 -7.12e-3  3.00e-3 -2.24e-2 8.71e-4 0.0103 2.04e-3\n 6  0.0107   0.00352   6.12e-3  3.36e-3  2.25e-3  8.43e-3 8.35e-4 0.0103 2.78e-4\n 7  0.00572  0.000386  9.26e-5  1.36e-3  1.80e-4  5.54e-3 7.96e-4 0.0103 1.14e-4\n 8 -0.00402 -0.00612  -7.80e-3 -8.37e-4 -4.11e-3  8.86e-5 9.98e-4 0.0103 3.67e-8\n 9  0.00887  0.0114    1.54e-2  3.97e-3  7.44e-3  1.43e-3 1.32e-3 0.0103 1.26e-5\n10 -0.0138   0.00242  -5.98e-3  9.37e-4  1.52e-3 -1.53e-2 8.11e-4 0.0103 8.86e-4\n# ℹ 1,247 more rows\n# ℹ 1 more variable: .std.resid <dbl>\n```\n\n\n:::\n\n```{.r .cell-code}\n# Visualization \nlibrary(ggpubr)\nggplot(df_stockR, aes (x = SPY, y = KO))+\n    geom_point()+\n    geom_smooth(method = \"lm\")+\n    labs(x = \"SPY Returns\", y = \"KO Returns\") + \n    stat_regline_equation(label.x = -0.05, label.y = 0.05)  # to add reg equation\n```\n\n::: {.cell-output-display}\n![Linear Model between SPY and KO](predictive_files/figure-html/fig-r-relation-KO-SPY-3.png){#fig-r-relation-KO-SPY width=672}\n:::\n:::\n\n\n## Python\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport yfinance as yf\nimport datetime\nimport numpy as np\n\nimport plotnine as p9\nfrom scipy import stats\n## To use statsmodels for linear regression\nimport statsmodels.api as sm \nimport statsmodels.formula.api as smf\n## To use sklearn for linear regression\nfrom sklearn.linear_model import LinearRegression\n\n#########################################################\n# Importing stock data \n## 5-year daily data for Coca-Cola, SPY, Pepsi, and USD index\n#########################################################\nend = datetime.date(2023, 12, 31)\nstart = end - pd.Timedelta(days = 365 * 5) \n# Getting the data \nko_df = yf.download(\"KO\", start = start, end = end, progress = False) # CocaCola \nspy_df = yf.download(\"SPY\", start = start, end = end, progress = False) # SPDR S&P 500\npep_df = yf.download(\"PEP\", start = start, end = end, progress = False) # PepsiCo\nusdx_df = yf.download(\"DX-Y.NYB\", start = start, end = end, progress = False) # US Dollar Index\n\n## Calculate log returns for the period based on Adj Close prices\n\nko_df['ko'] = np.log(ko_df['Adj Close'] / ko_df['Adj Close'].shift(1))\nspy_df['spy'] = np.log(spy_df['Adj Close'] / spy_df['Adj Close'].shift(1))\npep_df['pep'] = np.log(pep_df['Adj Close'] / pep_df['Adj Close'].shift(1))\nusdx_df['usdx'] = np.log(usdx_df['Adj Close'] / usdx_df['Adj Close'].shift(1))\n\n## Create a dataframe with X's (spy, pep, usdx) and Y (ko)\n\ndf_stock = pd.concat([spy_df['spy'], ko_df['ko'], \n                pep_df['pep'], usdx_df['usdx']], axis = 1).dropna()\n\n####################################################\n## 2a. Fit a simple linear regression model to the data using statsmodels \n\n### Create an instance of the class OLS\nslr_sm_model = smf.ols('ko ~ spy', data=df_stock)\n\n### Fit the model (statsmodels calculates beta_0 and beta_1 here)\nslr_sm_model_ko = slr_sm_model.fit()\n\n### Summarize the model\n\nprint(slr_sm_model_ko.summary()) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                            OLS Regression Results                            \n==============================================================================\nDep. Variable:                     ko   R-squared:                       0.418\nModel:                            OLS   Adj. R-squared:                  0.417\nMethod:                 Least Squares   F-statistic:                     900.5\nDate:                Tue, 12 Nov 2024   Prob (F-statistic):          1.36e-149\nTime:                        19:56:14   Log-Likelihood:                 3963.5\nNo. Observations:                1257   AIC:                            -7923.\nDf Residuals:                    1255   BIC:                            -7913.\nDf Model:                           1                                         \nCovariance Type:            nonrobust                                         \n==============================================================================\n                 coef    std err          t      P>|t|      [0.025      0.975]\n------------------------------------------------------------------------------\nIntercept  -7.427e-05      0.000     -0.254      0.799      -0.001       0.000\nspy            0.6595      0.022     30.009      0.000       0.616       0.703\n==============================================================================\nOmnibus:                      301.182   Durbin-Watson:                   1.871\nProb(Omnibus):                  0.000   Jarque-Bera (JB):             3723.039\nSkew:                          -0.743   Prob(JB):                         0.00\nKurtosis:                      11.299   Cond. No.                         75.3\n==============================================================================\n\nNotes:\n[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n```\n\n\n:::\n\n```{.python .cell-code}\n## Adding the fitted values to the dataframe \ndf_stock['fitted'] = slr_sm_model_ko.fittedvalues\n\n## Adding the residuals to the dataframe \ndf_stock['residual'] = slr_sm_model_ko.resid\n\n\nparam_slr = slr_sm_model_ko.params\n\n## Linear regression plot of X (spy) and Y (ko)\nplt.figure(figsize = (10, 6))\nplt.rcParams.update({'font.size': 14})\nplt.xlabel(\"SPY Returns\")\nplt.ylabel(\"KO Returns\")\n#plt.title(\"Simple linear regression model\")\nplt.scatter(df_stock['spy'],df_stock['ko'])\nplt.plot(df_stock['spy'], param_slr.Intercept+param_slr.spy * df_stock['spy'],\n         label='Y={:.4f}+{:.4f}X'.format(param_slr.Intercept, param_slr.spy), \n         color='red')\nplt.legend()\nplt.show()\n```\n\n::: {.cell-output-display}\n![Linear Model between SPY and KO](predictive_files/figure-html/fig-py-relation-KO-SPY-1.png){#fig-py-relation-KO-SPY width=960}\n:::\n:::\n\n:::\n:::\n\n### Evaluating Linear Regression Models - Assessing the Fitness\n\n::: {style=\"text-align: justify\"}\n     When we build a linear regression model, we need to check the accuracy of the model by evaluating different parameters of the model. Some of the parameters that need to be evaluated are discussed below -\n\n#### F-statistic and Overall P-value\n\n     The F-statistic of the model tests whether the linear model provides a better fit of the data than the model that contains no independent variables. The null hypothesis is that the model as a whole does not explain a significant amount of variance of the data.\n\n#### Coefficient of Determination ($R^2$) and Adjusted $R^2$\n\n     Coefficient of determination is a statistical metric that measures the proportion of the variance of the target variable explained by the independent variables. The coefficient of determination is represented by $R^2$. The value of $R^2$ ranges between $0$ and $1$, where $0$ indicates poor fit and $1$ indicates perfect fit. There is a problem with $R^2$; it increases as the number of independent variable increases. Therefore, when we compare models with different numbers of independent variables, adjuted $R^2$ is used to evaluate the model because it penalizes models with a large number of predictors.\n\n#### P-value of Parameter Estimates\n\n     In addition to overall p-value associated with the model, linear regression models generate p-value for each predicators (parameter estimates). This p-value tests the null hypothesis that the coefficient is zero (or it does not have any effect on outcome variable). A low p-value (\\<0.05) indicates that we can reject the null hypothesis, meaning that a predictor with a low p-value should be included in the model because it has statistically significant effect on the target variable.\n\n#### Residual Standard Error (RSE)\n\n     Residual Standard Error (RSE) measures how far away an observation is from the prediction (regression line). In another words, it is mean (average) distance between the actual outcome and regression line. For example, @fig-r-relation-KO-SPY regression equation's RSE is 0.01034, which means the regression model predicts CocaCola's return with an avearagr error 0.01034.\n:::\n\n::: {style=\"text-align: justify\"}\n### Assumptions of Linear Regression\n\n     Linear regression follows some assumptions. After fitting a regression model, we should check the assumptions of the model.\n\n1.  **Linearity (Linear Relationship)**:\n\n     There must be a linear relationship between the outcome variable (y) and predictors (x). @fig-assump1 shows what we want to see and @fig-r-assump1 and @fig-py-assump1 show what we see from one of our models.\n\n![Assumption 1- What We Want to See](images/Linear_Reg_Assump1.webp){#fig-assump1 fig-align=\"center\"}\n\n::: panel-tabset\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(lm(KO ~ SPY, data = df_stockR), 1)\n```\n\n::: {.cell-output-display}\n![Testing Assumption 1](predictive_files/figure-html/fig-r-assump1-3.png){#fig-r-assump1 width=672}\n:::\n:::\n\n\n## Python\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nsns.residplot(x = 'fitted', y = 'ko', data=df_stock, \nlowess=True,\nline_kws={'color': 'red', 'lw': 1, 'alpha': 0.8})\nplt.xlabel('Fitted values')\nplt.ylabel('Residuals')\n\n# Diagnostic Plots in Python similar to R - \n# https://towardsdatascience.com/going-from-r-to-python-linear-regression-diagnostic-plots-144d1c4aa5a\n# https://robert-alvarez.github.io/2018-06-04-diagnostic_plots/\n# https://www.kirenz.com/blog/posts/2021-11-14-linear-regression-diagnostics-in-python/\n```\n\n::: {.cell-output-display}\n![Testing Assumption 1](predictive_files/figure-html/fig-py-assump1-1.png){#fig-py-assump1 width=672}\n:::\n:::\n\n:::\n\n2.  **Independence**:\n\n     Indpendence means that each observation (data point) is independent of the others, meaning that the error terms in the model are not correlated with each other and the occurrence of one observation does not influence the probability of another observation occurring; essentially, each data point should be considered a separate, unrelated event from the others. We can check this assumption by Durbin-Watson test. The null hypothesis (H~0~) is there is no correlation among the residuals. Basically, the test detects autocorrelation in the residuals of a linear regression model. The test statistic is a value between 0 and 4, with the following interpretations: 2: No autocorrelation; \\< 2: Positive autocorrelation; \\> 2: Negative autocorrelation. To solve the independence issue, it is suggested that for positive serial correlation, consider adding lags of the dependent and/or independent variable to the model. For negative serial correlation, check to make sure that none of your variables are overdifferenced, and For seasonal correlation, consider adding seasonal dummy variables to the model. However, as a rule of thumb, test statistic values between the range of 1.5 and 2.5 are considered normal. One limitation of the DW test is that it can only test for first-order serial correlation.\n\n     Alternatively, we can can visually examine a scatterplot of the residuals (errors) against the fitted values (@fig-r-assump1 and @fig-py-assump1); if there is no clear pattern, it suggests that the independence assumption is likely satisfied. Independence assmption is important because violating it can lead to unreliable hypothesis tests and confidence intervals.\n\n::: panel-tabset\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\ndurbinWatsonTest(lm(KO ~ SPY, data = df_stockR))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n lag Autocorrelation D-W Statistic p-value\n   1      0.06395532      1.871184    0.02\n Alternative hypothesis: rho != 0\n```\n\n\n:::\n:::\n\n\n## Python\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nfrom statsmodels.stats.stattools import durbin_watson\ndurbin_watson(slr_sm_model_ko.resid)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n1.8711798463493121\n```\n\n\n:::\n:::\n\n:::\n\n3.  **Residual Error**:\n\n     The errors have a mean (expected) value zero ($0$), constant varianace (Homoscedasticity), and are independent from each other (otherwise auto-correlation problem) and predictor variables. We can check the assumption - expected value of errors are equal to 0 - by looking at @fig-r-assump1 and @fig-py-assump1. If there is a pattern in the plot, the assumption is violated.\n\n     The assumption homoscedasticity is tested using the Scale-Location plot, in which fitted values are compared with square root of standardized residuals. Theoretically, we want to see @fig-assump3. @fig-r-assump3 and @fig-py-assump3 show Scale-Location plot (also called spread-location plot) of our model. From @fig-r-assump3 and @fig-py-assump3, it is clear that residual plots have a trend (are not all equally spread out). Thus, the assumption is violated. One solution to the problem is that using log or square root transformation of outcome variable. Moreover, we can use Non-Constant Error Variance (NVC) test to test the assumption. If p-value of the test is less than 0.05, then null hypothesis is rejected, meaning that homoscedasticity is violated. Moreover, Breusch-Pagan test or White test can also be used to test homoscedasticity.\n\n     Finally, testing the assumption - errors are independent from each other and predictors - requires the knowledge of study design and data collection to establish the validity of this assumption. Violation of this assumption is also called endogeneity problem of the model, which is the same as assumption 6 - No Endogeneity below.\n\n![Assumption 3- What We Want to See](images/Linear_Reg_Assump3.webp){#fig-assump3 fig-align=\"center\"}\n\n::: panel-tabset\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Scale-Location Plot \nplot(lm(KO ~ SPY, data = df_stockR),3)\n# Non-Constant Error Variance Test \nncvTest (lm(KO ~ SPY, data = df_stockR))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNon-constant Variance Score Test \nVariance formula: ~ fitted.values \nChisquare = 19.17641, Df = 1, p = 1.1918e-05\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Testing Assumption 3](predictive_files/figure-html/fig-r-assump3-1.png){#fig-r-assump3 width=672}\n:::\n:::\n\n\n## Python\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Scale-Location Plot \nsns.regplot(\n    x = slr_sm_model_ko.fittedvalues, \n    y = np.sqrt(np.abs(slr_sm_model_ko.get_influence().resid_studentized_internal)),\n    scatter=True, \n    ci= False, \n    lowess=True,\n    line_kws={'color': 'blue', 'lw': 1, 'alpha': 0.8} \n)\nplt.title('Scale-Location', fontsize=10)\nplt.xlabel('Fitted Values', fontsize=15)\nplt.ylabel('$\\sqrt{|Standardized Residuals|}$', fontsize=15)\n\n# Non-Constant Error Variance Test \nimport statsmodels.stats.api as sms\n## Breusch-Pagan test \nbp_test = sms.het_white(slr_sm_model_ko.resid, slr_sm_model_ko.model.exog)\nlabels = ['LM Statistic', 'LM-Test p-value', 'F-Statistic', 'F-Test p-value']\nfor stat, value in zip(labels,bp_test):\n    print('{}: {:.3f}'.format(stat, value))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLM Statistic: 15.905\nLM-Test p-value: 0.000\nF-Statistic: 8.035\nF-Test p-value: 0.000\n```\n\n\n:::\n\n```{.python .cell-code}\n## White Test \nwhite_test = sms.het_white(slr_sm_model_ko.resid, slr_sm_model_ko.model.exog)\nfor stat, value in zip(labels,white_test):\n    print('{}: {:.3f}'.format(stat, value))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLM Statistic: 15.905\nLM-Test p-value: 0.000\nF-Statistic: 8.035\nF-Test p-value: 0.000\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Testing Assumption 3](predictive_files/figure-html/fig-py-assump3-1.png){#fig-py-assump3 width=672}\n:::\n:::\n\n:::\n\n4.  **Normality**:\n\n     The residuals are normally distributed. We can test this assumption by Q-Q plots (also called Quantile-Quantile plot) of the residuals. @fig-r-qqplot and @fig-py-qqplot show a QQ plot. The dots do not lie perfectly along the straight line. Moreover, Kolmogorov-Smirnov (KS) test can be used to check the normality assumption. KS tests whether a sample comes from a certain distribution. From the KS result below, we can see test statistic is 0.484 and p-value is 2.2e-16, thus rejecting null hypothesis and indicating that sample data does not come from a normal distribution.\n\n::: panel-tabset\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#######################################\n# Drawing QQ Plot\n########################################\n## qqnorm () function \n#qqnorm((df_stockR$residual))\n## qqline () function \n#qqline(df_stockR$residual)\n# qqPlot () function from car package \nqqPlot(df_stockR$residual) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1]  30 305\n```\n\n\n:::\n\n```{.r .cell-code}\n#########################################\n# Kolmogorov-Smirnov (KS) test\n##########################################\nlibrary(stats)\nks.test(df_stockR$residual, \"pnorm\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tAsymptotic one-sample Kolmogorov-Smirnov test\n\ndata:  df_stockR$residual\nD = 0.48409, p-value < 2.2e-16\nalternative hypothesis: two-sided\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Testing Assumption 4](predictive_files/figure-html/fig-r-qqplot-3.png){#fig-r-qqplot width=672}\n:::\n:::\n\n\n## Python\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n#######################################\n# Drawing QQ Plot\n########################################\nsm.qqplot(slr_sm_model_ko.resid, fit=True, line=\"45\")\n\n#########################################\n# Kolmogorov-Smirnov (KS) test\n##########################################\nfrom scipy.stats import kstest\nks_test = kstest(slr_sm_model_ko.resid, \"norm\")\nlabel_ks = [\"KS Statistic\", \"P-value\"]\n\nfor stat, value in zip(label_ks, ks_test[:2]):\n    print('{}: {:.5f}'.format(stat, value))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nKS Statistic: 0.48409\nP-value: 0.00000\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Testing Assumption 4](predictive_files/figure-html/fig-py-qqplot-1.png){#fig-py-qqplot width=672}\n:::\n:::\n\n:::\n\n5.  **Multicollinearity**:\n\n     There is little or no correlation between the predictor variables. It makes difficult to interpret the coefficients of the model. Variance Inflation Factor (VIF) can be used to test the multicollinearity. A value equal to or greater than 10 of VIF indicates multicollinearity in the data. We see the VIF of SPY and PEP is 1.84 and 1.84 respectively. Moreover, correlation matrix can also be used to identify the predictors that are highly correlated. @fig-r-corplot and @fig-py-corplot show a correlation plot of our stock returns data.\n\n::: panel-tabset\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Variance Inflation Factor (VIF)\nlibrary(car)\nvif(lm(KO ~ SPY+PEP, data = df_stockR))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     SPY      PEP \n1.841296 1.841296 \n```\n\n\n:::\n\n```{.r .cell-code}\n## Correlation Matrix and Correlation Plot \n# to get the function \nsource(\"http://www.sthda.com/upload/rquery_cormat.r\")\nrquery.cormat(df_stockR |> select(KO:DX.Y.NYB), type = c(\"lower\"), graph = TRUE)$r\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         DX.Y.NYB  SPY   KO PEP\nDX.Y.NYB        1              \nSPY         -0.21    1         \nKO          -0.16 0.65    1    \nPEP        -0.081 0.68 0.76   1\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Correlation Plot](predictive_files/figure-html/fig-r-corplot-3.png){#fig-r-corplot width=672}\n:::\n:::\n\n\n## Python\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n## Correlation Matrix and Correlation Plot \n### Correlation Matrix\npd.DataFrame(np.tril(df_stock[['usdx', 'spy', 'ko','pep']].corr()),\ncolumns = ['usdx', 'spy', 'ko','pep'], index = ['usdx', 'spy', 'ko','pep']).replace(0,'')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          usdx       spy        ko  pep\nusdx  1.000000                         \nspy  -0.212245       1.0               \nko   -0.159651  0.646359       1.0     \npep  -0.081497  0.675947  0.759876  1.0\n```\n\n\n:::\n\n```{.python .cell-code}\n### Correlation Plot\nmask = np.triu(np.ones_like(df_stock[['usdx', 'spy', 'ko','pep']].corr()))\nsns.heatmap(df_stock[['usdx', 'spy', 'ko','pep']].corr(), \nannot=True, cmap=\"YlGnBu\", \nmask=mask)\n\n## Variance Inflation Factor (VIF)\n#orrelaiton_coeff = np.corrcoef(df_stock[['ko','spy']], rowvar=False)\n#VIF = np.linalg.inv(correlaiton_coeff)\n#VIF.diagonal()\n\nfrom statsmodels.stats.outliers_influence import variance_inflation_factor\nfrom statsmodels.tools.tools import add_constant\nX = add_constant(df_stock[['ko','spy']])\n\npd.Series([variance_inflation_factor(X.values, i) \n               for i in range(1,X.shape[1])], \n              index=X.columns[1:])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nko     1.717564\nspy    1.717564\ndtype: float64\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Correlation Plot](predictive_files/figure-html/fig-py-corplot-1.png){#fig-py-corplot width=672}\n:::\n:::\n\n:::\n\n6.  **No Endogeneity**:\n\n     There is no relation between the errors and the independent variables.\n:::\n\n::: {style=\"text-align: justify\"}\n### Multiple Linear Regression\n\n      Multiple regression analysis estimates the relationship between an outcome variable and two or more independent variables. More specifically, multiple regression analysis helps to understand how the value of the dependent variable changes when one of the independent variables varies, while the other independent variables remain constant.\n\n     We use Grunfeld dataset for multiple regressions. The dataset contains investment data for 11 US firms. The variables include - `invest`, which is Gross investment in 1947 dollars; `value`, which is market value as of Dec 31 in 1947 dollars; `capital`, which is stock of plant and equipment in 1947 dollars; `firm`, which include 11 US firms (General Motors, US Steel, General Electric, Chrysler, Atlantic Refining, IBM, Union Oil, Westinghouse, Goodyear, Diamond Match, American Steel); and `year`, which is 1935-1954. Our multiple regeression model is @eq-multiple -\n\n$$\ninvest_{it} = \\beta_{0} + \\beta_{1}value_{i} + \\beta_{3}capital_{it} + \\alpha_{it} + \\delta_{t} + \\epsilon_{it}\n$$ {#eq-multiple}\n\nWhere\n\n$invest_{it}$ is the gross investment of firm $i$ in year $t$\n\n$value_{it}$ is the market value of assets of firm $i$ in year $t$\n\n$capital_{it}$ is the stock value of plant and equipment of firm $i$ in year $t$\n\n$alpha_{i}$ is the fixed effect for firm $i$ (capturing unobserved firm-specific factors that don’t vary over time)\n\n$delta_{t}$ is the fixed effect for year $t$ (capturing unobserved year-specific factors that are common to all firms in that year)\n\n$epsilon_{it}$ is the error term, which includes all other unobserved factors that affect investment but are not accounted for by the independent variables or the fixed effects.\n\n     In @tbl-r-multiple and @tbl-py-multiple, we generate some multiple regression models.\n\n::: panel-tabset\n## R\n\n\n::: {#tbl-r-multiple .cell tbl-cap='Regression of Investment on Market Value and PPE'}\n\n```{.r .cell-code}\n#############################################################\n## Grunfeld Data from AER Package\n#############################################################\n# Grunfeld data contains investment data for 11 US firms. The variables \n# include - invest = \nlibrary(AER)\nlibrary(modelsummary)\nlibrary(kableExtra)\nlibrary(fixest)\ndata(\"Grunfeld\", package = \"AER\")\n\nmodels_r = list()\n\n# Model (1)\nmodels_r [['OLS_FYfe']] = feols(invest ~ value + capital | firm + year, data = Grunfeld)\n\n# Model (2)\nmodels_r [['OLS_FYfeC']] = feols(invest ~ value + capital | firm + year,\ncluster = ~firm,  \ndata = Grunfeld)\n\n# Model (3)\nmodels_r [['OLS_FYfeCtwo']] = feols(invest ~ value + capital | firm + year,\ncluster = ~firm+year,  \ndata = Grunfeld)\n\nrows = tribble(\n    ~term, ~'OLS_FYfe',~'OLS_FYfeC', ~'OLS_FYfeCtwo',\n    'Firm Fixed Effects', \"YES\", \"YES\", \"YES\",\n    \"Year Fixed Effects\", \"YES\", \"YES\", \"YES\"\n)\nattr(rows, 'position') = c (5,6)\n\n\n\nmodelsummary(models_r, fmt = 2,\nestimate = \"{estimate}{stars}\",\nstatistic = 'statistic'\n#,vcov = \"robust\" # robust clustering \n#,vcov = ~firm # clusting by firm\n#,vcov = vcovHAC\n,stars = c (\"*\" = 0.10, \"**\" = 0.05, \"***\" =  0.01)\n,coef_rename = c(\n    \"value\" = \"VALUE\",\n    \"capital\" = \"CAPITAL\"\n)\n#,gof_omit = 'DF|Deviance|AIC|BIC'\n,gof_map = c(\"nobs\", \"r.squared\", \"adj.r.squared\")\n,add_rows = rows\n#,notes = list(\n#'Note: In all models both firm and year fixed effects are controlled and in models 2 and 3 starndard errors', \n#'are clustered by firm (one-way cluster) and firm and year (two-way cluster) respectively. The numbers in parentheses indicate t values.')\n#,title = \"Title of the Table\"\n,output = \"kableExtra\"\n) |>\n# The line below is for styling the table, not necessary for regression table\n#kableExtra::kbl() |>\nkable_styling(full_width = TRUE) |>\nrow_spec(c(6,9), extra_css = \"border-bottom: 1.25px solid\") |>\nfootnote('In all models both firm and year fixed effects are controlled and in models 2 and 3 starndard errors are clustered by firm (one-way cluster) and firm and year (two-way cluster) respectively. The numbers in parentheses indicate t values.')\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table\" style=\"width: auto !important; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:center;\"> OLS_FYfe </th>\n   <th style=\"text-align:center;\"> OLS_FYfeC </th>\n   <th style=\"text-align:center;\"> OLS_FYfeCtwo </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> VALUE </td>\n   <td style=\"text-align:center;\"> 0.12*** </td>\n   <td style=\"text-align:center;\"> 0.12*** </td>\n   <td style=\"text-align:center;\"> 0.12*** </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> (10.17) </td>\n   <td style=\"text-align:center;\"> (10.17) </td>\n   <td style=\"text-align:center;\"> (10.28) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> CAPITAL </td>\n   <td style=\"text-align:center;\"> 0.35*** </td>\n   <td style=\"text-align:center;\"> 0.35*** </td>\n   <td style=\"text-align:center;\"> 0.35*** </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;box-shadow: 0px 1.5px\">  </td>\n   <td style=\"text-align:center;box-shadow: 0px 1.5px\"> (7.34) </td>\n   <td style=\"text-align:center;box-shadow: 0px 1.5px\"> (7.34) </td>\n   <td style=\"text-align:center;box-shadow: 0px 1.5px\"> (8.07) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Firm Fixed Effects </td>\n   <td style=\"text-align:center;\"> YES </td>\n   <td style=\"text-align:center;\"> YES </td>\n   <td style=\"text-align:center;\"> YES </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;border-bottom: 1.25px solid\"> Year Fixed Effects </td>\n   <td style=\"text-align:center;border-bottom: 1.25px solid\"> YES </td>\n   <td style=\"text-align:center;border-bottom: 1.25px solid\"> YES </td>\n   <td style=\"text-align:center;border-bottom: 1.25px solid\"> YES </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Num.Obs. </td>\n   <td style=\"text-align:center;\"> 220 </td>\n   <td style=\"text-align:center;\"> 220 </td>\n   <td style=\"text-align:center;\"> 220 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> R2 </td>\n   <td style=\"text-align:center;\"> 0.953 </td>\n   <td style=\"text-align:center;\"> 0.953 </td>\n   <td style=\"text-align:center;\"> 0.953 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;border-bottom: 1.25px solid\"> R2 Adj. </td>\n   <td style=\"text-align:center;border-bottom: 1.25px solid\"> 0.945 </td>\n   <td style=\"text-align:center;border-bottom: 1.25px solid\"> 0.945 </td>\n   <td style=\"text-align:center;border-bottom: 1.25px solid\"> 0.945 </td>\n  </tr>\n</tbody>\n<tfoot>\n<tr><td style=\"padding: 0; \" colspan=\"100%\"><span style=\"font-style: italic;\">Note: </span></td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> In all models both firm and year fixed effects are controlled and in models 2 and 3 starndard errors are clustered by firm (one-way cluster) and firm and year (two-way cluster) respectively. The numbers in parentheses indicate t values.</td></tr>\n</tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n## Python\n\n\n\n\n::: {#tbl-py-multiple .cell tbl-cap='Regression of Investment on Market Value and PPE'}\n\n```{.python .cell-code}\nimport pandas as pd\nimport numpy as np\nfrom statsmodels.datasets import grunfeld\ndata = grunfeld.load_pandas().data\ndata.year = data.year.astype(np.int64)\n\n# Link for pyfixest - \n# https://py-econometrics.github.io/pyfixest/quickstart.html\nimport pyfixest as pf\nfrom pyfixest.estimation import feols\n\n# Model (1)\nfe_model1 = feols(\n  \"invest ~ value + capital | firm + year\", \n  data = data)\n#fe_model1.summary()\n#pf.etable(fe_model1)\n#fe_model1.tidy()\n#fe_model1.coefplot()\n\n\n# Model (2)\nfe_model2 = feols(\n  \"invest ~ value + capital | firm + year\",\n  vcov= {\"CRV1\": \"firm\"}, \n  data = data)\n\n# Model (3)\nfe_model3 = feols(\n  \"invest ~ value + capital | firm + year\",\n  vcov= {\"CRV1\": \"firm+year\"}, \n  data = data)\n\npf.etable([fe_model1, fe_model2, fe_model3]\n#, type = \"gt\"\n,coef_fmt= 'b \\n (t)'\n,signif_code= [0.01,0.05,0.10]\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"litorbhuxw\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>\n#litorbhuxw table {\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n          -webkit-font-smoothing: antialiased;\n          -moz-osx-font-smoothing: grayscale;\n        }\n\n#litorbhuxw thead, tbody, tfoot, tr, td, th { border-style: none; }\n tr { background-color: transparent; }\n#litorbhuxw p { margin: 0; padding: 0; }\n #litorbhuxw .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: hidden; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }\n #litorbhuxw .gt_caption { padding-top: 4px; padding-bottom: 4px; }\n #litorbhuxw .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }\n #litorbhuxw .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }\n #litorbhuxw .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }\n #litorbhuxw .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }\n #litorbhuxw .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }\n #litorbhuxw .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: hidden; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: hidden; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }\n #litorbhuxw .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }\n #litorbhuxw .gt_column_spanner_outer:first-child { padding-left: 0; }\n #litorbhuxw .gt_column_spanner_outer:last-child { padding-right: 0; }\n #litorbhuxw .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; }\n #litorbhuxw .gt_spanner_row { border-bottom-style: hidden; }\n #litorbhuxw .gt_group_heading { padding-top: 0px; padding-bottom: 0px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 0px; font-weight: initial; text-transform: inherit; border-top-style: hidden; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; }\n #litorbhuxw .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 0px; font-weight: initial; border-top-style: hidden; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; vertical-align: middle; }\n #litorbhuxw .gt_from_md> :first-child { margin-top: 0; }\n #litorbhuxw .gt_from_md> :last-child { margin-bottom: 0; }\n #litorbhuxw .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: none; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; }\n #litorbhuxw .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: hidden; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }\n #litorbhuxw .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }\n #litorbhuxw .gt_row_group_first td { border-top-width: 2px; }\n #litorbhuxw .gt_row_group_first th { border-top-width: 2px; }\n #litorbhuxw .gt_striped { background-color: rgba(128,128,128,0.05); }\n #litorbhuxw .gt_table_body { border-top-style: solid; border-top-width: 0.5px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: black; }\n #litorbhuxw .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }\n #litorbhuxw .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }\n #litorbhuxw .gt_left { text-align: left; }\n #litorbhuxw .gt_center { text-align: center; }\n #litorbhuxw .gt_right { text-align: right; font-variant-numeric: tabular-nums; }\n #litorbhuxw .gt_font_normal { font-weight: normal; }\n #litorbhuxw .gt_font_bold { font-weight: bold; }\n #litorbhuxw .gt_font_italic { font-style: italic; }\n #litorbhuxw .gt_super { font-size: 65%; }\n #litorbhuxw .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }\n #litorbhuxw .gt_asterisk { font-size: 100%; vertical-align: 0; }\n \n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n<thead>\n\n<tr class=\"gt_col_headings gt_spanner_row\">\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n  <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"3\" scope=\"colgroup\" id=\"invest\">\n    <span class=\"gt_column_spanner\">invest</span>\n  </th>\n</tr>\n<tr class=\"gt_col_headings\">\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"(1)\">(1)</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"(2)\">(2)</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"(3)\">(3)</th>\n</tr>\n</thead>\n<tbody class=\"gt_table_body\">\n  <tr class=\"gt_group_heading_row\">\n    <th class=\"gt_group_heading\" colspan=\"4\">coef</th>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">value</th>\n    <td class=\"gt_row gt_center\">0.117*** <br> (10.669)</td>\n    <td class=\"gt_row gt_center\">0.117*** <br> (10.669)</td>\n    <td class=\"gt_row gt_center\">0.117*** <br> (10.306)</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">capital</th>\n    <td class=\"gt_row gt_center\">0.351*** <br> (7.701)</td>\n    <td class=\"gt_row gt_center\">0.351*** <br> (7.701)</td>\n    <td class=\"gt_row gt_center\">0.351*** <br> (8.091)</td>\n  </tr>\n  <tr class=\"gt_group_heading_row\">\n    <th class=\"gt_group_heading\" colspan=\"4\">fe</th>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">firm</th>\n    <td class=\"gt_row gt_center\">x</td>\n    <td class=\"gt_row gt_center\">x</td>\n    <td class=\"gt_row gt_center\">x</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">year</th>\n    <td class=\"gt_row gt_center\">x</td>\n    <td class=\"gt_row gt_center\">x</td>\n    <td class=\"gt_row gt_center\">x</td>\n  </tr>\n  <tr class=\"gt_group_heading_row\">\n    <th class=\"gt_group_heading\" colspan=\"4\">modelstats</th>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">Observations</th>\n    <td class=\"gt_row gt_center\">220</td>\n    <td class=\"gt_row gt_center\">220</td>\n    <td class=\"gt_row gt_center\">220</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">S.E. type</th>\n    <td class=\"gt_row gt_center\">by: firm</td>\n    <td class=\"gt_row gt_center\">by: firm</td>\n    <td class=\"gt_row gt_center\">by: firm+year</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">R2</th>\n    <td class=\"gt_row gt_center\">0.953</td>\n    <td class=\"gt_row gt_center\">0.953</td>\n    <td class=\"gt_row gt_center\">0.953</td>\n  </tr>\n</tbody>\n  <tfoot class=\"gt_sourcenotes\">\n  \n  <tr>\n    <td class=\"gt_sourcenote\" colspan=\"4\">Significance levels: * p &lt; 0.1, ** p &lt; 0.05, *** p &lt; 0.01. Format of coefficient cell:\nCoefficient \n (t-stats)</td>\n  </tr>\n\n</tfoot>\n\n</table>\n\n</div>\n        \n```\n\n:::\n:::\n\n:::\n:::\n\n## Time Series Analysis\n\n## Exercises\n\n1.  Calculate a linear model between PepsiCo stock returns and S&P 500 Market index (the Ticker of S&P 500 Index is `^GSPC`)",
    "supporting": [
      "predictive_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}