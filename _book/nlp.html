<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Analytics for Accounting Data - 10&nbsp; Natural Language Processing (NLP)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./machine_learning.html" rel="next">
<link href="./advanced_analytics.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>



<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./advanced_analytics.html">Advanced Techniques and Applications</a></li><li class="breadcrumb-item"><a href="./nlp.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Natural Language Processing (NLP)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Analytics for Accounting Data</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/msharifbd/sharifanalytics" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Analytics-for-Accounting-Data.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Analytics-for-Accounting-Data.epub">
              <i class="bi bi-bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Introduction to Accounting Analytics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Overview of Accounting Analytics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Foundations of Accounting Data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Data Exploration and Management</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis (EDA)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dashboard.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Dashboard for Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_management.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Management in Accounting</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Predictive and Prescriptive Analytics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Predictive Modeling - Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prescriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Prescriptive Analytics in Accounting</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Advanced Techniques and Applications</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./advanced_analytics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Web Scraping and Textual Analytics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nlp.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Natural Language Processing (NLP)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machine_learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Machine Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fraud.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Fraud Detection and Risk Management</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./performance_measurement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Performance Measurement and Management</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Practical Considerations and Future Directions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ethics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Regulatory and Ethical Considerations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./future.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Future Directions in Accounting Analytics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./python_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">A Primer on Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">A Primer on R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1_solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Chapter 1 Solution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2_solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Chapter 2 Solution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-objectives-of-the-chapter" id="toc-learning-objectives-of-the-chapter" class="nav-link active" data-scroll-target="#learning-objectives-of-the-chapter">Learning Objectives of the Chapter</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">10.1</span> Introduction</a></li>
  <li><a href="#python-libraries-for-nlp" id="toc-python-libraries-for-nlp" class="nav-link" data-scroll-target="#python-libraries-for-nlp"><span class="header-section-number">10.2</span> Python Libraries for NLP</a></li>
  <li><a href="#steps-in-nlp" id="toc-steps-in-nlp" class="nav-link" data-scroll-target="#steps-in-nlp"><span class="header-section-number">10.3</span> Steps in NLP</a>
  <ul>
  <li><a href="#sec-preprocessing" id="toc-sec-preprocessing" class="nav-link" data-scroll-target="#sec-preprocessing"><span class="header-section-number">10.3.1</span> Preprocessing</a>
  <ul>
  <li><a href="#tokenization" id="toc-tokenization" class="nav-link" data-scroll-target="#tokenization"><span class="header-section-number">10.3.1.1</span> Tokenization</a></li>
  <li><a href="#removing-punctuation" id="toc-removing-punctuation" class="nav-link" data-scroll-target="#removing-punctuation"><span class="header-section-number">10.3.1.2</span> Removing Punctuation</a></li>
  <li><a href="#filtering-stop-words" id="toc-filtering-stop-words" class="nav-link" data-scroll-target="#filtering-stop-words"><span class="header-section-number">10.3.1.3</span> Filtering Stop Words</a></li>
  <li><a href="#stemming" id="toc-stemming" class="nav-link" data-scroll-target="#stemming"><span class="header-section-number">10.3.1.4</span> Stemming</a></li>
  <li><a href="#lemmatization" id="toc-lemmatization" class="nav-link" data-scroll-target="#lemmatization"><span class="header-section-number">10.3.1.5</span> Lemmatization</a></li>
  <li><a href="#other-steps-in-preprocessing" id="toc-other-steps-in-preprocessing" class="nav-link" data-scroll-target="#other-steps-in-preprocessing"><span class="header-section-number">10.3.1.6</span> Other Steps in Preprocessing</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#visualization-of-words" id="toc-visualization-of-words" class="nav-link" data-scroll-target="#visualization-of-words"><span class="header-section-number">10.4</span> Visualization of Words</a>
  <ul>
  <li><a href="#word-cloud" id="toc-word-cloud" class="nav-link" data-scroll-target="#word-cloud"><span class="header-section-number">10.4.1</span> Word Cloud</a></li>
  <li><a href="#bar-diagram-of-word-frequency" id="toc-bar-diagram-of-word-frequency" class="nav-link" data-scroll-target="#bar-diagram-of-word-frequency"><span class="header-section-number">10.4.2</span> Bar Diagram of Word Frequency</a></li>
  </ul></li>
  <li><a href="#vectorization-of-text" id="toc-vectorization-of-text" class="nav-link" data-scroll-target="#vectorization-of-text"><span class="header-section-number">10.5</span> Vectorization of Text</a></li>
  <li><a href="#topic-modeling" id="toc-topic-modeling" class="nav-link" data-scroll-target="#topic-modeling"><span class="header-section-number">10.6</span> Topic Modeling</a></li>
  <li><a href="#sentiment-analysis" id="toc-sentiment-analysis" class="nav-link" data-scroll-target="#sentiment-analysis"><span class="header-section-number">10.7</span> Sentiment Analysis</a></li>
  <li><a href="#readability-index" id="toc-readability-index" class="nav-link" data-scroll-target="#readability-index"><span class="header-section-number">10.8</span> Readability Index</a></li>
  <li><a href="#text-similarity" id="toc-text-similarity" class="nav-link" data-scroll-target="#text-similarity"><span class="header-section-number">10.9</span> Text Similarity</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">10.10</span> Conclusion</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/msharifbd/sharifanalytics/edit/main/nlp.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/msharifbd/sharifanalytics/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/msharifbd/sharifanalytics/blob/main/nlp.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./advanced_analytics.html">Advanced Techniques and Applications</a></li><li class="breadcrumb-item"><a href="./nlp.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Natural Language Processing (NLP)</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Natural Language Processing (NLP)</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="learning-objectives-of-the-chapter" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="learning-objectives-of-the-chapter">Learning Objectives of the Chapter</h3>
<div style="text-align: justify">
<p>At the End of the Chapter, Students should be Able to -</p>
<ul>
<li><p>Learn about What Natural Language Processing (NLP) is</p></li>
<li><p>Understand the Importance and Difference Concepts of NLP</p></li>
<li><p>Learn about Different R and Python Packages for NLP</p></li>
<li><p>Perform Some NLP on Text Data</p></li>
</ul>
</div>
</section>
<section id="introduction" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">10.1</span> Introduction</h2>
<div style="text-align: justify">
<p>&nbsp;&nbsp;&nbsp;&nbsp;In today’s data driven world, a significant amount data is produced each day. For example, Google processes 24 peta bytes of data every day; 10 million photos are uploaded every hour on Facebook; and 400 million tweets are posted on X (formerly Twitter). Of these amount of data, a significant portion consists of text data. Therefore, it it important to gain insights from text data.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Natural Language Processing (NLP), according to <a href="https://www.ibm.com/topics/natural-language-processing">IBM</a>, is a subfield of computer science and artificial intelligence (AI) that uses machine learning to enable computers to understand and communicate with human language. Specifically, NLP involves understanding, interpreting, and extracting insights from human language. Businesses use NLP for many purposes such as processing and analyzing large volume of documents, analyzing customer reviews, and scaling customer services (like developing chatbots or virtual assistants).</p>
</div>
</section>
<section id="python-libraries-for-nlp" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="python-libraries-for-nlp"><span class="header-section-number">10.2</span> Python Libraries for NLP</h2>
<div style="text-align: justify">
<p>&nbsp;&nbsp;&nbsp;&nbsp;Python has built a rich and efficient ecosystem for NLP. Some of the most popular python modules (libraries) for NLP include - <code>nltk</code> (Natural Language Toolkit); <code>SpaCy</code>; <code>gensim</code>; and <code>TextBlob</code>.</p>
</div>
</section>
<section id="steps-in-nlp" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="steps-in-nlp"><span class="header-section-number">10.3</span> Steps in NLP</h2>
<div style="text-align: justify">
<p>&nbsp;&nbsp;&nbsp;&nbsp;Like other data science tools or techniques, NLP involves several steps because most the time text data is not readily available or even if they are available, we need to clean the data and make it ready for next step processing. In this section, several important steps, which are called preprocessing, of NLP will be discussed.</p>
</div>
<section id="sec-preprocessing" class="level3" data-number="10.3.1">
<h3 data-number="10.3.1" class="anchored" data-anchor-id="sec-preprocessing"><span class="header-section-number">10.3.1</span> Preprocessing</h3>
<div style="text-align: justify">
<p>&nbsp;&nbsp;&nbsp;&nbsp;Before applying NLP techniques, it is necessary to preprosess and clean the text data. Therefore, the processes involving cleaning and preparing text data to get them ready for NLP models are called preprocessing. Preprocessing is very important in NLP to get effective and accurate insights from the data. Below we will discuss several important concepts of preprocessing.</p>
</div>
<div id="d8094edb" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># An exmaple of a text data </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>my_text <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="st">Accounting is the systematic process of recording, analyzing, and reporting financial </span><span class="ch">\</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="st">transactions. It helps businesses track their income, expenses, and overall financial </span><span class="ch">\</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="st">health. Accountants use various financial statements, such as balance sheets and income </span><span class="ch">\</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="st">statements, to summarize a company's financial position. Double-entry bookkeeping is a </span><span class="ch">\</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="st">fundamental principle in accounting, ensuring that every transaction affects at least two </span><span class="ch">\</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="st">accounts. Financial accounting focuses on providing information to external stakeholders, </span><span class="ch">\</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="st">such as investors and creditors, while managerial accounting provides information to </span><span class="ch">\</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="st">internal stakeholders, like managers, to aid in decision-making. Auditing is an essential </span><span class="ch">\</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="st">aspect of accounting, involving the examination of financial records to ensure accuracy </span><span class="ch">\</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="st">and compliance. Tax accounting deals with preparing tax returns and planning for </span><span class="ch">\</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="st">future tax obligations. Forensic accounting involves investigating financial discrepancies </span><span class="ch">\</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="st">and fraud. Accounting software, like QuickBooks and Xero, has revolutionized the way </span><span class="ch">\</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="st">businesses manage their finances, making the process more efficient and accurate. </span><span class="ch">\</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="st">Overall, accounting plays a crucial role in the financial management and transparency </span><span class="ch">\</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="st">of businesses and organizations.</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tokenization" class="level4" data-number="10.3.1.1">
<h4 data-number="10.3.1.1" class="anchored" data-anchor-id="tokenization"><span class="header-section-number">10.3.1.1</span> Tokenization</h4>
<div id="665671ec" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">"punkt_tab"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.tokenize <span class="im">import</span> sent_tokenize, word_tokenize</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="f1d36290" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sentence tokenize</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>my_text_sent <span class="op">=</span> sent_tokenize(my_text)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>my_text_sent[<span class="dv">0</span>:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>['\nAccounting is the systematic process of recording, analyzing, and reporting financial transactions.',
 'It helps businesses track their income, expenses, and overall financial health.',
 "Accountants use various financial statements, such as balance sheets and income statements, to summarize a company's financial position.",
 'Double-entry bookkeeping is a fundamental principle in accounting, ensuring that every transaction affects at least two accounts.',
 'Financial accounting focuses on providing information to external stakeholders, such as investors and creditors, while managerial accounting provides information to internal stakeholders, like managers, to aid in decision-making.']</code></pre>
</div>
</div>
<div id="72ead3c6" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># word tokenize</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>my_text_word <span class="op">=</span> word_tokenize(my_text)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>my_text_word[<span class="dv">0</span>:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>['Accounting', 'is', 'the', 'systematic', 'process']</code></pre>
</div>
</div>
</section>
<section id="removing-punctuation" class="level4" data-number="10.3.1.2">
<h4 data-number="10.3.1.2" class="anchored" data-anchor-id="removing-punctuation"><span class="header-section-number">10.3.1.2</span> Removing Punctuation</h4>
<div style="text-align: justify">
<p>&nbsp;&nbsp;&nbsp;&nbsp;It is evident that in our word tokens, punctuations like comma (,), full stop (.) are also included, but they are unncessary. Therefore, we need to eliminate them from the token list.</p>
</div>
<div id="2f9d7186" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> string</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>my_text_nopunc <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> my_text_word <span class="cf">if</span> x <span class="kw">not</span> <span class="kw">in</span> string.punctuation]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>my_text_nopunc[:<span class="dv">11</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>['Accounting',
 'is',
 'the',
 'systematic',
 'process',
 'of',
 'recording',
 'analyzing',
 'and',
 'reporting',
 'financial']</code></pre>
</div>
</div>
</section>
<section id="filtering-stop-words" class="level4" data-number="10.3.1.3">
<h4 data-number="10.3.1.3" class="anchored" data-anchor-id="filtering-stop-words"><span class="header-section-number">10.3.1.3</span> Filtering Stop Words</h4>
<div style="text-align: justify">
<p>&nbsp;&nbsp;&nbsp;&nbsp;Stop words are the words that we want to ignore. Words like “in”, “an”, “the” we want to ignore. Therefore, in this step, we want to filter out these kinds of words.</p>
</div>
<div id="e7c578da" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">"stopwords"</span>) <span class="co"># to download the stopwords from NLTK repository</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.corpus <span class="im">import</span> stopwords <span class="co"># imports the module </span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>stop_words <span class="op">=</span> <span class="bu">set</span>(stopwords.words(<span class="st">"english"</span>)) <span class="co"># access the stopwords for english </span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print(stop_words)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e7d5428c" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>my_text_nostopwords <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> my_text_nopunc <span class="cf">if</span> x.lower() <span class="kw">not</span> <span class="kw">in</span> stop_words]</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>my_text_nostopwords[<span class="dv">0</span>:<span class="dv">11</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>['Accounting',
 'systematic',
 'process',
 'recording',
 'analyzing',
 'reporting',
 'financial',
 'transactions',
 'helps',
 'businesses',
 'track']</code></pre>
</div>
</div>
<div style="text-align: justify">
<p>&nbsp;&nbsp;&nbsp;&nbsp;Still we can see there are some unnessary words in the list. So, we need to eliminate them. For example, “’s” is in the <code>my_text_nostopwords</code>. We need to get rid of it.</p>
</div>
<div id="9ff748d2" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">"'s"</span> <span class="kw">in</span> my_text_nostopwords</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>my_text_nostopwords <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> my_text_nostopwords <span class="cf">if</span> <span class="st">"'s"</span> <span class="kw">not</span> <span class="kw">in</span> x]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">"'s"</span> <span class="kw">in</span> my_text_nostopwords</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>False</code></pre>
</div>
</div>
</section>
<section id="stemming" class="level4" data-number="10.3.1.4">
<h4 data-number="10.3.1.4" class="anchored" data-anchor-id="stemming"><span class="header-section-number">10.3.1.4</span> Stemming</h4>
<div style="text-align: justify">
<p>&nbsp;&nbsp;&nbsp;&nbsp;Stemming is the process of reducing the words to their base or root form. For example, the token list contains words like recording, reporting, analyzing and so on. The base form of those words are record, report, and analyze respectively. Therefore, we need to reduce those words to base form. Stemming will help to do so. For this purpose, there are several types of stemmers such as Porter stemmer, Lovins stemmer, Dawson stemmer, Krovetz stemmer, and Xerox stemmer.</p>
</div>
<div id="cfb3e2f9" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem <span class="im">import</span> PorterStemmer,SnowballStemmer, LancasterStemmer</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>porter <span class="op">=</span> PorterStemmer()</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>snowball <span class="op">=</span> SnowballStemmer(<span class="st">"english"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>lancaster <span class="op">=</span> LancasterStemmer()</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>[porter.stem(x) <span class="cf">for</span> x <span class="kw">in</span> my_text_nostopwords]</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>[snowball.stem(x) <span class="cf">for</span> x <span class="kw">in</span> my_text_nostopwords]</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>[lancaster.stem(x) <span class="cf">for</span> x <span class="kw">in</span> my_text_nostopwords][<span class="dv">0</span>:<span class="dv">11</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>['account',
 'system',
 'process',
 'record',
 'analys',
 'report',
 'fin',
 'transact',
 'help',
 'busy',
 'track']</code></pre>
</div>
</div>
</section>
<section id="lemmatization" class="level4" data-number="10.3.1.5">
<h4 data-number="10.3.1.5" class="anchored" data-anchor-id="lemmatization"><span class="header-section-number">10.3.1.5</span> Lemmatization</h4>
<div style="text-align: justify">
<p>&nbsp;&nbsp;&nbsp;&nbsp;Lemmatization, like stemming, is the process of reducing a word to its base form, but, unlike stemming, it considers the context of the word.</p>
</div>
<div id="ec3cb8fd" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem <span class="im">import</span> WordNetLemmatizer</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>wordnet <span class="op">=</span> WordNetLemmatizer()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>my_text_lemmatized <span class="op">=</span> [wordnet.lemmatize(x) <span class="cf">for</span> x <span class="kw">in</span> my_text_nostopwords]</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>my_text_lemmatized[:<span class="dv">11</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>['Accounting',
 'systematic',
 'process',
 'recording',
 'analyzing',
 'reporting',
 'financial',
 'transaction',
 'help',
 'business',
 'track']</code></pre>
</div>
</div>
</section>
<section id="other-steps-in-preprocessing" class="level4" data-number="10.3.1.6">
<h4 data-number="10.3.1.6" class="anchored" data-anchor-id="other-steps-in-preprocessing"><span class="header-section-number">10.3.1.6</span> Other Steps in Preprocessing</h4>
<div style="text-align: justify">
<p>&nbsp;&nbsp;&nbsp;&nbsp;In addition to the above preprocessing, we might need to remove many other special characters from the text. These special characters include - hastags, HTML tags, links. For this purpose, knowledge about “regular expression” might be useful. Python built-in package <code>re</code> could be handy for regular expression. To learn more about regular expression - <a href="https://www.w3schools.com/python/python_regex.asp" class="uri">https://www.w3schools.com/python/python_regex.asp</a>.</p>
</div>
</section>
</section>
</section>
<section id="visualization-of-words" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="visualization-of-words"><span class="header-section-number">10.4</span> Visualization of Words</h2>
<section id="word-cloud" class="level3" data-number="10.4.1">
<h3 data-number="10.4.1" class="anchored" data-anchor-id="word-cloud"><span class="header-section-number">10.4.1</span> Word Cloud</h3>
<div style="text-align: justify">
<p>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#fig-wordcloud" class="quarto-xref">Figure&nbsp;<span>10.1</span></a> shows a word cloud of our tokenized text.</p>
</div>
<div id="cell-fig-wordcloud" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> wordcloud <span class="im">import</span> WordCloud</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We need a single string; So, it is tranformed below</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>my_text_lemmatizedSstring <span class="op">=</span> <span class="st">' '</span>.join(my_text_lemmatized)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Word Cloud </span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>word_cloud <span class="op">=</span> WordCloud(collocations <span class="op">=</span> <span class="va">False</span>, background_color <span class="op">=</span> <span class="st">'white'</span>).generate(my_text_lemmatizedSstring)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>plt.imshow(word_cloud, interpolation<span class="op">=</span><span class="st">"bilinear"</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">"off"</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-wordcloud" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-wordcloud-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="nlp_files/figure-html/fig-wordcloud-output-1.png" width="540" height="280" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wordcloud-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.1: Word Cloud of the Words
</figcaption>
</figure>
</div>
</div>
</div>
<div style="text-align: justify">
<p>&nbsp;&nbsp;&nbsp;&nbsp;Now we are going to present a word cloud of customer reviews about many products of a company.</p>
</div>
<div id="a1ae9abc" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>customer_reviews <span class="op">=</span> pd.read_csv(<span class="st">"https://raw.githubusercontent.com/msharifbd/DATA/refs/heads/main/Customer_Reviews2.csv"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>customer_reviews[<span class="st">'ProductId'</span>].value_counts().reset_index()</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>product1_reviews <span class="op">=</span> customer_reviews[customer_reviews[<span class="st">'ProductId'</span>] <span class="op">==</span> <span class="st">"B003VXFK44"</span>][<span class="st">'Text'</span>].to_list()</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the text into a single string </span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>combined_product1_reviews <span class="op">=</span> <span class="st">" "</span>.join(product1_reviews)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the word cloud</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>word_cloud <span class="op">=</span> WordCloud(width<span class="op">=</span><span class="dv">800</span>, height<span class="op">=</span><span class="dv">400</span>, background_color<span class="op">=</span><span class="st">'white'</span>, colormap<span class="op">=</span><span class="st">'viridis'</span>).generate(combined_product1_reviews)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the word cloud</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>plt.imshow(word_cloud, interpolation<span class="op">=</span><span class="st">'bilinear'</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Word Cloud"</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="nlp_files/figure-html/cell-13-output-1.png" width="758" height="409" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bar-diagram-of-word-frequency" class="level3" data-number="10.4.2">
<h3 data-number="10.4.2" class="anchored" data-anchor-id="bar-diagram-of-word-frequency"><span class="header-section-number">10.4.2</span> Bar Diagram of Word Frequency</h3>
<div style="text-align: justify">
<p>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#fig-barword" class="quarto-xref">Figure&nbsp;<span>10.2</span></a> shows the bar diagram of the words in tokenized list.</p>
</div>
<div id="cell-fig-barword" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate word frequencies </span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>word_freq <span class="op">=</span> Counter(my_text_lemmatized)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># extract word and their frequencies </span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>words <span class="op">=</span> <span class="bu">list</span>(word_freq.keys())</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>frequencies <span class="op">=</span> <span class="bu">list</span>(word_freq.values())</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create a data frame </span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>word_df <span class="op">=</span> pd.DataFrame(word_freq.items(), columns <span class="op">=</span> [<span class="st">'Word'</span>, <span class="st">"Frequency"</span>])</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>word_df <span class="op">=</span> word_df.sort_values(by<span class="op">=</span><span class="st">'Frequency'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar diagram </span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>)) </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>sns.barplot(y<span class="op">=</span><span class="st">'Word'</span>, x<span class="op">=</span><span class="st">'Frequency'</span>, data<span class="op">=</span>word_df[word_df[<span class="st">'Frequency'</span>]<span class="op">&gt;</span><span class="dv">1</span>], palette<span class="op">=</span><span class="st">'viridis'</span>) </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Words'</span>) </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Frequencies'</span>) </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-barword" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-barword-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="nlp_files/figure-html/fig-barword-output-1.png" width="869" height="425" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-barword-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.2: Bar Diagram of Word Frequency
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="vectorization-of-text" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="vectorization-of-text"><span class="header-section-number">10.5</span> Vectorization of Text</h2>
<div style="text-align: justify">
<p>&nbsp;&nbsp;&nbsp;&nbsp;Using word clouds or bar diagrams of most frequent words is easy to use and helps to quickly explore datasets. However, they suffer from some shortcomings. For example, they ignore context and are unable to capture the relations between words within the data. Therefore, sometimes we need convert the texts into numbers.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;The process of converting text data into numeric vectors is called text vectorization. Text vectorization actually helps us to capture semantic relationships between words, thus allowing us to understand the meaning of text beyond just keywords. Further, it enhances processing of data. Moreover, vectorized text can be used for various NLP tasks such as document classification, sentiment analysis, and topic modeling. There are several techniques of text vectorization, spanning from simple to complex technieques.</p>
<section id="bag-of-words-bow" class="level3" data-number="10.5.1">
<h3 data-number="10.5.1" class="anchored" data-anchor-id="bag-of-words-bow"><span class="header-section-number">10.5.1</span> Bag of Words (BoW)</h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Bag of Words is the simplest text vectorization technique. BoW counts the frequency of words in text documents. BoW does not consider the order of the words or syntax. “Dog toy” or “toy dog” have equal importance in BoW. In BoW, each document is represented as a vector of word frequencies. Actually, BoW generates <strong>document-term</strong> matrix, which is a <code>m×n</code> matrix, where <code>m</code> is the document and <code>n</code> is the term (word). So, the cell in the matrix contains raw count of the number of times the <span class="math inline">\(j\)</span>-word appear in the $i%-th document.</p>
</section>
<section id="term-frequency-inverse-document-frequency-tf-idf" class="level3" data-number="10.5.2">
<h3 data-number="10.5.2" class="anchored" data-anchor-id="term-frequency-inverse-document-frequency-tf-idf"><span class="header-section-number">10.5.2</span> Term Frequency-Inverse Document Frequency (TF-IDF)</h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;TF-IDF is another text vectorization technique. It is basically an extension of BoW model and considers the <em>importance</em> or <em>significance</em> of words in the texts. Term Frequecny (TF) refers to the frequency at which a particular word appears in a document and IDF measures how rare a word is across a collection of documents. IDF assigns more weights to words that are frequent in a document, but rare across all documents<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Since TF-IDF takes into consideration the <em>significance</em> of the words, it is sometimes called Latent Semantic Analysis (LSA). Unlike BoW, the cell in TF-IDF matrix contains tf-idf score, which is calculated in <a href="#eq-tfidfscore" class="quarto-xref">Equation&nbsp;<span>10.1</span></a><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</p>
<p><span id="eq-tfidfscore"><span class="math display">\[
w_{i,j} = tf_{i,j} × log\frac{N}{df_{i}}
\tag{10.1}\]</span></span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;In <a href="#eq-tfidfscore" class="quarto-xref">Equation&nbsp;<span>10.1</span></a>, <span class="math inline">\(tf_{i,j}\)</span> refers to the occurrences of term <span class="math inline">\(j\)</span> in document <span class="math inline">\(i\)</span>; <span class="math inline">\(N\)</span> is total number of documents; <span class="math inline">\(df_{i}\)</span> is the number of documents that contain the term <span class="math inline">\(j\)</span>; and <span class="math inline">\(w_{i,j}\)</span> is the tf-idf score in the TF-IDF matrix.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">sklearn</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">gensim</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div id="79bef679" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using sklearn package </span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># preprocessing function </span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> string</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.corpus <span class="im">import</span> stopwords</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem <span class="im">import</span> PorterStemmer, WordNetLemmatizer</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Download necessary NLTK data</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">'stopwords'</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">'wordnet'</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> preprocess_text(text):</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Lowercase the text</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> text.lower()</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove punctuation</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> text.translate(<span class="bu">str</span>.maketrans(<span class="st">''</span>, <span class="st">''</span>, string.punctuation))</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove numbers</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="vs">r'\d+'</span>, <span class="st">''</span>, text)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove stopwords</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    stop_words <span class="op">=</span> <span class="bu">set</span>(stopwords.words(<span class="st">'english'</span>))</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> <span class="st">' '</span>.join([word <span class="cf">for</span> word <span class="kw">in</span> text.split() <span class="cf">if</span> word <span class="kw">not</span> <span class="kw">in</span> stop_words])</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Lemmatization</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    lemmatizer <span class="op">=</span> WordNetLemmatizer()</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> <span class="st">' '</span>.join([lemmatizer.lemmatize(word) <span class="cf">for</span> word <span class="kw">in</span> text.split()])</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> text</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> preprocess_documents(documents): </span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [preprocess_text(doc) <span class="cf">for</span> doc <span class="kw">in</span> documents]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3b70e79a" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bag of Words (BoW)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> CountVectorizer</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>texts <span class="op">=</span> [<span class="st">"I love Accounting"</span>, <span class="st">"Accounting is called language of Business"</span>, <span class="st">"I will graduate with an Accounting degree"</span>]</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>texts_processed <span class="op">=</span> preprocess_documents(texts)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>vectorizer <span class="op">=</span> CountVectorizer()</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> vectorizer.fit_transform(texts_processed)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the feature names (terms) </span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>feature_names <span class="op">=</span> vectorizer.get_feature_names_out()</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>feature_names</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>array(['accounting', 'business', 'called', 'degree', 'graduate',
       'language', 'love'], dtype=object)</code></pre>
</div>
</div>
<div id="21c09060" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>texts_processed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>['love accounting',
 'accounting called language business',
 'graduate accounting degree']</code></pre>
</div>
</div>
<div id="da185833" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X.toarray())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 0 0 0 0 0 1]
 [1 1 1 0 0 1 0]
 [1 0 0 1 1 0 0]]</code></pre>
</div>
</div>
<div id="41e1c6a9" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(X.toarray(), columns <span class="op">=</span> feature_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">accounting</th>
<th data-quarto-table-cell-role="th">business</th>
<th data-quarto-table-cell-role="th">called</th>
<th data-quarto-table-cell-role="th">degree</th>
<th data-quarto-table-cell-role="th">graduate</th>
<th data-quarto-table-cell-role="th">language</th>
<th data-quarto-table-cell-role="th">love</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="0a1e427a" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> TfidfVectorizer</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>vectorizer <span class="op">=</span> TfidfVectorizer()</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> vectorizer.fit_transform(texts_processed)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X.toarray())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[0.50854232 0.         0.         0.         0.         0.
  0.861037  ]
 [0.32274454 0.54645401 0.54645401 0.         0.         0.54645401
  0.        ]
 [0.38537163 0.         0.         0.65249088 0.65249088 0.
  0.        ]]</code></pre>
</div>
</div>
<div id="03bd35a9" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(X.toarray(), </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>columns <span class="op">=</span> vectorizer.get_feature_names_out())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">accounting</th>
<th data-quarto-table-cell-role="th">business</th>
<th data-quarto-table-cell-role="th">called</th>
<th data-quarto-table-cell-role="th">degree</th>
<th data-quarto-table-cell-role="th">graduate</th>
<th data-quarto-table-cell-role="th">language</th>
<th data-quarto-table-cell-role="th">love</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.508542</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.861037</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.322745</td>
<td>0.546454</td>
<td>0.546454</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.546454</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.385372</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.652491</td>
<td>0.652491</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div id="cab55e70" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using gensim package</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> string</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.corpus <span class="im">import</span> stopwords</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem <span class="im">import</span> PorterStemmer, WordNetLemmatizer</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gensim <span class="im">import</span> corpora, models, matutils</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Download necessary NLTK data</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">'stopwords'</span>)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">'wordnet'</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> preprocess_text(text):</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Lowercase the text</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> text.lower()</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove punctuation</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> text.translate(<span class="bu">str</span>.maketrans(<span class="st">''</span>, <span class="st">''</span>, string.punctuation))</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove numbers</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="vs">r'\d+'</span>, <span class="st">''</span>, text)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove stopwords</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    stop_words <span class="op">=</span> <span class="bu">set</span>(stopwords.words(<span class="st">'english'</span>))</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> <span class="st">' '</span>.join([word <span class="cf">for</span> word <span class="kw">in</span> text.split() <span class="cf">if</span> word <span class="kw">not</span> <span class="kw">in</span> stop_words])</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Lemmatization</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>    lemmatizer <span class="op">=</span> WordNetLemmatizer()</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> <span class="st">' '</span>.join([lemmatizer.lemmatize(word) <span class="cf">for</span> word <span class="kw">in</span> text.split()])</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> text</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> preprocess_documents(documents):</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [preprocess_text(doc).split() <span class="cf">for</span> doc <span class="kw">in</span> documents]</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample documents</span></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>documents <span class="op">=</span> [<span class="st">"I love Accounting"</span>, <span class="st">"Accounting is called language of Business"</span>, <span class="st">"I will graduate with an Accounting degree"</span>]</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Preprocess the documents</span></span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>texts_processed <span class="op">=</span> preprocess_documents(documents)</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dictionary from the tokenized texts</span></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>dictionary <span class="op">=</span> corpora.Dictionary(texts_processed)</span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a corpus using the dictionary</span></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>corpus <span class="op">=</span> [dictionary.doc2bow(text) <span class="cf">for</span> text <span class="kw">in</span> texts_processed]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4dbbfa05" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a TF-IDF model from the corpus</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>tfidf_model <span class="op">=</span> models.TfidfModel(corpus)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the corpus using the TF-IDF model</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>corpus_tfidf <span class="op">=</span> tfidf_model[corpus]</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the TF-IDF weighted corpus to a dense matrix</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>tfidf_matrix <span class="op">=</span> matutils.corpus2dense(corpus_tfidf, num_terms<span class="op">=</span><span class="bu">len</span>(dictionary)).T</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the dense matrix to a DataFrame for easier inspection</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>df_tfidf_matrix <span class="op">=</span> pd.DataFrame(tfidf_matrix, columns<span class="op">=</span>[dictionary[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dictionary))])</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>df_tfidf_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">accounting</th>
<th data-quarto-table-cell-role="th">love</th>
<th data-quarto-table-cell-role="th">business</th>
<th data-quarto-table-cell-role="th">called</th>
<th data-quarto-table-cell-role="th">language</th>
<th data-quarto-table-cell-role="th">degree</th>
<th data-quarto-table-cell-role="th">graduate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.0</td>
<td>0.0</td>
<td>0.57735</td>
<td>0.57735</td>
<td>0.57735</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0.707107</td>
<td>0.707107</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="e2f53be6" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the corpus to a document-term matrix (DTM)</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>dtm_matrix <span class="op">=</span> matutils.corpus2dense(corpus, num_terms<span class="op">=</span><span class="bu">len</span>(dictionary)).T</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the DTM to a DataFrame for easier inspection</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>df_dtm_matrix <span class="op">=</span> pd.DataFrame(dtm_matrix, columns<span class="op">=</span>[dictionary[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dictionary))])</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>df_dtm_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">accounting</th>
<th data-quarto-table-cell-role="th">love</th>
<th data-quarto-table-cell-role="th">business</th>
<th data-quarto-table-cell-role="th">called</th>
<th data-quarto-table-cell-role="th">language</th>
<th data-quarto-table-cell-role="th">degree</th>
<th data-quarto-table-cell-role="th">graduate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="word-embeddings" class="level3" data-number="10.5.3">
<h3 data-number="10.5.3" class="anchored" data-anchor-id="word-embeddings"><span class="header-section-number">10.5.3</span> Word Embeddings</h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Word embeddings are dense vector representations of words (not documents) that capture semantic relationships. Popular models include Word2Vec, GloVe, and FastText.</p>
<div id="872ebc69" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gensim.models <span class="im">import</span> Word2Vec</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample tokenized texts</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>texts_processed <span class="op">=</span> [</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'love'</span>, <span class="st">'accounting'</span>],</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'accounting'</span>, <span class="st">'called'</span>, <span class="st">'language'</span>, <span class="st">'business'</span>],</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'graduate'</span>, <span class="st">'accounting'</span>, <span class="st">'degree'</span>]</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the Word2Vec model</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Word2Vec(sentences<span class="op">=</span>texts_processed, vector_size<span class="op">=</span><span class="dv">10</span>, window<span class="op">=</span><span class="dv">5</span>, min_count<span class="op">=</span><span class="dv">1</span>, workers<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the word vectors for all terms in the vocabulary</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>word_vectors <span class="op">=</span> {word: model.wv[word] <span class="cf">for</span> word <span class="kw">in</span> model.wv.index_to_key}</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a Data Frame from the word vectors </span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>df_word_vectors <span class="op">=</span> pd.DataFrame(word_vectors).T</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the word vectors</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>df_word_vectors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">accounting</td>
<td>-0.005362</td>
<td>0.002364</td>
<td>0.051033</td>
<td>0.090093</td>
<td>-0.093029</td>
<td>-0.071168</td>
<td>0.064589</td>
<td>0.089730</td>
<td>-0.050154</td>
<td>-0.037634</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">degree</td>
<td>0.073805</td>
<td>-0.015335</td>
<td>-0.045366</td>
<td>0.065541</td>
<td>-0.048602</td>
<td>-0.018160</td>
<td>0.028766</td>
<td>0.009919</td>
<td>-0.082852</td>
<td>-0.094488</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">graduate</td>
<td>0.073118</td>
<td>0.050703</td>
<td>0.067577</td>
<td>0.007629</td>
<td>0.063509</td>
<td>-0.034054</td>
<td>-0.009464</td>
<td>0.057686</td>
<td>-0.075216</td>
<td>-0.039361</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">business</td>
<td>-0.075116</td>
<td>-0.009300</td>
<td>0.095381</td>
<td>-0.073192</td>
<td>-0.023338</td>
<td>-0.019377</td>
<td>0.080774</td>
<td>-0.059309</td>
<td>0.000452</td>
<td>-0.047537</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">language</td>
<td>-0.096036</td>
<td>0.050073</td>
<td>-0.087596</td>
<td>-0.043918</td>
<td>-0.000351</td>
<td>-0.002962</td>
<td>-0.076612</td>
<td>0.096147</td>
<td>0.049821</td>
<td>0.092331</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">called</td>
<td>-0.081579</td>
<td>0.044958</td>
<td>-0.041371</td>
<td>0.008245</td>
<td>0.084986</td>
<td>-0.044622</td>
<td>0.045175</td>
<td>-0.067870</td>
<td>-0.035485</td>
<td>0.093985</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">love</td>
<td>-0.015777</td>
<td>0.003214</td>
<td>-0.041406</td>
<td>-0.076827</td>
<td>-0.015080</td>
<td>0.024698</td>
<td>-0.008880</td>
<td>0.055337</td>
<td>-0.027430</td>
<td>0.022601</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<section id="doc2vec" class="level3" data-number="10.5.4">
<h3 data-number="10.5.4" class="anchored" data-anchor-id="doc2vec"><span class="header-section-number">10.5.4</span> Doc2Vec</h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Doc2Vec is an extension of Word2Vec that generates vector representations for entire documents, capturing the context of the document.</p>
<div id="1ee535e2" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gensim.models <span class="im">import</span> Doc2Vec</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gensim.models.doc2vec <span class="im">import</span> TaggedDocument</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>texts_processed <span class="op">=</span> [[<span class="st">'love'</span>, <span class="st">'accounting'</span>],</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a> [<span class="st">'accounting'</span>, <span class="st">'called'</span>, <span class="st">'language'</span>, <span class="st">'business'</span>],</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a> [<span class="st">'graduate'</span>, <span class="st">'accounting'</span>, <span class="st">'degree'</span>]]</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create tagged documents</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>tagged_data <span class="op">=</span> [TaggedDocument(words<span class="op">=</span>text, tags<span class="op">=</span>[<span class="bu">str</span>(i)]) <span class="cf">for</span> i, text <span class="kw">in</span> <span class="bu">enumerate</span>(texts)]</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Doc2Vec Model </span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Doc2Vec(tagged_data, vector_size<span class="op">=</span><span class="dv">10</span>, window<span class="op">=</span><span class="dv">5</span>, min_count<span class="op">=</span><span class="dv">1</span>, workers<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the document vectors for all documents</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>doc_vectors <span class="op">=</span> {<span class="bu">str</span>(i): model.dv[<span class="bu">str</span>(i)] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(texts_processed))} </span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame for the document vectors </span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>df_doc_vectors <span class="op">=</span> pd.DataFrame(doc_vectors).T </span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the DataFrame </span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>df_doc_vectors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.052996</td>
<td>-0.059291</td>
<td>-0.099730</td>
<td>0.085218</td>
<td>0.036740</td>
<td>0.001727</td>
<td>-0.098661</td>
<td>-0.050780</td>
<td>-0.099170</td>
<td>0.019854</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.026782</td>
<td>0.047362</td>
<td>-0.044838</td>
<td>-0.031941</td>
<td>-0.028554</td>
<td>-0.089483</td>
<td>0.022004</td>
<td>0.094703</td>
<td>-0.100429</td>
<td>-0.035253</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.039851</td>
<td>0.027446</td>
<td>-0.059339</td>
<td>0.025528</td>
<td>0.061253</td>
<td>-0.084000</td>
<td>-0.082807</td>
<td>-0.096986</td>
<td>0.042936</td>
<td>-0.091991</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<section id="bert-bidirectional-encoder-representations-from-transformers" class="level3" data-number="10.5.5">
<h3 data-number="10.5.5" class="anchored" data-anchor-id="bert-bidirectional-encoder-representations-from-transformers"><span class="header-section-number">10.5.5</span> BERT (Bidirectional Encoder Representations from Transformers)</h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;BERT is a transformer-based model that generates contextualized word embeddings. It captures the context of words in a sentence, making it powerful for various NLP tasks.</p>
<div id="14b508e1" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> transformers <span class="im">import</span> BertTokenizer, BertModel</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>tokenizer <span class="op">=</span> BertTokenizer.from_pretrained(<span class="st">'bert-base-uncased'</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> BertModel.from_pretrained(<span class="st">'bert-base-uncased'</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> <span class="st">"I love programming"</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>inputs <span class="op">=</span> tokenizer(text, return_tensors<span class="op">=</span><span class="st">'pt'</span>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>outputs <span class="op">=</span> model(<span class="op">**</span>inputs)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>last_hidden_states <span class="op">=</span> outputs.last_hidden_state</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(last_hidden_states)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</div>
</section>
<section id="topic-modeling" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="topic-modeling"><span class="header-section-number">10.6</span> Topic Modeling</h2>
<div style="text-align: justify">
<p>&nbsp;&nbsp;&nbsp;&nbsp;Topic Modeling is a technique in NLP that tries to identify or extract semantic patterns or topic from a collection of documents. In other words, topic modeling helps to idenfity the cluster of words that appear together often and ultimately, they can be grouped into topics. For example, imagine an auditor is reveiwing important contracts of the client to test some management assertions, but before starting collecting evident to test the assertion, the auditor needs to understand the main themes of those contracts. Topic modeling can be used to figure out the themes (topics) based on the words used in the contracts. <a href="#fig-topicmodeling" class="quarto-xref">Figure&nbsp;<span>10.3</span></a> shows the general process of how topic modeling works.</p>
<div id="fig-topicmodeling" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-topicmodeling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/topic-modeling.avif" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-topicmodeling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.3: Topic Modeling
</figcaption>
</figure>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;There are two commonly used methods for topic modeling. They include - Latent Semantic Analysis (LSA) and Latent Dirichlet Allocation (LDA). LSA assumes that words with similar meaning will appear in similar documents. LSA uses mathmatical techniques to reduce the dimensionality of the data, but LDA is a proabilistic technique, which assumes documents contain topics and topics contain words.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;In LSA, a term-document matrix is created in which rows represent terms and columns represent documents. The values (cells) of the matrix indicates the frequency of each term in each document. Then Singular Value Decomposition (SVD) is applied on the term-document matrix. The SVD technique converts the term-document matrix into three matrices - U (term-topic matrx), <span class="math inline">\(\sum\)</span> (diagonal matrix of singualr values), and V (document-topic matrix). This breakdown helps to reduce the dimensionality of the data while retaining the most improtant relationships between the data. Then, we select the top <span class="math inline">\(k\)</span> singualr values and their associated vectors from <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> matrices to form a reduced dimensional representation of the data.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;In LDA, on the other hand, it is assumed each document is a mixture of topics and that each topic is a mixture of words. Therefore, in LDA documents are mapped to a list of topics by assigning words in the document to different topics. LDA uses Bayesian inferences to find the underlying topics in a corpus of documents. Of the two methods, it is recommended to use LDA because of its probabilistic nature, interpretability and scalability.</p>
<div id="b945744a" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.tokenize <span class="im">import</span> word_tokenize</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> gensim, spacy, logging, warnings</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gensim <span class="im">import</span> corpora, models, matutils, utils</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gensim.utils <span class="im">import</span> simple_preprocess</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gensim.models <span class="im">import</span> CoherenceModel</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyLDAvis </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyLDAvis.gensim_models <span class="im">as</span> gensimvis</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co"># NLTK Stop words</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.corpus <span class="im">import</span> stopwords</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>stop_words <span class="op">=</span> stopwords.words(<span class="st">'english'</span>)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>stop_words.extend(</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'from'</span>, <span class="st">'subject'</span>, <span class="st">'re'</span>, <span class="st">'edu'</span>, <span class="st">'use'</span>, <span class="st">'not'</span>, <span class="st">'would'</span>, <span class="st">'say'</span>, <span class="st">'could'</span>, <span class="st">'_'</span>, <span class="st">'be'</span>, <span class="st">'know'</span>, <span class="st">'good'</span>, <span class="st">'go'</span>, <span class="st">'get'</span>, <span class="st">'do'</span>, <span class="st">'done'</span>, <span class="st">'try'</span>, <span class="st">'many'</span>, <span class="st">'some'</span>, <span class="st">'nice'</span>, <span class="st">'thank'</span>, <span class="st">'think'</span>, <span class="st">'see'</span>, <span class="st">'rather'</span>, <span class="st">'easy'</span>, <span class="st">'easily'</span>, <span class="st">'lot'</span>, <span class="st">'lack'</span>, <span class="st">'make'</span>, <span class="st">'want'</span>, <span class="st">'seem'</span>, <span class="st">'run'</span>, <span class="st">'need'</span>, <span class="st">'even'</span>, <span class="st">'right'</span>, <span class="st">'line'</span>, <span class="st">'even'</span>, <span class="st">'also'</span>, <span class="st">'may'</span>, <span class="st">'take'</span>, <span class="st">'come'</span>]</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="co"># reading the dataset</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span> pd.read_csv(<span class="st">'DATA/tripadvisor_hotel_reviews.csv'</span>)</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>df_500<span class="op">=</span> df[<span class="dv">0</span>:<span class="dv">500</span>]</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sent_to_words(sentences):</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sent <span class="kw">in</span> sentences:</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>        sent <span class="op">=</span> re.sub(<span class="st">'\S*@\S*\s?'</span>, <span class="st">''</span>, sent)  <span class="co"># remove emails</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>        sent <span class="op">=</span> re.sub(<span class="st">'\s+'</span>, <span class="st">' '</span>, sent)  <span class="co"># remove newline chars</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>        sent <span class="op">=</span> re.sub(<span class="st">"</span><span class="ch">\'</span><span class="st">"</span>, <span class="st">""</span>, sent)  <span class="co"># remove single quotes</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>        sent <span class="op">=</span> utils.simple_preprocess(<span class="bu">str</span>(sent), deacc<span class="op">=</span><span class="va">True</span>) </span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span>(sent)  </span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to list</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> df_500.Review.values.tolist()</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>data_words <span class="op">=</span> <span class="bu">list</span>(sent_to_words(data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;In topic modeling, sometimes we use bigrams or trigrams. Specifically, bigrams and trigrams arte sequences of two or three words respectively that appear consecutively in texts. They are also called n-grams, where <span class="math inline">\(n\)</span> represents the number of words in the sequence. In topic modeling, bigrams or trigrams help to capture the context and meaning of texts better than individual words. For example, by considering the triplets such as “machine learning algorithm”, we can identify patterns, relationships, and meanings better. Therefore, bigrams or trigrams enhances the quality and coherence of the topics generated by LDA.</p>
<div id="3ca5d748" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build the bigram and trigram models</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>bigram <span class="op">=</span> gensim.models.Phrases(data_words, min_count<span class="op">=</span><span class="dv">5</span>, threshold<span class="op">=</span><span class="dv">100</span>) </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># higher threshold fewer phrases</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>trigram <span class="op">=</span> gensim.models.Phrases(bigram[data_words], threshold<span class="op">=</span><span class="dv">100</span>)  </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>bigram_mod <span class="op">=</span> gensim.models.phrases.Phraser(bigram)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>trigram_mod <span class="op">=</span> gensim.models.phrases.Phraser(trigram)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Before running the process_words function, please run the following line of code in the terminal - </span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co"># python -m spacy download en_core_web_sm</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_words(texts, stop_words<span class="op">=</span>stop_words, allowed_postags<span class="op">=</span>[<span class="st">'NOUN'</span>, <span class="st">'ADJ'</span>, <span class="st">'VERB'</span>, <span class="st">'ADV'</span>]):</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Remove Stopwords, Form Bigrams, Trigrams and Lemmatization"""</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    texts <span class="op">=</span> [[word <span class="cf">for</span> word <span class="kw">in</span> simple_preprocess(<span class="bu">str</span>(doc)) <span class="cf">if</span> word <span class="kw">not</span> <span class="kw">in</span> stop_words] <span class="cf">for</span> doc <span class="kw">in</span> texts]</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    texts <span class="op">=</span> [bigram_mod[doc] <span class="cf">for</span> doc <span class="kw">in</span> texts]</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    texts <span class="op">=</span> [trigram_mod[bigram_mod[doc]] <span class="cf">for</span> doc <span class="kw">in</span> texts]</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    texts_out <span class="op">=</span> []</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    nlp <span class="op">=</span> spacy.load(<span class="st">"en_core_web_sm"</span>)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">#nlp = spacy.load('en', disable=['parser', 'ner'])</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sent <span class="kw">in</span> texts:</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>        doc <span class="op">=</span> nlp(<span class="st">" "</span>.join(sent)) </span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>        texts_out.append([token.lemma_ <span class="cf">for</span> token <span class="kw">in</span> doc <span class="cf">if</span> token.pos_ <span class="kw">in</span> allowed_postags])</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove stopwords once more after lemmatization</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>    texts_out <span class="op">=</span> [[word <span class="cf">for</span> word <span class="kw">in</span> simple_preprocess(<span class="bu">str</span>(doc)) <span class="cf">if</span> word <span class="kw">not</span> <span class="kw">in</span> stop_words] <span class="cf">for</span> doc <span class="kw">in</span> texts_out]    </span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> texts_out</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>data_ready <span class="op">=</span> process_words(data_words)  <span class="co"># processed Text Data!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3f62c6ba" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># turn our tokenized documents into a term  &lt;-&gt; id dictionary)</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>dictionary <span class="op">=</span> corpora.Dictionary(data_ready)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert tokenized documents into a document-term matrix)</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>corpus <span class="op">=</span> [dictionary.doc2bow(text) <span class="cf">for</span> text <span class="kw">in</span> data_ready]</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the corpus to a document-term matrix </span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>doc_term_matrix <span class="op">=</span> matutils.corpus2csc(corpus).transpose()</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the document-term matrix to a DataFrame </span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>df_doc_term_matrix <span class="op">=</span> pd.DataFrame(doc_term_matrix.toarray(), </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>columns<span class="op">=</span>[dictionary[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dictionary))])</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the DataFrame </span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>df_doc_term_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">advantage</th>
<th data-quarto-table-cell-role="th">advice</th>
<th data-quarto-table-cell-role="th">anniversary</th>
<th data-quarto-table-cell-role="th">arrive</th>
<th data-quarto-table-cell-role="th">aveda</th>
<th data-quarto-table-cell-role="th">bang</th>
<th data-quarto-table-cell-role="th">bed</th>
<th data-quarto-table-cell-role="th">check</th>
<th data-quarto-table-cell-role="th">closing</th>
<th data-quarto-table-cell-role="th">comfortable</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">cushy</th>
<th data-quarto-table-cell-role="th">gouge</th>
<th data-quarto-table-cell-role="th">humor</th>
<th data-quarto-table-cell-role="th">last</th>
<th data-quarto-table-cell-role="th">navigating</th>
<th data-quarto-table-cell-role="th">oxygen</th>
<th data-quarto-table-cell-role="th">replacement</th>
<th data-quarto-table-cell-role="th">extraordinarily</th>
<th data-quarto-table-cell-role="th">ranier</th>
<th data-quarto-table-cell-role="th">seperate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.0</td>
<td>0.0</td>
<td>2.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>2.0</td>
<td>2.0</td>
<td>0.0</td>
<td>1.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">495</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">496</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>2.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">497</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>...</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">498</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>2.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">499</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

<p>500 rows × 4230 columns</p>
</div>
</div>
</div>
</div>
<div id="d89dc80d" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a TF-IDF model from the corpus </span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>tfidf_model <span class="op">=</span> models.TfidfModel(corpus)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the corpus using the TF-IDF model </span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>corpus_tfidf <span class="op">=</span> tfidf_model[corpus]</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the TF-IDF weighted corpus to a document-term matrix </span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>doc_term_matrix_tfidf <span class="op">=</span> matutils.corpus2csc(corpus_tfidf).transpose()</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the document-term matrix to a DataFrame </span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>df_doc_term_matrix_tfidf <span class="op">=</span> pd.DataFrame(doc_term_matrix_tfidf.toarray(), </span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>columns<span class="op">=</span>[dictionary[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dictionary))])</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the DataFrame </span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>df_doc_term_matrix_tfidf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">advantage</th>
<th data-quarto-table-cell-role="th">advice</th>
<th data-quarto-table-cell-role="th">anniversary</th>
<th data-quarto-table-cell-role="th">arrive</th>
<th data-quarto-table-cell-role="th">aveda</th>
<th data-quarto-table-cell-role="th">bang</th>
<th data-quarto-table-cell-role="th">bed</th>
<th data-quarto-table-cell-role="th">check</th>
<th data-quarto-table-cell-role="th">closing</th>
<th data-quarto-table-cell-role="th">comfortable</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">cushy</th>
<th data-quarto-table-cell-role="th">gouge</th>
<th data-quarto-table-cell-role="th">humor</th>
<th data-quarto-table-cell-role="th">last</th>
<th data-quarto-table-cell-role="th">navigating</th>
<th data-quarto-table-cell-role="th">oxygen</th>
<th data-quarto-table-cell-role="th">replacement</th>
<th data-quarto-table-cell-role="th">extraordinarily</th>
<th data-quarto-table-cell-role="th">ranier</th>
<th data-quarto-table-cell-role="th">seperate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.160135</td>
<td>0.173497</td>
<td>0.179099</td>
<td>0.085600</td>
<td>0.23166</td>
<td>0.23166</td>
<td>0.038655</td>
<td>0.060582</td>
<td>0.23166</td>
<td>0.056518</td>
<td>...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.140405</td>
<td>0.033553</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0.015152</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.022154</td>
<td>...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0.040298</td>
<td>0.063157</td>
<td>0.00000</td>
<td>0.029460</td>
<td>...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.026962</td>
<td>0.00000</td>
<td>0.000000</td>
<td>...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">495</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">496</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0.065851</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.048142</td>
<td>...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">497</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0.029146</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.042615</td>
<td>...</td>
<td>0.196603</td>
<td>0.196603</td>
<td>0.196603</td>
<td>0.196603</td>
<td>0.196603</td>
<td>0.196603</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">498</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0.075078</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.253216</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">499</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.067615</td>
<td>...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.311936</td>
<td>0.311936</td>
<td>0.311936</td>
</tr>
</tbody>
</table>

<p>500 rows × 4230 columns</p>
</div>
</div>
</div>
</div>
<div id="102263f2" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an LDA model from the corpus</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>lda_model <span class="op">=</span> models.LdaModel(corpus, num_topics<span class="op">=</span><span class="dv">3</span>, id2word<span class="op">=</span>dictionary, passes<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the topics</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, topic <span class="kw">in</span> lda_model.print_topics(<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Topic: </span><span class="sc">{</span>idx<span class="sc">}</span><span class="ss"> </span><span class="ch">\n</span><span class="ss">Words: </span><span class="sc">{</span>topic<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Topic: 0 
Words: 0.024*"hotel" + 0.015*"room" + 0.012*"service" + 0.007*"stay" + 0.005*"staff" + 0.005*"walk" + 0.005*"desk" + 0.004*"early" + 0.004*"place" + 0.004*"food"

Topic: 1 
Words: 0.041*"room" + 0.034*"hotel" + 0.022*"stay" + 0.016*"great" + 0.011*"night" + 0.011*"location" + 0.010*"staff" + 0.010*"bed" + 0.008*"place" + 0.007*"clean"

Topic: 2 
Words: 0.027*"room" + 0.027*"hotel" + 0.017*"stay" + 0.010*"night" + 0.009*"great" + 0.008*"staff" + 0.008*"service" + 0.008*"desk" + 0.008*"bed" + 0.007*"parking"
</code></pre>
</div>
</div>
<div id="fd865e50" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Topic Membership Likelihood </span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame with topic vectors for each document</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>topic_vectors <span class="op">=</span> []</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> doc <span class="kw">in</span> corpus:</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    topic_vector <span class="op">=</span> lda_model.get_document_topics(doc, minimum_probability<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    topic_vectors.append([prob <span class="cf">for</span> _, prob <span class="kw">in</span> topic_vector])</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>df_topic_vectors <span class="op">=</span> pd.DataFrame(topic_vectors)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the DataFrame of the probabilities</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>df_topic_vectors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.005749</td>
<td>0.030513</td>
<td>0.963738</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.001897</td>
<td>0.002063</td>
<td>0.996041</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.002473</td>
<td>0.002756</td>
<td>0.994771</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.006022</td>
<td>0.988307</td>
<td>0.005671</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.002459</td>
<td>0.002709</td>
<td>0.994832</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">495</td>
<td>0.010624</td>
<td>0.010624</td>
<td>0.978752</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">496</td>
<td>0.005856</td>
<td>0.006518</td>
<td>0.987626</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">497</td>
<td>0.004819</td>
<td>0.148768</td>
<td>0.846413</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">498</td>
<td>0.007564</td>
<td>0.008031</td>
<td>0.984405</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">499</td>
<td>0.013363</td>
<td>0.014839</td>
<td>0.971797</td>
</tr>
</tbody>
</table>

<p>500 rows × 3 columns</p>
</div>
</div>
</div>
</div>
<div id="44ec190f" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the visualization </span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>vis_data <span class="op">=</span> gensimvis.prepare(lda_model, corpus, dictionary) </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>pyLDAvis.display(vis_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">

<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/bmabey/pyLDAvis@3.4.0/pyLDAvis/js/ldavis.v1.0.0.css">


<div id="ldavis_el20138418553442994725138551008" style="background-color:white;"></div>
<script type="text/javascript">

var ldavis_el20138418553442994725138551008_data = {"mdsDat": {"x": [-0.051261866125226624, -0.02813884724957468, 0.07940071337480128], "y": [0.0357269838225964, -0.04340895422031395, 0.007681970397717564], "topics": [1, 2, 3], "cluster": [1, 1, 1], "Freq": [59.90738119435224, 30.276079466755508, 9.816539338892255]}, "tinfo": {"Term": ["hotel", "service", "early", "desk", "food", "leave", "room", "walk", "car", "people", "evening", "area", "lobby", "window", "style", "staff", "coffee", "resort", "bad", "parking", "airport", "lounge", "help", "return", "price", "cab", "manager", "small", "free", "elevator", "fresh", "accommodate", "update", "complete", "snack", "original", "treat", "explore", "paper", "renovate", "direct", "spending", "non_smoke", "win", "literally", "confirmation", "dryer", "sheraton", "suggestion", "read_review", "hide", "cafe", "earplug", "ideal", "lucky", "switch", "refrigerator", "slight", "gorgeous", "appoint", "tower", "complimentary", "new", "wonderful", "moore", "monorail", "block", "market", "great", "helpful", "amazing", "room", "location", "definitely", "stay", "area", "book", "husband", "pike", "hotel", "friendly", "bathroom", "love", "restaurant", "downtown", "bed", "clean", "size", "small", "night", "staff", "place", "view", "comfortable", "really", "time", "feel", "day", "walk", "floor", "check", "ask", "desk", "service", "suppose", "team", "field", "girlfriend", "thread", "bread", "chip", "bride", "seatac", "reply", "embassy", "voucher", "rush", "jet", "steak", "winter", "mediocre", "fare", "sag", "balcony", "muffin", "description", "peak", "boring", "existent", "false", "tap", "tournament", "western", "conditioner", "manager", "pleased", "shabby", "suitcase", "doubletree", "champagne", "accomodation", "non", "smile", "sheet", "elevator", "poor", "airport", "parking", "shuttle", "suite", "employee", "desk", "hotel", "service", "breakfast", "low", "room", "stay", "reception", "night", "pay", "quality", "hour", "price", "tell", "taxi", "free", "staff", "bed", "shower", "charge", "look", "request", "place", "check", "great", "time", "lobby", "little", "day", "location", "clean", "walk", "well", "really", "small", "downtown", "bathroom", "resort", "file", "beach", "starfish", "smash", "host", "dominican", "vendor", "aspect", "theme", "prize", "assistance", "gloomy", "fax", "notify", "recheck", "elbow", "accent", "bird", "booth", "emergency", "catamaran", "abound", "combination", "hesitant", "colony", "rum", "tan", "mosquito", "chicken", "cosy", "visitor", "style", "hill", "service", "early", "cab", "historic", "relatively", "food", "rude", "agency", "boat", "hotel", "evening", "gym", "leave", "lounge", "trendy", "major", "room", "walk", "average", "people", "car", "window", "coffee", "extremely", "help", "desk", "staff", "stay", "lobby", "bad", "internet", "area", "small", "place", "provide", "return", "large", "price", "restaurant", "market", "night", "great", "location", "day"], "Freq": [1049.0, 219.0, 54.0, 199.0, 66.0, 68.0, 1156.0, 168.0, 95.0, 75.0, 37.0, 119.0, 114.0, 60.0, 20.0, 306.0, 58.0, 12.0, 72.0, 150.0, 53.0, 28.0, 45.0, 60.0, 138.0, 22.0, 38.0, 180.0, 106.0, 71.0, 16.627108506786755, 10.893065271086245, 15.450160433248588, 11.777294889008653, 14.503127207478295, 9.936525990535829, 8.93944626939516, 7.9914073846907705, 7.9804861775626055, 7.055355219644603, 7.046524147496146, 7.044779504065395, 7.027931013107619, 7.8973862745857115, 8.76396856345773, 6.986117053926101, 6.971502702144253, 22.5739318687345, 6.090196428666103, 6.083867355350741, 6.959236863241505, 6.079728568081595, 7.831590579549695, 6.073699947965755, 6.068644393241658, 10.447138202889299, 6.058584840851371, 6.903833174727789, 6.037530597710156, 7.777169438185498, 38.56602809375885, 20.306791434867506, 51.938646506845515, 43.13761730790126, 15.154829753365592, 21.499634490097115, 83.34121845316747, 103.12776006151225, 334.48228000303504, 88.94069895295294, 19.553800011539984, 828.5301033069658, 218.93333191937498, 66.1590075487135, 453.0944426807835, 93.21390910208743, 82.13195299347014, 29.019417465188877, 39.22899496788382, 693.3980636915568, 112.9332724565905, 125.47487880249129, 68.06275487494321, 121.06640189692692, 114.31741945670511, 197.272882076521, 134.60247396187154, 42.08931890908518, 130.23333686931906, 224.5007925231515, 204.51768459435613, 172.27252098416457, 98.04275025688514, 98.81624361096343, 94.45338344205854, 120.2056953348266, 70.09943170431104, 111.4939036991895, 110.69996767534653, 75.8680715036961, 101.6071895305191, 80.20927059696211, 102.34842594464403, 98.43330385967128, 13.725609107868626, 7.952374031440369, 5.381697541312316, 6.124703903759562, 4.5460936135165, 4.540915062179278, 4.525447992301338, 4.51402978226539, 3.693051945100801, 3.692740171811688, 3.6925005765847043, 3.6913487225309796, 3.6891830811730792, 3.6894798797605057, 3.689119588437929, 3.682658004660209, 3.6831470784172895, 5.023760241840517, 3.6076033023373597, 5.814211251135098, 3.5789102764358787, 2.841397832543372, 2.840498152466048, 2.8406514934113174, 2.8402714354825145, 2.83983507267537, 2.840033637219733, 2.8397212649425527, 2.8386200253805285, 2.838667944425925, 30.514615701288786, 5.651622529091947, 5.64243105719678, 7.613950565230267, 5.316659416947559, 6.121386108853903, 6.106456331272474, 7.059989628777792, 5.9973596396057305, 21.695949187404377, 42.06799098858698, 10.289496089244935, 29.763098916379075, 68.72468028426638, 23.825763871013464, 24.74971734078343, 8.713564473639552, 80.8108985847107, 274.4355739794967, 80.85881763010745, 39.832363864885025, 16.014589296715336, 279.3361780817511, 174.476541119939, 18.03397933211212, 100.78180286902017, 45.068226380401036, 15.674388033921012, 28.556705801136047, 50.19115568567822, 33.3044193971475, 13.07981012293712, 40.453612724883634, 83.97513690939518, 78.74328761393114, 30.556250163881764, 26.7095392108475, 35.50698956738249, 24.209973985100174, 66.60379771071925, 48.75581735129081, 90.90074236726228, 51.33894620435328, 38.519547341720326, 40.30339130946932, 45.761849770614646, 59.32095576941927, 48.03031342017473, 40.5058924034115, 33.76436077057925, 34.99152918795404, 37.701787268454126, 34.80861021191325, 34.396465690312496, 12.019187578750287, 2.8898829738099776, 2.888988237302668, 2.888668952124023, 2.2234740174981718, 2.2226159871336626, 2.22223047552806, 2.221863414100056, 2.221310879834092, 2.211144055127959, 2.206424305485971, 2.205210672224808, 2.19567115355701, 6.749954359110839, 1.5563712374024798, 1.5561169162702198, 1.5561121580665234, 1.5559814531241705, 1.555709847088687, 1.5557068367965525, 1.5556927563978593, 1.5556533312815182, 1.5556086624304912, 1.555589532509508, 1.5555193247284373, 1.555392309821604, 1.5553975535562898, 1.5553648287676027, 1.5553350171648521, 1.5553153046066814, 2.851924549481638, 3.5424713876140403, 8.991236876451483, 4.087494294959236, 40.04459795052483, 14.95783009927932, 7.770435624185376, 2.8620999195331844, 2.21305510510233, 14.391876533617264, 6.0429777349335305, 2.2327161969880467, 2.232442940147199, 81.61166571396522, 9.698552983896594, 5.0508231246315445, 13.753001651290875, 7.9004755832950755, 4.686904053190907, 5.014607562342839, 48.863531143148855, 17.062562658004076, 6.89760860566724, 10.961739926264999, 12.201501746305281, 9.715516271392678, 9.466250876219304, 6.437205204433151, 8.153950726359147, 16.008833007623394, 18.145750444575057, 24.012451686913273, 11.558967902442596, 9.445093377824184, 7.374820312905588, 11.161970575754513, 13.06066864175458, 14.70621318041797, 7.336303333727016, 8.230492938930205, 9.152925687575765, 9.918108543614748, 9.719597839102168, 8.963232225831115, 9.833772199176671, 10.089250060465918, 9.424377906841835, 9.061935626458629], "Total": [1049.0, 219.0, 54.0, 199.0, 66.0, 68.0, 1156.0, 168.0, 95.0, 75.0, 37.0, 119.0, 114.0, 60.0, 20.0, 306.0, 58.0, 12.0, 72.0, 150.0, 53.0, 28.0, 45.0, 60.0, 138.0, 22.0, 38.0, 180.0, 106.0, 71.0, 17.186941062794507, 11.416403778746737, 16.192884947269363, 12.353941090463291, 15.237225332176427, 10.453269116634367, 9.481157507027477, 8.52551665141588, 8.519979857470386, 7.565899527379041, 7.563720027633187, 7.564686865571813, 7.562464598133615, 8.507542995906427, 9.46425506288419, 7.557661012320987, 7.547471911975883, 24.467995950776107, 6.6021610136764535, 6.601506345196406, 7.554341778118019, 6.600730629967127, 8.507039127627849, 6.600214757827364, 6.599598202812608, 11.364109749413373, 6.598325046833969, 7.5280124090602465, 6.596424432371724, 8.501053636592962, 42.64065975733188, 22.621283234139764, 59.28287720891924, 49.0637857269572, 16.947724834912755, 24.466416955115374, 100.39558458551129, 126.15102002720306, 435.47227243076327, 108.94082415351993, 22.296456307366352, 1156.7298125318655, 287.67866559563606, 81.41325810716476, 651.5834354876358, 119.28898382742524, 104.16363072547804, 34.14098053902322, 47.402285243549656, 1049.4453033850189, 148.74668106767072, 167.46923172554304, 86.22141973672198, 162.11079711355455, 152.7873438938764, 279.9152255241682, 185.9180166829679, 51.3226060920839, 180.99579277952776, 335.1163675913483, 306.6385719483264, 253.58253187530178, 135.406979330007, 137.30478240606024, 130.71119259899604, 178.21423469316926, 93.94577293071515, 166.31768909626277, 168.26842273676212, 104.70074727825323, 159.26219951226, 116.36834112368466, 199.16815753697813, 219.33671944030357, 14.472020789750113, 8.503874519447118, 5.944766955705846, 6.78437565225237, 5.0916345739781566, 5.091337998141249, 5.092857860540779, 5.089605920503145, 4.2383228582564865, 4.238753418387687, 4.238536595607589, 4.238776010339862, 4.23810004175747, 4.2388349195275135, 4.238742967151333, 4.2384668669146235, 4.239036672692448, 5.866640006350153, 4.220950776203211, 6.850308872970542, 4.250495606718658, 3.385526533828867, 3.3852763020371093, 3.385537979220454, 3.3856472850029657, 3.385210684001618, 3.38557306053839, 3.385500014848157, 3.3852109511662407, 3.3853794296334083, 38.486142169485824, 6.855631406883316, 6.87395325839309, 9.508022770016188, 6.618030047888066, 7.774182685541739, 7.770494369362221, 9.292902836906002, 7.777379805950422, 33.52613178508046, 71.84560889531305, 14.566758961564448, 53.976691931774134, 150.8298426808593, 42.06562932522169, 45.06975138938646, 12.251018680862524, 199.16815753697813, 1049.4453033850189, 219.33671944030357, 89.20652279626917, 27.543594776934277, 1156.7298125318655, 651.5834354876358, 32.2549073208303, 335.1163675913483, 114.09660306627111, 27.495458296787035, 62.82031490127782, 138.40170741517363, 79.74849549734809, 21.776140559640496, 106.46820474192965, 306.6385719483264, 279.9152255241682, 72.82051729587926, 60.5770461868275, 94.71133389971267, 53.15079252511284, 253.58253187530178, 159.26219951226, 435.47227243076327, 178.21423469316926, 114.14149015983193, 123.85447170595482, 166.31768909626277, 287.67866559563606, 185.9180166829679, 168.26842273676212, 113.21590575811452, 130.71119259899604, 180.99579277952776, 152.7873438938764, 167.46923172554304, 12.902997143291357, 3.4981756641755717, 3.4984445987083914, 3.4985284332674773, 2.830300092675164, 2.830551981752449, 2.830677665183682, 2.830794262187793, 2.8310522254801342, 2.8350945117492863, 2.836158052231231, 2.83520465695851, 2.8409273705433047, 9.27569796877526, 2.162628711970371, 2.162725721390151, 2.1627388717715395, 2.162717105842058, 2.1627119184676182, 2.162847118529636, 2.162859661974872, 2.1628285703350016, 2.1628516395120467, 2.1628739263413754, 2.1628669530821982, 2.1628729650750467, 2.162948615625811, 2.162978425585128, 2.1629411982150546, 2.1629365605739386, 4.475200500064696, 6.095662622559537, 20.041385707185256, 7.768835701661967, 219.33671944030357, 54.66787742176904, 22.81144788169368, 5.32343581760149, 3.686633254834617, 66.82894824955268, 17.894954248219435, 3.7865251680179455, 3.7864970410849614, 1049.4453033850189, 37.78636977563443, 13.912954158684649, 68.54289064564126, 28.39992193124879, 12.929345411495888, 14.733607407344685, 1156.7298125318655, 168.26842273676212, 28.076540864719806, 75.30345458015823, 95.03494671489591, 60.832708023336274, 58.39000968207388, 26.506101688937257, 45.04565524260648, 199.16815753697813, 306.6385719483264, 651.5834354876358, 114.14149015983193, 72.4887793576008, 39.818473830194975, 119.28898382742524, 180.99579277952776, 253.58253187530178, 39.878941214846556, 60.62319709451651, 97.89407144373067, 138.40170741517363, 162.11079711355455, 126.15102002720306, 335.1163675913483, 435.47227243076327, 287.67866559563606, 166.31768909626277], "Category": ["Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3"], "logprob": [30.0, 29.0, 28.0, 27.0, 26.0, 25.0, 24.0, 23.0, 22.0, 21.0, 20.0, 19.0, 18.0, 17.0, 16.0, 15.0, 14.0, 13.0, 12.0, 11.0, 10.0, 9.0, 8.0, 7.0, 6.0, 5.0, 4.0, 3.0, 2.0, 1.0, -7.1104, -7.5333, -7.1838, -7.4552, -7.2471, -7.6252, -7.7309, -7.8431, -7.8444, -7.9676, -7.9689, -7.9691, -7.9715, -7.8549, -7.7508, -7.9775, -7.9796, -6.8046, -8.1147, -8.1158, -7.9814, -8.1165, -7.8633, -8.1175, -8.1183, -7.5751, -8.1199, -7.9893, -8.1234, -7.8702, -6.269, -6.9105, -5.9714, -6.157, -7.2031, -6.8534, -5.4985, -5.2855, -4.1088, -5.4335, -6.9483, -3.2018, -4.5327, -5.7294, -3.8053, -5.3865, -5.5131, -6.5535, -6.252, -3.3798, -5.1946, -5.0893, -5.701, -5.1251, -5.1824, -4.6368, -5.0191, -6.1816, -5.0521, -4.5075, -4.6008, -4.7723, -5.336, -5.3282, -5.3733, -5.1322, -5.6715, -5.2075, -5.2146, -5.5924, -5.3003, -5.5368, -5.293, -5.332, -6.6197, -7.1655, -7.556, -7.4266, -7.7247, -7.7259, -7.7293, -7.7318, -7.9325, -7.9326, -7.9327, -7.933, -7.9336, -7.9335, -7.9336, -7.9353, -7.9352, -7.6248, -7.9559, -7.4787, -7.9639, -8.1947, -8.195, -8.1949, -8.1951, -8.1952, -8.1952, -8.1953, -8.1957, -8.1956, -5.8208, -7.507, -7.5087, -7.209, -7.5681, -7.4272, -7.4296, -7.2845, -7.4477, -6.1619, -5.4997, -6.9079, -5.8457, -5.0089, -6.0682, -6.0302, -7.0741, -4.8469, -3.6243, -4.8463, -5.5543, -6.4655, -3.6066, -4.0772, -6.3467, -4.626, -5.4308, -6.487, -5.8871, -5.3231, -5.7333, -6.6679, -5.5388, -4.8085, -4.8728, -5.8194, -5.954, -5.6693, -6.0522, -5.0402, -5.3522, -4.7292, -5.3005, -5.5878, -5.5425, -5.4155, -5.156, -5.3671, -5.5375, -5.7196, -5.6839, -5.6093, -5.6891, -5.701, -5.6262, -7.0515, -7.0518, -7.0519, -7.3136, -7.314, -7.3142, -7.3143, -7.3146, -7.3192, -7.3213, -7.3219, -7.3262, -6.2032, -7.6703, -7.6705, -7.6705, -7.6706, -7.6708, -7.6708, -7.6708, -7.6708, -7.6708, -7.6708, -7.6709, -7.671, -7.671, -7.671, -7.671, -7.671, -7.0647, -6.8479, -5.9164, -6.7048, -4.4227, -5.4075, -6.0624, -7.0611, -7.3183, -5.446, -6.3138, -7.3095, -7.3096, -3.7107, -5.8407, -6.4931, -5.4914, -6.0458, -6.5679, -6.5003, -4.2237, -5.2758, -6.1815, -5.7183, -5.6111, -5.839, -5.865, -6.2506, -6.0142, -5.3396, -5.2143, -4.9341, -5.6652, -5.8672, -6.1146, -5.7002, -5.5431, -5.4244, -6.1199, -6.0048, -5.8986, -5.8183, -5.8385, -5.9196, -5.8269, -5.8012, -5.8694, -5.9086], "loglift": [30.0, 29.0, 28.0, 27.0, 26.0, 25.0, 24.0, 23.0, 22.0, 21.0, 20.0, 19.0, 18.0, 17.0, 16.0, 15.0, 14.0, 13.0, 12.0, 11.0, 10.0, 9.0, 8.0, 7.0, 6.0, 5.0, 4.0, 3.0, 2.0, 1.0, 0.4793, 0.4654, 0.4654, 0.4646, 0.463, 0.4617, 0.4535, 0.4477, 0.447, 0.4425, 0.4415, 0.4412, 0.4391, 0.4379, 0.4355, 0.4337, 0.433, 0.4318, 0.4317, 0.4307, 0.4303, 0.4302, 0.4296, 0.4292, 0.4285, 0.4282, 0.427, 0.4258, 0.4238, 0.4234, 0.4119, 0.4044, 0.3801, 0.3836, 0.4006, 0.3831, 0.3262, 0.3109, 0.2485, 0.3095, 0.3811, 0.1787, 0.2393, 0.3049, 0.1491, 0.2657, 0.2747, 0.3498, 0.3231, 0.098, 0.2369, 0.2237, 0.2759, 0.2204, 0.2223, 0.1625, 0.1894, 0.314, 0.1832, 0.1118, 0.1074, 0.1258, 0.1895, 0.1834, 0.1875, 0.1186, 0.2196, 0.1124, 0.0936, 0.1903, 0.0629, 0.1402, -0.1534, -0.2889, 1.1419, 1.1278, 1.0953, 1.0925, 1.0815, 1.0804, 1.0767, 1.0748, 1.0571, 1.0569, 1.0569, 1.0565, 1.0561, 1.056, 1.0559, 1.0542, 1.0542, 1.0397, 1.0378, 1.0308, 1.0228, 1.0196, 1.0194, 1.0193, 1.0192, 1.0191, 1.0191, 1.019, 1.0187, 1.0187, 0.9627, 1.0017, 0.9974, 0.9727, 0.9759, 0.9558, 0.9538, 0.92, 0.9349, 0.7596, 0.6596, 0.8472, 0.5995, 0.4088, 0.6263, 0.5954, 0.8541, 0.2928, -0.1465, 0.1969, 0.3885, 0.6525, -0.2261, -0.1228, 0.6134, -0.0067, 0.2659, 0.6328, 0.4064, 0.1805, 0.3216, 0.6851, 0.2271, -0.1003, -0.0735, 0.3264, 0.3759, 0.2137, 0.4084, -0.1421, 0.0111, -0.3719, -0.0497, 0.1085, 0.0721, -0.0956, -0.3841, -0.1587, -0.2293, -0.0151, -0.1231, -0.374, -0.2844, -0.388, 2.2501, 2.1301, 2.1297, 2.1296, 2.0798, 2.0793, 2.0791, 2.0789, 2.0786, 2.0725, 2.07, 2.0698, 2.0635, 2.0032, 1.9921, 1.9919, 1.9919, 1.9918, 1.9917, 1.9916, 1.9916, 1.9916, 1.9915, 1.9915, 1.9915, 1.9914, 1.9914, 1.9913, 1.9913, 1.9913, 1.8705, 1.7783, 1.5196, 1.6789, 0.6205, 1.0251, 1.2442, 1.7005, 1.8108, 0.7856, 1.2355, 1.7929, 1.7928, -0.2329, 0.9611, 1.3078, 0.7149, 1.0416, 1.3064, 1.2433, -0.8432, 0.0324, 0.9173, 0.394, 0.2684, 0.4867, 0.5017, 0.9058, 0.6119, -0.1999, -0.5061, -0.9797, 0.0311, 0.2832, 0.6348, -0.0479, -0.3078, -0.5263, 0.6281, 0.3243, -0.0487, -0.3147, -0.493, -0.3232, -1.2076, -1.4439, -1.0974, -0.5887]}, "token.table": {"Topic": [3, 3, 1, 1, 2, 1, 3, 1, 2, 3, 1, 2, 3, 1, 2, 1, 2, 3, 1, 2, 3, 3, 3, 1, 2, 3, 1, 2, 3, 1, 2, 1, 2, 3, 3, 1, 2, 3, 3, 1, 2, 3, 1, 3, 1, 2, 3, 3, 2, 2, 1, 2, 3, 2, 1, 2, 3, 1, 1, 2, 3, 3, 1, 2, 1, 2, 3, 1, 2, 3, 3, 2, 1, 2, 3, 1, 2, 3, 3, 3, 1, 2, 3, 1, 1, 2, 3, 2, 1, 1, 3, 1, 2, 3, 1, 2, 3, 2, 1, 2, 3, 1, 3, 2, 3, 1, 2, 3, 1, 1, 2, 3, 1, 3, 1, 2, 3, 2, 3, 1, 2, 1, 2, 3, 2, 1, 1, 2, 3, 2, 2, 3, 1, 2, 3, 1, 2, 3, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 1, 2, 3, 2, 3, 1, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 3, 1, 1, 3, 1, 2, 3, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 1, 2, 3, 2, 1, 2, 3, 1, 2, 3, 1, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 1, 2, 3, 1, 2, 3, 1, 2, 3, 2, 1, 2, 3, 1, 2, 3, 2, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 3, 1, 1, 1, 2, 3, 1, 2, 3, 2, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 1, 2, 3, 1, 2, 3, 3, 1, 2, 3, 1, 2, 3, 1, 1, 2, 3, 1, 2, 3, 3, 1, 2, 3, 1, 2, 1, 2, 3, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 3, 2, 2, 2, 1, 2, 3, 1, 2, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 1, 2, 3, 1, 1, 2, 3, 3, 1, 2, 1, 1, 1, 2, 3, 3, 1, 2, 3, 2, 1, 3, 1, 1, 2, 1, 2, 3, 2, 1, 2, 3, 2, 1, 2, 3, 2, 1, 2, 3, 3, 2, 1, 2, 3, 2, 1, 2, 3, 1, 1, 2, 3, 1, 3, 1, 2, 3, 1, 3, 2, 1, 2, 3, 1, 2, 3, 2, 1, 1, 2, 3, 2, 1, 2, 3], "Freq": [0.9247051270013198, 0.9247626490757774, 0.9635258364352939, 0.12869194062385983, 0.7721516437431589, 0.26409437561548005, 0.5281887512309601, 0.33347727242624975, 0.5557954540437496, 0.11115909080874992, 0.8970035293632, 0.04485017646816, 0.04485017646816, 0.9410598194044835, 0.11763247742556043, 0.7796193497175113, 0.12574505640605022, 0.09221304136443684, 0.6874722044457972, 0.27498888177831887, 0.03437361022228986, 0.7064511145359774, 0.7054164485415022, 0.32055230889604164, 0.42740307852805554, 0.24931846247469908, 0.5242190630985637, 0.3448809625648446, 0.12415714652334404, 0.14597881913700686, 0.8758729148220411, 0.7464057648801796, 0.20302236804740886, 0.047769968952331494, 0.8575239410987343, 0.7037845105820827, 0.28222830627403317, 0.014290040824001678, 0.9247648671659852, 0.8267295851970988, 0.12948776635617212, 0.03984238964805296, 0.26409633736659827, 0.5281926747331965, 0.7872229436405686, 0.18240531620940004, 0.028800839401484216, 0.9247070599052123, 0.8861220929770143, 0.9820601189363984, 0.52686730215165, 0.44839770395885103, 0.022419885197942552, 0.9823943303464471, 0.4383763824138957, 0.21918819120694785, 0.35070110593111653, 0.9089902824939065, 0.5787344750663097, 0.2946284600337577, 0.12626934001446757, 0.9247149900975364, 0.12863088512954282, 0.7717853107772569, 0.46222128285430675, 0.44571337989522436, 0.08253951479541193, 0.6404532921959806, 0.307668738407873, 0.05651058460552769, 0.9246688212941839, 0.9817670425754002, 0.7261265067720973, 0.258178313518968, 0.0161361445949355, 0.5822913917145355, 0.25689326105053034, 0.1541359566303182, 0.9246960095645769, 0.9246955985932633, 0.7210236836996758, 0.23305816038777402, 0.05098147258482557, 0.9713499451007972, 0.8841231416003954, 0.08841231416003954, 0.04420615708001977, 0.886163593285867, 0.9262124867188603, 0.2234536754242728, 0.6703610262728185, 0.6673974404235167, 0.2765791194547907, 0.05411330598028514, 0.8106787706877399, 0.13511312844795664, 0.049132046708347865, 0.8861250886748021, 0.5121300576426852, 0.40669151636330875, 0.08033412668904864, 0.9254705322812451, 0.7065445934022376, 0.7555118311370603, 0.15110236622741208, 0.7461350992473732, 0.22907656555840405, 0.026180178920960463, 0.9274628752036577, 0.5487683337062185, 0.18292277790207281, 0.27438416685310923, 0.9403976965403668, 0.9247533422108251, 0.3897245834578294, 0.5845868751867441, 0.027837470246987815, 0.9437219450093258, 0.924701697092003, 0.24487759574526966, 0.734632787235809, 0.4763622466746419, 0.2646456925970233, 0.2646456925970233, 0.886093484483388, 0.9383595536900857, 0.6036345965833918, 0.15090864914584795, 0.2263629737187719, 0.8862077666769429, 0.8522766003347595, 0.1704553200669519, 0.10780859870236131, 0.21561719740472263, 0.7546601909165292, 0.7451106932892541, 0.18095545408453312, 0.0745110693289254, 0.8410758634030138, 0.857589866261625, 0.7258782957682434, 0.2005716343570146, 0.06685721145233821, 0.44890725929089875, 0.3291986568133258, 0.20949005433575274, 0.5353711010546613, 0.3756990182839729, 0.08453227911389391, 0.9891230753563711, 0.7596808156586152, 0.2016851722987474, 0.033614195383124566, 0.8843849909767361, 0.7039954701895516, 0.909583678478178, 0.7669833905512398, 0.20896852856336173, 0.02296357456740239, 0.5031282300050207, 0.14375092285857735, 0.3593773071464434, 0.5771921811319968, 0.24419669201738325, 0.17759759419446056, 0.8169572856781474, 0.14686872551517258, 0.036717181378793144, 0.9246985798871704, 0.926619446882357, 0.3861582501169664, 0.5148776668226218, 0.18784860647583737, 0.18784860647583737, 0.5635458194275121, 0.7065759657103212, 0.6603488507354377, 0.26109031039178926, 0.07813651624863766, 0.4457156899643376, 0.46163410746306394, 0.09551050499235805, 0.8494190718058884, 0.05858062564178541, 0.0878709384626781, 0.9090613290854583, 0.5776213347121993, 0.22602573966999104, 0.17579779752110414, 0.9436555270347411, 0.5924771453942264, 0.31666881909001754, 0.09193610876806961, 0.42309274859630025, 0.3793245332242692, 0.20425167173614495, 0.9509464759984279, 0.6216973754714897, 0.3229596755696051, 0.056517943224680886, 0.560707591169355, 0.3416811883688257, 0.10513267334425407, 0.7612660450386979, 0.2050899390743524, 0.031284905960494436, 0.6018287110215953, 0.3801023438031128, 0.021116796877950712, 0.492959101573995, 0.2464795507869975, 0.28169091518514, 0.7886671340791965, 0.13917655307279939, 0.06958827653639969, 0.2541425713197749, 0.5808973058737713, 0.1815304080855535, 0.9091462564255697, 0.4751042841355002, 0.20361612177235724, 0.3393602029539287, 0.15590027115674818, 0.8054847343098656, 0.05196675705224939, 0.8164817056397102, 0.11097809591219363, 0.07134306165783875, 0.9436106145926257, 0.8583193868773407, 0.08174470351212769, 0.040872351756063845, 0.8850745540250694, 0.05900497026833796, 0.924666838678037, 0.9410667296484895, 0.8771504091602438, 0.10120966259541274, 0.016868277099235458, 0.6714085665740214, 0.30138784543989405, 0.029840380736623172, 0.10760900200404355, 0.7532630140283049, 0.10760900200404355, 0.9256241677782625, 0.9248004472195323, 0.9566385298630573, 0.9389693560115094, 0.5303990150627679, 0.45746915049163733, 0.019889963064853796, 0.5784571865094441, 0.39440262716553004, 0.026293508477702003, 0.8861905889911358, 0.5843025428954702, 0.2788716682001108, 0.14607563572386756, 0.8227451440288311, 0.12657617600443558, 0.04219205866814519, 0.6782801588422515, 0.26421378280483054, 0.05915233943391728, 0.14586548497866467, 0.875192909871988, 0.20594835185477695, 0.6864945061825898, 0.06864945061825897, 0.5635768622855045, 0.3612672194137849, 0.07225344388275699, 0.7051793176429578, 0.5767455027476335, 0.22568302281429137, 0.17553123996667108, 0.32732678622242456, 0.5819142866176437, 0.10910892874080819, 0.9088834708711455, 0.719142700261171, 0.26776589903341474, 0.007650454258097564, 0.3720364123399719, 0.5580546185099579, 0.06200606872332865, 0.9247589651425818, 0.9093216774579695, 0.2712501979112268, 0.5425003958224536, 0.9252039330774621, 0.9436736712845866, 0.4891742674902814, 0.4515454776833367, 0.05644318471041709, 0.07750137343244543, 0.9300164811893451, 0.7464030906913778, 0.19122723811101414, 0.06168620584226262, 0.7092994441213566, 0.1484580231881909, 0.13196268727839192, 0.7166755719604683, 0.24119720696860153, 0.0423607997901845, 0.3911717181784081, 0.27940837012743436, 0.33529004415292124, 0.9246636677133152, 0.9438191549487979, 0.9476537898880786, 0.9437695366240869, 0.44680161283561304, 0.36929521060902715, 0.18236800523902574, 0.14547669476498126, 0.8728601685898876, 0.3281022717000455, 0.656204543400091, 0.02982747924545868, 0.9400034251383165, 0.04086971413644854, 0.04086971413644854, 0.5080985603228301, 0.4257041991893982, 0.06866196761119325, 0.42790278640161855, 0.5705370485354914, 0.8183528311996253, 0.1558767297523096, 0.0194845912190387, 0.9298603163266889, 0.7182487393966881, 0.209949631515955, 0.07182487393966881, 0.7066388490662223, 0.25715601525205356, 0.7714680457561607, 0.9844311987908009, 0.9253522484662517, 0.6685395079212209, 0.2739381398311344, 0.058701029963814516, 0.8575033924186596, 0.6952294600015134, 0.2670417793383297, 0.03683334887425237, 0.9436759980490677, 0.548864243257205, 0.44907074448316775, 0.9087933462348056, 0.21034867588948725, 0.841394703557949, 0.3993809472008502, 0.5546957600011808, 0.04437566080009447, 0.9673839060482539, 0.8799633425325033, 0.08799633425325033, 0.9246509240881406, 0.8861129109773002, 0.32145273772587935, 0.5969836557766331, 0.045921819675125625, 0.9407476535201889, 0.5141162819976133, 0.413800909900518, 0.07523652907282145, 0.7054438544152719, 0.9820029162252779, 0.6733468861598151, 0.28617242661792136, 0.039278568359322544, 0.8861320297866113, 0.9146199946705589, 0.09380717894057014, 0.023451794735142535, 0.9492511851352705, 0.38671718024907453, 0.23203030814944473, 0.38671718024907453, 0.9263327720073425, 0.7065154916819318, 0.723744082357523, 0.24370974201834958, 0.02954057479010298, 0.32810214800900683, 0.6562042960180137, 0.943668641665093, 0.6596603105601553, 0.24365831290960693, 0.10102905657227604, 0.6447857260972174, 0.30031116010007386, 0.052996087076483615, 0.8862076967364378, 0.9403420004870218, 0.6739795306214517, 0.16438525137108578, 0.16438525137108578, 0.9437374705518897, 0.8764101539024625, 0.10190815743051888, 0.02038163148610378], "Term": ["abound", "accent", "accommodate", "accomodation", "accomodation", "agency", "agency", "airport", "airport", "airport", "amazing", "amazing", "amazing", "appoint", "appoint", "area", "area", "area", "ask", "ask", "ask", "aspect", "assistance", "average", "average", "average", "bad", "bad", "bad", "balcony", "balcony", "bathroom", "bathroom", "bathroom", "beach", "bed", "bed", "bed", "bird", "block", "block", "block", "boat", "boat", "book", "book", "book", "booth", "boring", "bread", "breakfast", "breakfast", "breakfast", "bride", "cab", "cab", "cab", "cafe", "car", "car", "car", "catamaran", "champagne", "champagne", "charge", "charge", "charge", "check", "check", "check", "chicken", "chip", "clean", "clean", "clean", "coffee", "coffee", "coffee", "colony", "combination", "comfortable", "comfortable", "comfortable", "complete", "complimentary", "complimentary", "complimentary", "conditioner", "confirmation", "cosy", "cosy", "day", "day", "day", "definitely", "definitely", "definitely", "description", "desk", "desk", "desk", "direct", "dominican", "doubletree", "doubletree", "downtown", "downtown", "downtown", "dryer", "early", "early", "early", "earplug", "elbow", "elevator", "elevator", "elevator", "embassy", "emergency", "employee", "employee", "evening", "evening", "evening", "existent", "explore", "extremely", "extremely", "extremely", "false", "fare", "fare", "fax", "fax", "fax", "feel", "feel", "feel", "field", "file", "floor", "floor", "floor", "food", "food", "food", "free", "free", "free", "fresh", "friendly", "friendly", "friendly", "girlfriend", "gloomy", "gorgeous", "great", "great", "great", "gym", "gym", "gym", "help", "help", "help", "helpful", "helpful", "helpful", "hesitant", "hide", "hill", "hill", "historic", "historic", "historic", "host", "hotel", "hotel", "hotel", "hour", "hour", "hour", "husband", "husband", "husband", "ideal", "internet", "internet", "internet", "jet", "large", "large", "large", "leave", "leave", "leave", "literally", "little", "little", "little", "lobby", "lobby", "lobby", "location", "location", "location", "look", "look", "look", "lounge", "lounge", "lounge", "love", "love", "love", "low", "low", "low", "lucky", "major", "major", "major", "manager", "manager", "manager", "market", "market", "market", "mediocre", "monorail", "monorail", "monorail", "moore", "moore", "mosquito", "muffin", "new", "new", "new", "night", "night", "night", "non", "non", "non", "non_smoke", "notify", "original", "paper", "parking", "parking", "parking", "pay", "pay", "pay", "peak", "people", "people", "people", "pike", "pike", "pike", "place", "place", "place", "pleased", "pleased", "poor", "poor", "poor", "price", "price", "price", "prize", "provide", "provide", "provide", "quality", "quality", "quality", "read_review", "really", "really", "really", "reception", "reception", "reception", "recheck", "refrigerator", "relatively", "relatively", "renovate", "reply", "request", "request", "request", "resort", "resort", "restaurant", "restaurant", "restaurant", "return", "return", "return", "room", "room", "room", "rude", "rude", "rude", "rum", "rush", "sag", "seatac", "service", "service", "service", "shabby", "shabby", "sheet", "sheet", "sheet", "sheraton", "sheraton", "sheraton", "shower", "shower", "shower", "shuttle", "shuttle", "size", "size", "size", "slight", "small", "small", "small", "smash", "smile", "smile", "snack", "spending", "staff", "staff", "staff", "starfish", "stay", "stay", "stay", "steak", "style", "style", "suggestion", "suitcase", "suitcase", "suite", "suite", "suite", "suppose", "switch", "switch", "tan", "tap", "taxi", "taxi", "taxi", "team", "tell", "tell", "tell", "theme", "thread", "time", "time", "time", "tournament", "tower", "tower", "tower", "treat", "trendy", "trendy", "trendy", "update", "vendor", "view", "view", "view", "visitor", "visitor", "voucher", "walk", "walk", "walk", "well", "well", "well", "western", "win", "window", "window", "window", "winter", "wonderful", "wonderful", "wonderful"]}, "R": 30, "lambda.step": 0.01, "plot.opts": {"xlab": "PC1", "ylab": "PC2"}, "topic.order": [2, 3, 1]};

function LDAvis_load_lib(url, callback){
  var s = document.createElement('script');
  s.src = url;
  s.async = true;
  s.onreadystatechange = s.onload = callback;
  s.onerror = function(){console.warn("failed to load library " + url);};
  document.getElementsByTagName("head")[0].appendChild(s);
}

if(typeof(LDAvis) !== "undefined"){
   // already loaded: just create the visualization
   !function(LDAvis){
       new LDAvis("#" + "ldavis_el20138418553442994725138551008", ldavis_el20138418553442994725138551008_data);
   }(LDAvis);
}else if(typeof define === "function" && define.amd){
   // require.js is available: use it to load d3/LDAvis
   require.config({paths: {d3: "https://d3js.org/d3.v5"}});
   require(["d3"], function(d3){
      window.d3 = d3;
      LDAvis_load_lib("https://cdn.jsdelivr.net/gh/bmabey/pyLDAvis@3.4.0/pyLDAvis/js/ldavis.v3.0.0.js", function(){
        new LDAvis("#" + "ldavis_el20138418553442994725138551008", ldavis_el20138418553442994725138551008_data);
      });
    });
}else{
    // require.js not available: dynamically load d3 & LDAvis
    LDAvis_load_lib("https://d3js.org/d3.v5.js", function(){
         LDAvis_load_lib("https://cdn.jsdelivr.net/gh/bmabey/pyLDAvis@3.4.0/pyLDAvis/js/ldavis.v3.0.0.js", function(){
                 new LDAvis("#" + "ldavis_el20138418553442994725138551008", ldavis_el20138418553442994725138551008_data);
            })
         });
}
</script>
</div>
</div>
<div id="9abc0f10" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dominat topics and its percentage contribution in each document</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_topics_sentences(ldamodel<span class="op">=</span><span class="va">None</span>, corpus<span class="op">=</span>corpus, texts<span class="op">=</span>data):</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Init output</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    sent_topics_df <span class="op">=</span> pd.DataFrame()</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get main topic in each document</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row_list <span class="kw">in</span> <span class="bu">enumerate</span>(ldamodel[corpus]):</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>        row <span class="op">=</span> row_list[<span class="dv">0</span>] <span class="cf">if</span> ldamodel.per_word_topics <span class="cf">else</span> row_list            </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(row)</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>        row <span class="op">=</span> <span class="bu">sorted</span>(row, key<span class="op">=</span><span class="kw">lambda</span> x: (x[<span class="dv">1</span>]), reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get the Dominant topic, Perc Contribution and Keywords for each document</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, (topic_num, prop_topic) <span class="kw">in</span> <span class="bu">enumerate</span>(row):</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> j <span class="op">==</span> <span class="dv">0</span>:  <span class="co"># =&gt; dominant topic</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>                wp <span class="op">=</span> ldamodel.show_topic(topic_num)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>                topic_keywords <span class="op">=</span> <span class="st">", "</span>.join([word <span class="cf">for</span> word, prop <span class="kw">in</span> wp])</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Create a new row as a DataFrame and concatenate it</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>                new_row <span class="op">=</span> pd.Series([<span class="bu">int</span>(topic_num), <span class="bu">round</span>(prop_topic, <span class="dv">4</span>), topic_keywords])</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>                sent_topics_df <span class="op">=</span> pd.concat([sent_topics_df, new_row.to_frame().T], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>    sent_topics_df.columns <span class="op">=</span> [<span class="st">'Dominant_Topic'</span>, <span class="st">'Perc_Contribution'</span>, <span class="st">'Topic_Keywords'</span>]</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add original text to the end of the output</span></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>    contents <span class="op">=</span> pd.Series(texts)</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>    sent_topics_df <span class="op">=</span> pd.concat([sent_topics_df, contents], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(sent_topics_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e9d0bfb7" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>df_topic_sents_keywords <span class="op">=</span> format_topics_sentences(ldamodel<span class="op">=</span>lda_model, corpus<span class="op">=</span>corpus, texts<span class="op">=</span>data_ready)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Format</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>df_dominant_topic <span class="op">=</span> df_topic_sents_keywords.reset_index()</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>df_dominant_topic.columns <span class="op">=</span> [<span class="st">'Document_No'</span>, <span class="st">'Dominant_Topic'</span>, <span class="st">'Topic_Perc_Contrib'</span>, <span class="st">'Keywords'</span>, <span class="st">'Text'</span>]</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>df_dominant_topic.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Document_No</th>
<th data-quarto-table-cell-role="th">Dominant_Topic</th>
<th data-quarto-table-cell-role="th">Topic_Perc_Contrib</th>
<th data-quarto-table-cell-role="th">Keywords</th>
<th data-quarto-table-cell-role="th">Text</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>2</td>
<td>0.9635</td>
<td>room, hotel, stay, night, great, staff, servic...</td>
<td>[hotel, expensive, parking, deal, stay, hotel,...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2</td>
<td>0.996</td>
<td>room, hotel, stay, night, great, staff, servic...</td>
<td>[special, charge, diamond, member, decide, cha...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>2</td>
<td>0.9948</td>
<td>room, hotel, stay, night, great, staff, servic...</td>
<td>[room, experience, hotel, level, positive, lar...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>1</td>
<td>0.9883</td>
<td>room, hotel, stay, great, night, location, sta...</td>
<td>[unique, great, stay, wonderful, time, hotel, ...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>2</td>
<td>0.9948</td>
<td>room, hotel, stay, night, great, staff, servic...</td>
<td>[great, stay, great, stay, game, awesome, down...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;There are two goodness of fit (gof) measures to evaluate topic modeling. They are - coherence score and perplexity. Coherence score measures the coherence between topics. Higher coherence score indicates more meaningful and interpretable topics. Coherent scores range from 0 to 1. The higher coherence scores indicate more interpretable and meaningful topics.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Perplexity score evaluates how well the model represents the data. Lower perplexity score indicates a better fit. Perplexity might not always correlate with human interpretability of the topics. Unlike, coherence socres, there is no good or bad perplexity score, but it is useful to compare different models on the same dataset.</p>
<div id="5439facc" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Coherence Score</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gensim.models <span class="im">import</span> CoherenceModel</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>coherence_model_lda <span class="op">=</span> CoherenceModel(model<span class="op">=</span>lda_model, texts<span class="op">=</span>data_ready,dictionary<span class="op">=</span>dictionary, coherence<span class="op">=</span><span class="st">'c_v'</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>coherence_lda <span class="op">=</span> coherence_model_lda.get_coherence()</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">Coherence Score: '</span>, coherence_lda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c7fba036" class="cell" data-execution_count="37">
<div class="cell-output cell-output-stdout">
<pre><code>
Coherence Score:  0.3579669980731333</code></pre>
</div>
</div>
<div id="fce824a1" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Perplexity</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">Perplexity : '</span>, lda_model.log_perplexity(corpus)) </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>lda_model.log_perplexity(corpus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Perplexity :  -7.11292394622426</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>-7.1129222881860965</code></pre>
</div>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;To optimize topic modeling performance, we can tune some hyperparameters (also called <strong>hyperparameter tuning</strong>). Some of the important hyperparameters of topic modeling include - number of topics, document topic density, topic word density, number of iterations and so on.</p>
</div>
</section>
<section id="sentiment-analysis" class="level2" data-number="10.7">
<h2 data-number="10.7" class="anchored" data-anchor-id="sentiment-analysis"><span class="header-section-number">10.7</span> Sentiment Analysis</h2>
<div style="text-align: justify">
<p>&nbsp;&nbsp;&nbsp;&nbsp;Sentiment analysis involves converting text into sentiments such as positive, neutral, and negative. Texts are widely used to express emotion, feelings, opinion and so on. Therefore, sometimes sentiment analysis is also called “Opinion Mining.” Identifying sentiment from texts could provide valuable insights to make strategic decisions such as improving product features, launching new products, identifying strengths or weaknesses of product or service offerings. Before, we perform the sentiment analysis, we need to do the preprocessing as described in <a href="#sec-preprocessing" class="quarto-xref"><span>Section 10.3.1</span></a> first.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Below we use <code>texblob</code> python module for seniment analysis of our text about Accounting. <code>texblob</code> is simple for sentiment analysis because the function accepts text as input and return sentiment score. There are two types of sentiment scores - polarity and subjectivity. Polarity score actually measures the sentiment of the text and it values are between -1 and +1, where -1 indicates high negative sentiment and +1 indicates very positive sentiment. On the other hand, subjectivity score measures whether the text contaiins factual information or personal opinion. Subjectivity scores range from 0 to 1, where 0 indicates factual information and 1 indicates personal opinion.</p>
<div id="ca991bde" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> textblob <span class="im">import</span> TextBlob</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e0d3bb3c" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determining Polarity </span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>TextBlob(my_text).sentiment.polarity</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>0.028571428571428574</code></pre>
</div>
</div>
<div id="0bc27623" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determining Subjectivity </span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>TextBlob(my_text).sentiment.subjectivity</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>0.21706349206349207</code></pre>
</div>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;In the above analysis, we see the polarity score is 0.02857, which is very close to zero. Therefore, we can say our text is neutral. On the other hand, subjectivity score is 0.21706, which is close to 0, indicating that our text is factual information (not personal opinion).</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Now, we are going to measure the polarity and subjectivity of our customer reveiw data.</p>
<div id="4f105917" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>product1 <span class="op">=</span> customer_reviews[customer_reviews[<span class="st">'ProductId'</span>] <span class="op">==</span> <span class="st">"B003VXFK44"</span>].reset_index()</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>product1[<span class="st">'polarity'</span>] <span class="op">=</span> product1[<span class="st">'Text'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: TextBlob(x).sentiment.polarity)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>product1[<span class="st">'subjectivity'</span>] <span class="op">=</span> product1[<span class="st">'Text'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: TextBlob(x).sentiment.subjectivity)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="readability-index" class="level2" data-number="10.8">
<h2 data-number="10.8" class="anchored" data-anchor-id="readability-index"><span class="header-section-number">10.8</span> Readability Index</h2>
<div style="text-align: justify">
<p>&nbsp;&nbsp;&nbsp;&nbsp;In NLP, readability index is used to measure how easily a text can be understood by the readers. Readability index measures the complexity of text based on such factors as structure of sentences, grammar, and vocabulary. Some of the widely used readability index include - Flesch readability index, Kincaid readability index, Gunning Fog index, and Smog index.</p>
</div>
<div style="text-align: justify">
<p>&nbsp;&nbsp;&nbsp;&nbsp;<strong>Flesch Readability</strong> index determines how easy or difficult texts are to understand. It is also called Flesch Reading Ease score. Flesch readability index use sentence length and syllables in words to measure the complexity of text. The score of Flesch readability index ranges from 0 to 100, with higher scores indicating easier readability. The rule of thumb of Flesch readability: 0 - 30: very difficult; 60 - 70: standard/easy to read; 90 - 100: very easy.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;<strong>Kincaid Readability</strong> index is a readability metric used to estimate the US school grade level required to comprehend texts. It is also called Flesch-Kincaid Grade Level. It is based on Flesch readability index but translates the score of Flesch readability index into grade level system. The rule of thumb of Kincaid readability index is 12+: College or Profession level; 9-12: High School Level; 6-8: Middle School level; 1-5: Elementary school. For example, a text with Kincaid readability score 7.5 can be understood by a 7th grader in the second half of school year and a text with 15 score can be comprehended by a senior college student.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;<strong>Gunning Fog Index</strong> measures how many years of formal education one needs to understand a piece of text. It uses average sentence length and percentage of hard words to determine whether a text is very complex for its users. The rule of thumb of Gunning Fox index is - 13+: Difficult (College level or professional content); 9-12: Standard difficulty (High school graduates); 6-8: Easy to read (Suitable for most audiences).</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;<strong>Smog Index</strong> is desigend to estimate the years of education a reader needs to comprehend a piece of text. The rule of thumb is the same as Gunning Fox index. Overall, all of the above readability indices’ interpreationa are the same.</p>
</div>
<div style="text-align: justify">
<p>&nbsp;&nbsp;&nbsp;&nbsp;We are going to collect Item 7 - Management Discussion &amp; Analysis (MD&amp;A) and Item 1A - Risk Factors from 10-K for some companies and calculate their readability</p>
<div id="043d3cc6" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># edgartools - my version is 3.13.0</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pip install edgartools # latest version on 03.12.2025 is 3.13.0</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co"># pip install edgartools==2.31.1 # to install a specific version</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pip list - shows all packages with their versions </span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> edgar <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6b8017c1" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell the SEC who you are</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>set_identity(<span class="st">"YOUREMAIL@outlook.com"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="268bf51e" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>filings2 <span class="op">=</span> get_filings(form<span class="op">=</span><span class="st">'10-K'</span>, amendments<span class="op">=</span><span class="va">False</span>, filing_date<span class="op">=</span><span class="st">"2024-12-01:2024-12-05"</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>filings2_df <span class="op">=</span> filings2.to_pandas()</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list to store the Item 1c text</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>items_texts <span class="op">=</span> []</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n, filing <span class="kw">in</span> <span class="bu">enumerate</span>(filings2):</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    url <span class="op">=</span> filing.url</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    cik <span class="op">=</span> filing.cik</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>    filing_date <span class="op">=</span> filing.header.filing_date,</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    reporting_date <span class="op">=</span> filing.header.period_of_report,</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>    comn <span class="op">=</span> filing.company</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the text for Item 1c</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>    TenK <span class="op">=</span> filing.obj()</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Bypass None values</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>        item7_text <span class="op">=</span> TenK[<span class="st">'Item 7'</span>] <span class="co"># Management Discussion &amp; Analysis (MDA)</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>        item1a_text <span class="op">=</span> TenK[<span class="st">'Item 1A'</span>] <span class="co"># Risk Factors </span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>        item7_text <span class="op">=</span> <span class="va">None</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>        item1a_text <span class="op">=</span> <span class="va">None</span></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Append the data to the list</span></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># item1c_text = TenK['Item 1C']</span></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>    items_texts.append({</span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CIK'</span>: cik,</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Filing Date'</span>: <span class="bu">str</span>(filing_date),</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Item 7 Text'</span>: item7_text,</span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Item 1a Text'</span>: item1a_text,</span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">'url'</span>: url,</span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>        <span class="st">'reporting_date'</span>: <span class="bu">str</span>(reporting_date),</span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">'comn'</span>: comn</span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame from the Item 1c text data</span></span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a>items_df <span class="op">=</span> pd.DataFrame(items_texts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4272efa7" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> readability <span class="co"># for readability </span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> textstat <span class="co"># for readability </span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Flesch Readability </span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>items_df[<span class="st">'Item7_Flesch_read'</span>] <span class="op">=</span> items_df[<span class="st">'Item 7 Text'</span>].<span class="bu">apply</span> (<span class="kw">lambda</span> x: textstat.flesch_reading_ease(x))</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>items_df[<span class="st">'Item7_Flesch2_read'</span>] <span class="op">=</span> items_df[<span class="st">'Item 7 Text'</span>].<span class="bu">apply</span> (<span class="kw">lambda</span> x: readability.getmeasures(x)[<span class="st">'readability grades'</span>][<span class="st">'FleschReadingEase'</span>])</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Kincaid Readability </span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>items_df[<span class="st">'Item7_kincaid_read'</span>] <span class="op">=</span> items_df[<span class="st">'Item 7 Text'</span>].<span class="bu">apply</span> (<span class="kw">lambda</span> x: textstat.flesch_kincaid_grade(x))</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>items_df[<span class="st">'Item7_kincaid2_read'</span>] <span class="op">=</span> items_df[<span class="st">'Item 7 Text'</span>].<span class="bu">apply</span> (<span class="kw">lambda</span> x: readability.getmeasures(x)[<span class="st">'readability grades'</span>][<span class="st">'Kincaid'</span>])</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Gunning Fog Index</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>items_df[<span class="st">'Item7_GunningFogIndex_read'</span>] <span class="op">=</span> items_df[<span class="st">'Item 7 Text'</span>].<span class="bu">apply</span> (<span class="kw">lambda</span> x: textstat.gunning_fog(x))</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>items_df[<span class="st">'Item7_GunningFogIndex2_read'</span>] <span class="op">=</span> items_df[<span class="st">'Item 7 Text'</span>].<span class="bu">apply</span> (<span class="kw">lambda</span> x: readability.getmeasures(x)[<span class="st">'readability grades'</span>][<span class="st">'GunningFogIndex'</span>])</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Smog Index</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>items_df[<span class="st">'Item7_SmogIndex_read'</span>] <span class="op">=</span> items_df[<span class="st">'Item 7 Text'</span>].<span class="bu">apply</span> (<span class="kw">lambda</span> x: textstat.smog_index(x))</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>items_df[<span class="st">'Item7_SmogIndex2_read'</span>] <span class="op">=</span> items_df[<span class="st">'Item 7 Text'</span>].<span class="bu">apply</span> (<span class="kw">lambda</span> x: readability.getmeasures(x)[<span class="st">'readability grades'</span>][<span class="st">'SMOGIndex'</span>])</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Total words and sentences </span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>items_df[<span class="st">'Item7_TotalWords'</span>] <span class="op">=</span> items_df[<span class="st">'Item 7 Text'</span>].<span class="bu">apply</span> (<span class="kw">lambda</span> x: readability.getmeasures(x)[<span class="st">'sentence info'</span>][<span class="st">'words'</span>])</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>items_df[<span class="st">'Item7_TotalSentences'</span>] <span class="op">=</span> items_df[<span class="st">'Item 7 Text'</span>].<span class="bu">apply</span> (<span class="kw">lambda</span> x: readability.getmeasures(x)[<span class="st">'sentence info'</span>][<span class="st">'sentences'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="text-similarity" class="level2" data-number="10.9">
<h2 data-number="10.9" class="anchored" data-anchor-id="text-similarity"><span class="header-section-number">10.9</span> Text Similarity</h2>
<div style="text-align: justify">
<p>&nbsp;&nbsp;&nbsp;&nbsp;Text similarity measures how similar two pieces of texts are. Text similairty can be classified into two groups - Semantic similarity and Syntactic similarity. While semantic similarity focuses on meanings even if the pieces of text have different wordings whereas syntactic similarity measures on exact wording and structure. Jaccard similarity and cosine similarity are the two widely used measures of text similarity.</p>
</div>
<div style="text-align: justify">
<p>&nbsp;&nbsp;&nbsp;&nbsp;<strong>Jaccard Similarity</strong> measures the similarity of two pieces of text by comparing the sets of words. Jaccard similarity is defined as -</p>
<p><span class="math display">\[\text{Jaccard Similarity} = \frac{|A \cap B|}{|A \cup B|}\]</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;For example, the two texts - Text A: “I love natural language processing” and Text B: “I enjoy natural processing” - have the following sets - Set A = {I, love, natural, language, processing} and Set B = {I, enjoy, natural, processing}. Now, the intersection is {I, natural, processing} and union is {I, love, natural, language, processing, enjoy}. Therefore, jaccard similarity is 3/6 = 0.50.</p>
<div id="f99cf2dd" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Jaccard Similarity </span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> jaccard_similarity(list1, list2):</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    s1 <span class="op">=</span> <span class="bu">set</span>(list1)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    s2 <span class="op">=</span> <span class="bu">set</span>(list2)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">float</span>(<span class="bu">len</span>(s1.intersection(s2)) <span class="op">/</span> <span class="bu">len</span>(s1.union(s2)))</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>jaccard_similarity(items_df[<span class="st">'Item 7 Text'</span>][<span class="dv">0</span>].split(),</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>                items_df[<span class="st">'Item 7 Text'</span>][<span class="dv">1</span>].split())</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>jaccard_similarity(items_df[<span class="st">'Item 7 Text'</span>][<span class="dv">0</span>].split(),</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>                items_df[<span class="st">'Item 1a Text'</span>][<span class="dv">5</span>].split())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>0.1627382146439318</code></pre>
</div>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;<strong>Cosine Similarity</strong> calculates the similarity between two pieces of text documents or vectors by determining the cosine of the angle between them in a multidimensional space. It is particularly useful when text is vectorized. The formula for cosine similarity is -</p>
<p><span class="math display">\[\text{Cosine Similarity} = \frac{\vec{A} \cdot \vec{B}}{\|\vec{A}\| \|\vec{B}\|}\]</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;For example, we have two vectors - A = [1, 2, 3] and B = [4, 5, 6]. Now,</p>
<ol type="1">
<li><p><span class="math display">\[\vec{A} \cdot \vec{B} = (1 \times 4) + (2 \times 5) + (3 \times 6) = 32\]</span></p></li>
<li><p><span class="math display">\[\|\vec{A}\| = \sqrt{1^2 + 2^2 + 3^2} = \sqrt{14}, \quad \|\vec{B}\| = \sqrt{4^2 + 5^2 + 6^2} = \sqrt{77}\]</span></p></li>
<li><p><span class="math display">\[\text{Cosine Similarity} = \frac{32}{\sqrt{14} \times \sqrt{77}} \approx 0.9746\]</span></p></li>
</ol>
<p>&nbsp;&nbsp;&nbsp;&nbsp;The value of cosine similarity lies between -1 and +1, where 1 means completely identical, -1 means completely dissimilar and 0 means no similarity.</p>
<div id="0f532796" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> counter_cosine_similarity(c1, c2):</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    terms <span class="op">=</span> <span class="bu">set</span>(c1).union(c2)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    dotprod <span class="op">=</span> <span class="bu">sum</span>(c1.get(k, <span class="dv">0</span>) <span class="op">*</span> c2.get(k, <span class="dv">0</span>) <span class="cf">for</span> k <span class="kw">in</span> terms)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    magA <span class="op">=</span> math.sqrt(<span class="bu">sum</span>(c1.get(k, <span class="dv">0</span>)<span class="op">**</span><span class="dv">2</span> <span class="cf">for</span> k <span class="kw">in</span> terms))</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>    magB <span class="op">=</span> math.sqrt(<span class="bu">sum</span>(c2.get(k, <span class="dv">0</span>)<span class="op">**</span><span class="dv">2</span> <span class="cf">for</span> k <span class="kw">in</span> terms))</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dotprod <span class="op">/</span> (magA <span class="op">*</span> magB)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>counter_cosine_similarity(Counter(items_df[<span class="st">'Item 7 Text'</span>][<span class="dv">0</span>]),</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>                Counter(items_df[<span class="st">'Item 7 Text'</span>][<span class="dv">5</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>0.9004806355027185</code></pre>
</div>
</div>
<div id="71d4e7d8" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternatively, using sklearn we can compute cosine similiarity</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics.pairwise <span class="im">import</span> cosine_similarity</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> CountVectorizer</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample texts</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>text1 <span class="op">=</span> items_df[<span class="st">'Item 7 Text'</span>][<span class="dv">0</span>]</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>text2 <span class="op">=</span> items_df[<span class="st">'Item 7 Text'</span>][<span class="dv">5</span>]</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert text to vectorized representation</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>vectorizer <span class="op">=</span> CountVectorizer()</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>vectors <span class="op">=</span> vectorizer.fit_transform([text1, text2])</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cosine similarity</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>cos_sim <span class="op">=</span> cosine_similarity(vectors[<span class="dv">0</span>], vectors[<span class="dv">1</span>])</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Cosine Similarity:"</span>, cos_sim[<span class="dv">0</span>][<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cosine Similarity: 0.8997538050603816</code></pre>
</div>
</div>
</div>
</section>
<section id="conclusion" class="level2" data-number="10.10">
<h2 data-number="10.10" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">10.10</span> Conclusion</h2>
<div style="text-align: justify">

</div>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>The collection of documents is called corpus.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>You might find some discrepencies between <a href="#eq-tfidfscore" class="quarto-xref">Equation&nbsp;<span>10.1</span></a> tf-idf scores and tf-idf scores generated by different packages because the packages uses a slightly different formula that might include some kinds of smoothing.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/analyticsforaccountingdata\.netlify\.app\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./advanced_analytics.html" class="pagination-link" aria-label="Web Scraping and Textual Analytics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Web Scraping and Textual Analytics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./machine_learning.html" class="pagination-link" aria-label="Machine Learning">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Machine Learning</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright©Sharif Islam</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/msharifbd/sharifanalytics/edit/main/nlp.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/msharifbd/sharifanalytics/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/msharifbd/sharifanalytics/blob/main/nlp.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>