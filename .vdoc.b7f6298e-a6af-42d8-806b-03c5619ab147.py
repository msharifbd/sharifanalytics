# type: ignore
# flake8: noqa
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
# Importing Necessary Python Packages 
import ibis
import getpass
import os 
#
#
#
# To know more about the next line of code
# see - https://ibis-project.org/tutorials/ibis-for-dplyr-users
ibis.options.interactive = True
#
#
#
#| eval: false
# to connect to the database 
conn = ibis.postgres.connect(
    user='postgres', 
    password = 'YourPassword',
    host = "localhost",
    port = 5433,
    database = "my_database" # here our database name will be 'dvdrental'
)
#
#
#
#
#
#| include: true
#| eval: true
# to connect to the database 
conn = ibis.postgres.connect(
    user='postgres', 
    password = os.getenv("POSTGRESS_PASSWORD"),
    host = "localhost",
    port = 5433,
    database = "dvdrental"
)
#
#
#
#
#
#
#
#
#
#| eval: false
from dotenv import load_dotenv
# load environment variable from .env file 
load_dotenv()

# Connect to your PostgreSQL database 
conn = ibis.postgres.connect(
    user='postgres',
    password=os.getenv('POSTGRESS_PASSWORD'),
    host='localhost',
    port=5433,
    database='my_database'
)
#
#
#
#
#
#| include: true
#| eval: false
# to connect to the database 
conn = ibis.postgres.connect(
    user='postgres', 
    password = getpass.getpass("Enter your database password (Python): "),
    host = "localhost",
    port = 5433,
    database = "dvdrental"
)
#
#
#
# See all tables in a database 
conn.list_tables()
#
#
#
# To know the total number of rows 
conn.table('actor').count() # total rows 
#
#
#
conn.table('actor').columns # name of the columns 
#
#
#
# To see the SQL command 
conn.table('actor').compile()
#
#
#
# Dealing with a table 
conn.table('country')
conn.table('country').head(5).execute()
#
#
#
## describe () or columns () equivalent to glimpse ()
conn.table('country').describe
#
#
#
# filtering rows    
conn.table('country')[conn.table('country')['country']=="Zambia"] \
    .execute()
#
#
#
# Selecting Columns 
conn.table('country')[["country_id", "country"]]
#
#
#
# Arrange 

conn.table('rental') \
    .order_by(['inventory_id'])
#
#
#
# Group By
conn.table('payment')[['payment_id', 'customer_id', 'staff_id', 'amount']] \
    .execute() \
    .groupby('customer_id').agg({'amount': 'mean'}) \
    .reset_index() 
#
#
#

#
#
#
# To disconnect the database 
conn.disconnect()
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#| warning: false 
import os
import duckdb
# pip install ibis 
# pip install ibis-framework[duckdb]
import ibis 
import ibis.selector as s 
from ibis import _
#
#
#
#
#| warning: false 
#| eval: false
# Specify folder and database file
db_folder = "./DATA/duckdb_df_python"  # Change to your path
os.makedirs(db_folder, exist_ok=True)
db_path = os.path.join(db_folder, "my_database.duckdb")

# Connect to persistent DuckDB (creates if not exists)
con = ibis.duckdb.connect(db_path)
print(f"Connected to: {db_path}")
```
#
#
#
