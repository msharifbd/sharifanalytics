{
  "hash": "0c320d68a4d7b3816eebf32f6a3b21c4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Predictive Modeling - Linear Regression\"\nformat: html \n---\n\n\n### Learning Objectives of the Chapter {.unnumbered}\n\n::: {style=\"text-align: justify\"}\nAt the End of the Chapter, Students should be Able to -\n\n-   Learn about Linear Regression\n\n-   Identify Linear Relation between Variables\n\n-   Build Linear Regression Model between Variables\n\n-   Learn about How to Evaluate the Fitness of Linear Models\n\n-   Evaluate the Assumptions of Linear Regressions\n\n-   Build Multiple Regression Models and Evaluate them\n:::\n\n::: {style=\"text-align: justify\"}\n## Introduction\n\n     Discussion on predictive analytics.\n:::\n\n::: {style=\"text-align: justify\"}\n## Regression Analysis\n\n### Simple Linear Regression\n\n     Regression analysis is one of very useful predictive modeling techniques that identify the relationship between two or more variables. The objective of linear regression is to identify a linear line of best fit that can predict the outcome variable (target variable/dependent variable/response variable) for one or more independent variables(predictors). For example, we can draw a scatter diagram to see the relation between tip and total bill in restaurant. @fig-r-hrspower-mpg and @fig-py-hrspower-mpg show the relationship between tip and total bill in R and Python respectively. It is clear that there exists a positive relationship between tip and total bill and it makes sense because higher bill generates higher tips. Similarly, there is positive relationship between size of the diners and tips because when there are more people in a group to dine, the higher the bill and tips (@fig-r-weight-mpg and @fig-py-weight-mpg). The equation of a simple linear regression is - $$y= mX + C$$\n\n     where $y$ = Target variable (Dependent variable); $m$ = slope or rate of change; $X$ = predictor or independent variable; and $C$ = intercept or constant.\n:::\n\n::: {.panel-tabset}\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# loading necessary packages \nlibrary(tidyverse)\nlibrary(broom)\nlibrary(reshape2) # for tips data \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# loading the dataset \ndata (\"tips\")\nglimpse(as_tibble(tips))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 244\nColumns: 7\n$ total_bill <dbl> 16.99, 10.34, 21.01, 23.68, 24.59, 25.29, 8.77, 26.88, 15.0…\n$ tip        <dbl> 1.01, 1.66, 3.50, 3.31, 3.61, 4.71, 2.00, 3.12, 1.96, 3.23,…\n$ sex        <fct> Female, Male, Male, Male, Female, Male, Male, Male, Male, M…\n$ smoker     <fct> No, No, No, No, No, No, No, No, No, No, No, No, No, No, No,…\n$ day        <fct> Sun, Sun, Sun, Sun, Sun, Sun, Sun, Sun, Sun, Sun, Sun, Sun,…\n$ time       <fct> Dinner, Dinner, Dinner, Dinner, Dinner, Dinner, Dinner, Din…\n$ size       <int> 2, 3, 3, 2, 4, 4, 2, 4, 2, 2, 2, 4, 2, 4, 2, 2, 3, 3, 3, 3,…\n```\n\n\n:::\n:::\n\n\n\n\n## Python\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# loading necessary modules \nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt \nsns.set_theme(style=\"darkgrid\")\n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n# loading the dataset \ntips = sns.load_dataset(\"tips\")\ntips.head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   total_bill   tip     sex smoker  day    time  size\n0       16.99  1.01  Female     No  Sun  Dinner     2\n1       10.34  1.66    Male     No  Sun  Dinner     3\n2       21.01  3.50    Male     No  Sun  Dinner     3\n3       23.68  3.31    Male     No  Sun  Dinner     2\n4       24.59  3.61  Female     No  Sun  Dinner     4\n```\n\n\n:::\n:::\n\n\n\n\n\n:::\n\n\n::: panel-tabset\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tips, aes (x = total_bill, y = tip)) + \n  geom_point()\n```\n\n::: {.cell-output-display}\n![Relationship between Tips and Total Bill](predictive_files/figure-html/fig-r-hrspower-mpg-1.png){#fig-r-hrspower-mpg width=672}\n:::\n:::\n\n\n\n\n## Python\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nsns.set_theme(style=\"darkgrid\")\nsns.scatterplot(data = tips, x = \"total_bill\", y = \"tip\")\n```\n\n::: {.cell-output-display}\n![Relationship between Tips and Total Bill](predictive_files/figure-html/fig-py-hrspower-mpg-1.png){#fig-py-hrspower-mpg width=672}\n:::\n:::\n\n\n\n:::\n\n::: panel-tabset\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tips, aes (x = size, y = tip)) + \n  geom_point()\n```\n\n::: {.cell-output-display}\n![Relationship between Tip and Size](predictive_files/figure-html/fig-r-weight-mpg-3.png){#fig-r-weight-mpg width=672}\n:::\n:::\n\n\n\n\n\n## Python\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nsns.set_theme(style=\"darkgrid\")\nsns.scatterplot(data = tips, x = \"size\", y = \"tip\")\n```\n\n::: {.cell-output-display}\n![Relationship between Tip and Size](predictive_files/figure-html/fig-py-weight-mpg-1.png){#fig-py-weight-mpg width=672}\n:::\n:::\n\n\n\n\n\n:::\n\n::: {style=\"text-align: justify\"}\n     Now we can quantify these relationships using linear regression in which we will try to draw a line that will help us to idenfity the relation between the variables. For example, in @fig-r-reg-equation, we can see the linear line that shows the relation between horsepower and MPG. The regression equation we find is `y = 0.92 + 0.11x`, where $y$ is tips, $x$ is total bill, $0.92$ is intercept (or constant), and $0.11$ is slope, which means one unit change of total bill results in $0.11 increase of tips and the value of tips is 0.92 when total bill is 0. @fig-py-reg-equation shows the same results.\n\n::: panel-tabset\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggpubr) \nggplot(tips, aes (x = total_bill, y = tip)) + \n  geom_point() + \n  geom_smooth(method = \"lm\") + \n  labs(x = \"Total Bill\", y = \"Tip\") + \n  stat_regline_equation(label.x = 20, label.y = 9 )\n```\n\n::: {.cell-output-display}\n![Regression of Tip and Total Bill](predictive_files/figure-html/fig-r-reg-equation-3.png){#fig-r-reg-equation width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Model Results \nsimple_reg = lm(tip ~ total_bill, data = tips)\nsummary(simple_reg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = tip ~ total_bill, data = tips)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.1982 -0.5652 -0.0974  0.4863  3.7434 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 0.920270   0.159735   5.761 2.53e-08 ***\ntotal_bill  0.105025   0.007365  14.260  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.022 on 242 degrees of freedom\nMultiple R-squared:  0.4566,\tAdjusted R-squared:  0.4544 \nF-statistic: 203.4 on 1 and 242 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nbroom::tidy(simple_reg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)    0.920   0.160        5.76 2.53e- 8\n2 total_bill     0.105   0.00736     14.3  6.69e-34\n```\n\n\n:::\n\n```{.r .cell-code}\nbroom::glance(simple_reg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 12\n  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC\n      <dbl>         <dbl> <dbl>     <dbl>    <dbl> <dbl>  <dbl> <dbl> <dbl>\n1     0.457         0.454  1.02      203. 6.69e-34     1  -351.  707.  718.\n# ℹ 3 more variables: deviance <dbl>, df.residual <int>, nobs <int>\n```\n\n\n:::\n\n```{.r .cell-code}\nbroom::augment(simple_reg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 244 × 8\n     tip total_bill .fitted  .resid    .hat .sigma   .cooksd .std.resid\n   <dbl>      <dbl>   <dbl>   <dbl>   <dbl>  <dbl>     <dbl>      <dbl>\n 1  1.01      17.0     2.70 -1.69   0.00450   1.02 0.00625      -1.66  \n 2  1.66      10.3     2.01 -0.346  0.00873   1.02 0.000510     -0.340 \n 3  3.5       21.0     3.13  0.373  0.00418   1.02 0.000281      0.366 \n 4  3.31      23.7     3.41 -0.0973 0.00489   1.02 0.0000223    -0.0954\n 5  3.61      24.6     3.50  0.107  0.00530   1.02 0.0000294     0.105 \n 6  4.71      25.3     3.58  1.13   0.00567   1.02 0.00353       1.11  \n 7  2          8.77    1.84  0.159  0.0104    1.02 0.000128      0.156 \n 8  3.12      26.9     3.74 -0.623  0.00671   1.02 0.00127      -0.612 \n 9  1.96      15.0     2.50 -0.540  0.00527   1.02 0.000743     -0.530 \n10  3.23      14.8     2.47  0.757  0.00540   1.02 0.00150       0.743 \n# ℹ 234 more rows\n```\n\n\n:::\n:::\n\n\n\n\n## Python\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# To run the regression model\nfrom scipy import stats\nimport statsmodels.api as sm\nimport statsmodels.formula.api as smf\n\nsimple_reg = smf.ols('tip ~ total_bill', data = tips)\nsimple_reg_model = simple_reg.fit()\n## adding fitted and residual to the dataframe \ntips['fitted'] = simple_reg_model.fittedvalues\ntips['residual'] = simple_reg_model.resid\ntips.head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   total_bill   tip     sex smoker  day    time  size    fitted  residual\n0       16.99  1.01  Female     No  Sun  Dinner     2  2.704636 -1.694636\n1       10.34  1.66    Male     No  Sun  Dinner     3  2.006223 -0.346223\n2       21.01  3.50    Male     No  Sun  Dinner     3  3.126835  0.373165\n3       23.68  3.31    Male     No  Sun  Dinner     2  3.407250 -0.097250\n4       24.59  3.61  Female     No  Sun  Dinner     4  3.502822  0.107178\n```\n\n\n:::\n\n```{.python .cell-code}\nsimple_re_parameters = simple_reg_model.params\n# Visualization \nplt.figure(figsize = (12, 8))\nplt.scatter(tips['total_bill'], tips['tip'])\nplt.xlabel(\"Total Bill\")\nplt.ylabel(\"Tip\")\nplt.plot(tips['total_bill'], \n    simple_re_parameters.Intercept+simple_re_parameters.total_bill*tips['total_bill'], \n    label = 'Y={:.4f}+{:.4f}X'.format(simple_re_parameters.Intercept, simple_re_parameters.total_bill), \n    color = \"red\")\nplt.legend()\n```\n\n::: {.cell-output-display}\n![Regression of Tip and Total Bill](predictive_files/figure-html/fig-py-reg-equation-1.png){#fig-py-reg-equation width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n# Model Results \nsimple_reg_model.summary()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<table class=\"simpletable\">\n<caption>OLS Regression Results</caption>\n<tr>\n  <th>Dep. Variable:</th>           <td>tip</td>       <th>  R-squared:         </th> <td>   0.457</td>\n</tr>\n<tr>\n  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.454</td>\n</tr>\n<tr>\n  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   203.4</td>\n</tr>\n<tr>\n  <th>Date:</th>             <td>Mon, 10 Mar 2025</td> <th>  Prob (F-statistic):</th> <td>6.69e-34</td>\n</tr>\n<tr>\n  <th>Time:</th>                 <td>23:27:06</td>     <th>  Log-Likelihood:    </th> <td> -350.54</td>\n</tr>\n<tr>\n  <th>No. Observations:</th>      <td>   244</td>      <th>  AIC:               </th> <td>   705.1</td>\n</tr>\n<tr>\n  <th>Df Residuals:</th>          <td>   242</td>      <th>  BIC:               </th> <td>   712.1</td>\n</tr>\n<tr>\n  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   \n</tr>\n<tr>\n  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   \n</tr>\n</table>\n<table class=\"simpletable\">\n<tr>\n       <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  \n</tr>\n<tr>\n  <th>Intercept</th>  <td>    0.9203</td> <td>    0.160</td> <td>    5.761</td> <td> 0.000</td> <td>    0.606</td> <td>    1.235</td>\n</tr>\n<tr>\n  <th>total_bill</th> <td>    0.1050</td> <td>    0.007</td> <td>   14.260</td> <td> 0.000</td> <td>    0.091</td> <td>    0.120</td>\n</tr>\n</table>\n<table class=\"simpletable\">\n<tr>\n  <th>Omnibus:</th>       <td>20.185</td> <th>  Durbin-Watson:     </th> <td>   2.151</td>\n</tr>\n<tr>\n  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  37.750</td>\n</tr>\n<tr>\n  <th>Skew:</th>          <td> 0.443</td> <th>  Prob(JB):          </th> <td>6.35e-09</td>\n</tr>\n<tr>\n  <th>Kurtosis:</th>      <td> 4.711</td> <th>  Cond. No.          </th> <td>    53.0</td>\n</tr>\n</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n```\n\n:::\n:::\n\n\n\n\n\n:::\n\n:::\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n### Evaluating Linear Regression Models - Assessing the Fitness\n\n::: {style=\"text-align: justify\"}\n     When we build a linear regression model, we need to check the accuracy of the model by evaluating different parameters of the model. Some of the parameters that need to be evaluated are discussed below -\n\n#### F-statistic and Overall P-value\n\n     The F-statistic of the model tests whether the linear model provides a better fit of the data than the model that contains no independent variables. The null hypothesis is that the model as a whole does not explain a significant amount of variance of the data.\n\n#### Coefficient of Determination ($R^2$) and Adjusted $R^2$\n\n     Coefficient of determination is a statistical metric that measures the proportion of the variance of the target variable explained by the independent variables. The coefficient of determination is represented by $R^2$. The value of $R^2$ ranges between $0$ and $1$, where $0$ indicates poor fit and $1$ indicates perfect fit. There is a problem with $R^2$; it increases as the number of independent variable increases. Therefore, when we compare models with different numbers of independent variables, adjuted $R^2$ is used to evaluate the model because it penalizes models with a large number of predictors.\n\n#### P-value of Parameter Estimates\n\n     In addition to overall p-value associated with the model, linear regression models generate p-value for each predicators (parameter estimates). This p-value tests the null hypothesis that the coefficient is zero (or it does not have any effect on outcome variable). A low p-value (\\<0.05) indicates that we can reject the null hypothesis, meaning that a predictor with a low p-value should be included in the model because it has statistically significant effect on the target variable.\n\n#### Residual Standard Error (RSE)\n\n     Residual Standard Error (RSE) measures how far away an observation is from the prediction (regression line). In another words, it is mean (average) distance between the actual outcome and regression line. For example, @fig-r-reg-equation regression equation's RSE is 1.022, which means the regression model predicts tip with an avearagr error 1.022.\n:::\n\n::: {style=\"text-align: justify\"}\n\n### Assumptions of Linear Regression\n\n     Linear regression follows some assumptions. After fitting a regression model, we should check the assumptions of the model.\n\n1.  **Linearity (Linear Relationship)**:\n\n     There must be a linear relationship between the outcome variable (y) and predictors (x). @fig-assump1 shows what we want to see and @fig-r-assump1 and @fig-py-assump1 show what we see from one of our models.\n\n![Assumption 1- What We Want to See](images/Linear_Reg_Assump1.webp){#fig-assump1 fig-align=\"center\"}\n\n::: panel-tabset\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(lm(tip ~ total_bill, data = tips),1)\n```\n\n::: {.cell-output-display}\n![Testing Assumption 1](predictive_files/figure-html/fig-r-assump1-1.png){#fig-r-assump1 width=672}\n:::\n:::\n\n\n\n\n## Python\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n#######################################################\n# Testing Model Assumptions \n#######################################################\nimport numpy as np\nimport pandas as pd\nimport statsmodels.api as sm\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom statsmodels.stats.outliers_influence import variance_inflation_factor\nfrom statsmodels.stats.stattools import durbin_watson\n\n# Example Data\n\nimport pandas as pd\nimport statsmodels.api as sm\n\n# Assuming your dataset is named 'tips'\n# Convert categorical variables into dummy variables\ntips = sns.load_dataset(\"tips\")\ntips = pd.get_dummies(tips, columns=['sex', 'smoker', 'day'], drop_first=True,\n                       dtype = int)\n\n# Now, you can add the constant\nX = sm.add_constant(tips[['total_bill', 'size', 'sex_Female', 'smoker_No', 'day_Fri', 'day_Sat', 'day_Sun']])\ny = tips['tip']  # Assuming 'tip' is the dependent variable\n\n# Fit the model\nmodel = sm.OLS(y, X).fit()\n\n# Print summary\nprint(model.summary())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                            OLS Regression Results                            \n==============================================================================\nDep. Variable:                    tip   R-squared:                       0.470\nModel:                            OLS   Adj. R-squared:                  0.454\nMethod:                 Least Squares   F-statistic:                     29.90\nDate:                Mon, 10 Mar 2025   Prob (F-statistic):           2.12e-29\nTime:                        23:27:07   Log-Likelihood:                -347.49\nNo. Observations:                 244   AIC:                             711.0\nDf Residuals:                     236   BIC:                             739.0\nDf Model:                           7                                         \nCovariance Type:            nonrobust                                         \n==============================================================================\n                 coef    std err          t      P>|t|      [0.025      0.975]\n------------------------------------------------------------------------------\nconst          0.5917      0.255      2.318      0.021       0.089       1.095\ntotal_bill     0.0943      0.010      9.922      0.000       0.076       0.113\nsize           0.1770      0.089      1.987      0.048       0.001       0.353\nsex_Female     0.0324      0.141      0.230      0.819      -0.246       0.311\nsmoker_No      0.0849      0.146      0.581      0.561      -0.203       0.372\nday_Fri        0.1198      0.279      0.430      0.668      -0.429       0.669\nday_Sat       -0.0261      0.175     -0.149      0.882      -0.371       0.319\nday_Sun        0.0701      0.181      0.386      0.700      -0.287       0.428\n==============================================================================\nOmnibus:                       27.933   Durbin-Watson:                   2.095\nProb(Omnibus):                  0.000   Jarque-Bera (JB):               52.677\nSkew:                           0.608   Prob(JB):                     3.64e-12\nKurtosis:                       4.924   Cond. No.                         117.\n==============================================================================\n\nNotes:\n[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n```\n\n\n:::\n\n```{.python .cell-code}\n# 1. Linearity: Check Residual vs Fitted Plot ------------------ (1)\nfitted_values = model.fittedvalues\nresiduals = model.resid\nsns.residplot(x=fitted_values, y=residuals, lowess=True, line_kws={'color': 'red'})\nplt.xlabel('Fitted values')\nplt.ylabel('Residuals')\nplt.title('Residuals vs Fitted')\nplt.axhline(0, color='black', linestyle='--')\nplt.show()\n```\n\n::: {.cell-output-display}\n![Testing Assumption 1](predictive_files/figure-html/fig-py-assump1-1.png){#fig-py-assump1 width=672}\n:::\n:::\n\n\n\n\n\n\n:::\n\n2.  **Independence**:\n\n     Indpendence means that each observation (data point) is independent of the others, meaning that the error terms in the model are not correlated with each other and the occurrence of one observation does not influence the probability of another observation occurring; essentially, each data point should be considered a separate, unrelated event from the others. We can check this assumption by Durbin-Watson test. The null hypothesis (H~0~) is there is no correlation among the residuals. Basically, the test detects autocorrelation in the residuals of a linear regression model. The test statistic is a value between 0 and 4, with the following interpretations: 2: No autocorrelation; \\< 2: Positive autocorrelation; \\> 2: Negative autocorrelation. To solve the independence issue, it is suggested that for positive serial correlation, consider adding lags of the dependent and/or independent variable to the model. For negative serial correlation, check to make sure that none of your variables are overdifferenced, and For seasonal correlation, consider adding seasonal dummy variables to the model. However, as a rule of thumb, test statistic values between the range of 1.5 and 2.5 are considered normal. One limitation of the DW test is that it can only test for first-order serial correlation.\n\n     Alternatively, we can can visually examine a scatterplot of the residuals (errors) against the fitted values (@fig-r-assump1 and @fig-py-assump1); if there is no clear pattern, it suggests that the independence assumption is likely satisfied. Independence assmption is important because violating it can lead to unreliable hypothesis tests and confidence intervals.\n\n::: panel-tabset\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 4. Independence: Durbin-Watson Test --------------------------- (4)\nlibrary(car)\ndurbinWatsonTest(lm(tip ~ total_bill+size, data = tips))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n lag Autocorrelation D-W Statistic p-value\n   1     -0.05550935      2.100257   0.444\n Alternative hypothesis: rho != 0\n```\n\n\n:::\n:::\n\n\n\n\n\n## Python\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# 4. Independence: Durbin-Watson Test --------------------------- (4)\nfrom statsmodels.stats.stattools import durbin_watson\ndw_stat = durbin_watson(model.resid)\nprint(f'Durbin-Watson statistic: {dw_stat}')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nDurbin-Watson statistic: 2.094763480658097\n```\n\n\n:::\n:::\n\n\n\n\n\n:::\n\n3.  **Residual Error**:\n\n     The errors have a mean (expected) value zero ($0$), constant varianace (Homoscedasticity), and are independent from each other (otherwise auto-correlation problem) and predictor variables. We can check the assumption - expected value of errors are equal to 0 - by looking at @fig-r-assump1 and @fig-py-assump1. If there is a pattern in the plot, the assumption is violated.\n\n     The assumption homoscedasticity is tested using the Scale-Location plot, in which fitted values are compared with square root of standardized residuals. Theoretically, we want to see @fig-assump3. @fig-r-assump3 and @fig-py-assump3 show Scale-Location plot (also called spread-location plot) of our model. From @fig-r-assump3 and @fig-py-assump3, it is clear that residual plots have a trend (are not all equally spread out). Thus, the assumption is violated. One solution to the problem is that using log or square root transformation of outcome variable. Moreover, we can use Non-Constant Error Variance (NVC) test to test the assumption. If p-value of the test is less than 0.05, then null hypothesis is rejected, meaning that homoscedasticity is violated. Moreover, Breusch-Pagan test or White test can also be used to test homoscedasticity.\n\n     Finally, testing the assumption - errors are independent from each other and predictors - requires the knowledge of study design and data collection to establish the validity of this assumption. Violation of this assumption is also called **endogeneity** problem of the model, which is the same as assumption 6 - No Endogeneity below.\n\n![Assumption 3- What We Want to See](images/Linear_Reg_Assump3.webp){#fig-assump3 fig-align=\"center\"}\n\n::: panel-tabset\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 3. Homoscedasticity: Scale-Location Plot ----------------------- (3)\n# Scale-Location Plot \nplot(lm(tip ~ total_bill, data = tips),3)\n# Non-Constant Error Variance Test \nncvTest (lm(tip ~ total_bill, data = tips))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNon-constant Variance Score Test \nVariance formula: ~ fitted.values \nChisquare = 88.84011, Df = 1, p = < 2.22e-16\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Testing Assumption 3](predictive_files/figure-html/fig-r-assump3-1.png){#fig-r-assump3 width=672}\n:::\n:::\n\n\n\n\n\n## Python\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# 3. Homoscedasticity: Scale-Location Plot ----------------------- (3)\nstandardized_residuals = residuals / np.std(residuals)\nsns.scatterplot(x=fitted_values, y=np.sqrt(np.abs(standardized_residuals)), alpha=0.7)\nplt.xlabel('Fitted values')\nplt.ylabel('Sqrt(|Standardized Residuals|)')\nplt.title('Scale-Location Plot')\nplt.axhline(0, color='black', linestyle='--')\nplt.show()\n```\n\n::: {.cell-output-display}\n![Testing Assumption 3](predictive_files/figure-html/fig-py-assump3-1.png){#fig-py-assump3 width=672}\n:::\n:::\n\n\n\n:::\n\n\n\n:::\n\n4.  **Normality**:\n\n     The residuals are normally distributed. We can test this assumption by Q-Q plots (also called Quantile-Quantile plot) of the residuals. @fig-r-qqplot and @fig-py-qqplot show a QQ plot. The null hypothesis in KS test is - the residuals are drawn from a normal distribution. The dots do not lie perfectly ( a small deviation is acceptable) along the straight line. Moreover, Kolmogorov-Smirnov (KS) test can be used to check the normality assumption. KS tests whether a sample comes from a certain distribution. From the KS result below, we can see test statistic is 0.074052 and p-value is 0.1376, thus failing to reject null hypothesis and indicating that sample data does not come from a normal distribution.\n\n::: panel-tabset\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n###################################################\n## Simple Linear Regression model \n###################################################\nsimple_reg = lm (tip ~ total_bill, data = tips)\n#######################################\n# Drawing QQ Plot\n########################################\n## qqnorm () function \n#qqnorm((df_stockR$residual))\n## qqline () function \n#qqline(df_stockR$residual)\n# qqPlot () function from car package \nqqPlot(augment(simple_reg)$.resid) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 171 173\n```\n\n\n:::\n\n```{.r .cell-code}\n#########################################\n# Kolmogorov-Smirnov (KS) test\n##########################################\nlibrary(stats)\nks.test(augment(simple_reg)$.resid, \"pnorm\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tAsymptotic one-sample Kolmogorov-Smirnov test\n\ndata:  augment(simple_reg)$.resid\nD = 0.074052, p-value = 0.1376\nalternative hypothesis: two-sided\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Testing Assumption 4](predictive_files/figure-html/fig-r-qqplot-3.png){#fig-r-qqplot width=672}\n:::\n:::\n\n\n\n\n\n## Python\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# 2. Normality: Q-Q Plot for Residuals -------------------------- (2)\n#######################################\n# Drawing QQ Plot\n########################################\nsm.qqplot(residuals, line='s')\nplt.title('Q-Q Plot')\nplt.show()\n```\n\n::: {.cell-output-display}\n![Testing Assumption 4](predictive_files/figure-html/fig-py-qqplot-1.png){#fig-py-qqplot width=672}\n:::\n\n```{.python .cell-code}\n#########################################\n# Kolmogorov-Smirnov (KS) test\n##########################################\nfrom scipy.stats import kstest\nks_test = kstest(simple_reg_model.resid, \"norm\")\nlabel_ks = [\"KS Statistic\", \"P-value\"]\n\nfor stat, value in zip(label_ks, ks_test[:2]):\n    print('{}: {:.5f}'.format(stat, value))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nKS Statistic: 0.07405\nP-value: 0.13089\n```\n\n\n:::\n:::\n\n\n\n\n\n:::\n\n5.  **Multicollinearity**:\n\n     There is little or no correlation between the predictor variables. It makes difficult to interpret the coefficients of the model. Variance Inflation Factor (VIF) can be used to test the multicollinearity. A value equal to or greater than 10 of VIF indicates multicollinearity in the data. We see the VIF of `total_bill` and `size` is 1.56 and 1.56 respectively. Moreover, correlation matrix can also be used to identify the predictors that are highly correlated. @fig-r-corplot and @fig-py-corplot show a correlation plot of the variables in the model.\n\n::: panel-tabset\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 5. Multicollinearity: Variance Inflation Factor (VIF) ---------- (5)\n## Variance Inflation Factor (VIF)\nlibrary(car)\nvif(lm(tip ~ total_bill+size, data = tips))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntotal_bill       size \n  1.557586   1.557586 \n```\n\n\n:::\n\n```{.r .cell-code}\n## Correlation Matrix and Correlation Plot \n# to get the function \nsource(\"http://www.sthda.com/upload/rquery_cormat.r\")\nrquery.cormat(tips|> select(tip, total_bill,size), type = c(\"lower\"), graph = TRUE)$r\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           size  tip total_bill\nsize          1                \ntip        0.49    1           \ntotal_bill  0.6 0.68          1\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Correlation Plot](predictive_files/figure-html/fig-r-corplot-3.png){#fig-r-corplot width=672}\n:::\n:::\n\n\n\n\n\n## Python\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n## Correlation Matrix and Correlation Plot \n### Correlation Matrix\ncorrelation_matrix = tips[[\"tip\", \"total_bill\", \"size\"]].corr()\nprint(correlation_matrix)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                 tip  total_bill      size\ntip         1.000000    0.675734  0.489299\ntotal_bill  0.675734    1.000000  0.598315\nsize        0.489299    0.598315  1.000000\n```\n\n\n:::\n\n```{.python .cell-code}\n### Correlation Plot\nmask = np.triu(np.ones_like(tips[[\"tip\", \"total_bill\", \"size\"]].corr()))\nsns.heatmap(tips[[\"tip\", \"total_bill\", \"size\"]].corr(), \nannot=True, cmap=\"YlGnBu\", \nmask=mask)\n\n## Variance Inflation Factor (VIF)\n# 5. Multicollinearity: Variance Inflation Factor (VIF) ---------- (5)\nvif_data = pd.DataFrame()\nvif_data[\"feature\"] = X.columns\nfrom statsmodels.stats.outliers_influence import variance_inflation_factor\nvif_data[\"VIF\"] = [variance_inflation_factor(X.values, i) for i in range(X.shape[1])]\nprint(vif_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      feature        VIF\n0       const  15.215689\n1  total_bill   1.665250\n2        size   1.670404\n3  sex_Female   1.070126\n4   smoker_No   1.173230\n5     day_Fri   1.301245\n6     day_Sat   1.644496\n7     day_Sun   1.649463\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Correlation Plot](predictive_files/figure-html/fig-py-corplot-1.png){#fig-py-corplot width=672}\n:::\n:::\n\n\n\n\n\n:::\n\n6.  **No Endogeneity**:\n\n     There is no relation between the errors and the independent variables.\n\n#### Testing All Assumptions Together\n\n      We can test all of these assumptions at the same time using `check_model()` function from `performance` package in R.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(performance)\ncheck_model(simple_reg)\n```\n\n::: {.cell-output-display}\n![](predictive_files/figure-html/unnamed-chunk-56-3.png){width=672}\n:::\n:::\n\n\n\n\n\n::: {style=\"text-align: justify\"}\n### Multiple Linear Regression\n\n      Multiple regression analysis estimates the relationship between an outcome variable and two or more independent variables. More specifically, multiple regression analysis helps to understand how the value of the dependent variable changes when one of the independent variables varies, while the other independent variables remain constant.\n\n     We use Grunfeld dataset for multiple regressions. The dataset contains investment data for 11 US firms. The variables include - `invest`, which is Gross investment in 1947 dollars; `value`, which is market value as of Dec 31 in 1947 dollars; `capital`, which is stock of plant and equipment in 1947 dollars; `firm`, which include 11 US firms (General Motors, US Steel, General Electric, Chrysler, Atlantic Refining, IBM, Union Oil, Westinghouse, Goodyear, Diamond Match, American Steel); and `year`, which is 1935-1954. Our multiple regeression model is @eq-multiple -\n\n$$\ninvest_{it} = \\beta_{0} + \\beta_{1}value_{i} + \\beta_{3}capital_{it} + \\alpha_{it} + \\delta_{t} + \\epsilon_{it}\n$$ {#eq-multiple}\n\nWhere\n\n$invest_{it}$ is the gross investment of firm $i$ in year $t$\n\n$value_{it}$ is the market value of assets of firm $i$ in year $t$\n\n$capital_{it}$ is the stock value of plant and equipment of firm $i$ in year $t$\n\n$alpha_{i}$ is the fixed effect for firm $i$ (capturing unobserved firm-specific factors that don’t vary over time)\n\n$delta_{t}$ is the fixed effect for year $t$ (capturing unobserved year-specific factors that are common to all firms in that year)\n\n$epsilon_{it}$ is the error term, which includes all other unobserved factors that affect investment but are not accounted for by the independent variables or the fixed effects.\n\n     In @tbl-r-multiple and @tbl-py-multiple, we generate some multiple regression models.\n\n::: panel-tabset\n## R\n\n\n::: {#tbl-r-multiple .cell tbl-cap='Regression of Investment on Market Value and PPE'}\n\n```{.r .cell-code}\n#############################################################\n## Grunfeld Data from AER Package\n#############################################################\n# Grunfeld data contains investment data for 11 US firms. The variables \n# include - invest = \nlibrary(AER)\nlibrary(modelsummary)\nlibrary(kableExtra)\nlibrary(fixest)\ndata(\"Grunfeld\", package = \"AER\")\n\nmodels_r = list()\n\n# Model (1)\nmodels_r [['OLS_FYfe']] = feols(invest ~ value + capital | firm + year, data = Grunfeld)\n\n# Model (2)\nmodels_r [['OLS_FYfeC']] = feols(invest ~ value + capital | firm + year,\ncluster = ~firm,  \ndata = Grunfeld)\n\n# Model (3)\nmodels_r [['OLS_FYfeCtwo']] = feols(invest ~ value + capital | firm + year,\ncluster = ~firm+year,  \ndata = Grunfeld)\n\nrows = tribble(\n    ~term, ~'OLS_FYfe',~'OLS_FYfeC', ~'OLS_FYfeCtwo',\n    'Firm Fixed Effects', \"YES\", \"YES\", \"YES\",\n    \"Year Fixed Effects\", \"YES\", \"YES\", \"YES\"\n)\nattr(rows, 'position') = c (5,6)\n\n\n\nmodelsummary(models_r, fmt = 2,\nestimate = \"{estimate}{stars}\",\nstatistic = 'statistic'\n#,vcov = \"robust\" # robust clustering \n#,vcov = ~firm # clusting by firm\n#,vcov = vcovHAC\n,stars = c (\"*\" = 0.10, \"**\" = 0.05, \"***\" =  0.01)\n,coef_rename = c(\n    \"value\" = \"VALUE\",\n    \"capital\" = \"CAPITAL\"\n)\n#,gof_omit = 'DF|Deviance|AIC|BIC'\n,gof_map = c(\"nobs\", \"r.squared\", \"adj.r.squared\")\n,add_rows = rows\n#,notes = list(\n#'Note: In all models both firm and year fixed effects are controlled and in models 2 and 3 starndard errors', \n#'are clustered by firm (one-way cluster) and firm and year (two-way cluster) respectively. The numbers in parentheses indicate t values.')\n#,title = \"Title of the Table\"\n,output = \"kableExtra\"\n) |>\n# The line below is for styling the table, not necessary for regression table\n#kableExtra::kbl() |>\nkable_styling(full_width = TRUE) |>\nrow_spec(c(6,9), extra_css = \"border-bottom: 1.25px solid\") |>\nfootnote('In all models both firm and year fixed effects are controlled and in models 2 and 3 starndard errors are clustered by firm (one-way cluster) and firm and year (two-way cluster) respectively. The numbers in parentheses indicate t values.')\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table\" style=\"width: auto !important; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:center;\"> OLS_FYfe </th>\n   <th style=\"text-align:center;\"> OLS_FYfeC </th>\n   <th style=\"text-align:center;\"> OLS_FYfeCtwo </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> VALUE </td>\n   <td style=\"text-align:center;\"> 0.12*** </td>\n   <td style=\"text-align:center;\"> 0.12*** </td>\n   <td style=\"text-align:center;\"> 0.12*** </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> (10.17) </td>\n   <td style=\"text-align:center;\"> (10.17) </td>\n   <td style=\"text-align:center;\"> (10.28) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> CAPITAL </td>\n   <td style=\"text-align:center;\"> 0.35*** </td>\n   <td style=\"text-align:center;\"> 0.35*** </td>\n   <td style=\"text-align:center;\"> 0.35*** </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;box-shadow: 0px 1.5px\">  </td>\n   <td style=\"text-align:center;box-shadow: 0px 1.5px\"> (7.34) </td>\n   <td style=\"text-align:center;box-shadow: 0px 1.5px\"> (7.34) </td>\n   <td style=\"text-align:center;box-shadow: 0px 1.5px\"> (8.07) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Firm Fixed Effects </td>\n   <td style=\"text-align:center;\"> YES </td>\n   <td style=\"text-align:center;\"> YES </td>\n   <td style=\"text-align:center;\"> YES </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;border-bottom: 1.25px solid\"> Year Fixed Effects </td>\n   <td style=\"text-align:center;border-bottom: 1.25px solid\"> YES </td>\n   <td style=\"text-align:center;border-bottom: 1.25px solid\"> YES </td>\n   <td style=\"text-align:center;border-bottom: 1.25px solid\"> YES </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Num.Obs. </td>\n   <td style=\"text-align:center;\"> 220 </td>\n   <td style=\"text-align:center;\"> 220 </td>\n   <td style=\"text-align:center;\"> 220 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> R2 </td>\n   <td style=\"text-align:center;\"> 0.953 </td>\n   <td style=\"text-align:center;\"> 0.953 </td>\n   <td style=\"text-align:center;\"> 0.953 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;border-bottom: 1.25px solid\"> R2 Adj. </td>\n   <td style=\"text-align:center;border-bottom: 1.25px solid\"> 0.945 </td>\n   <td style=\"text-align:center;border-bottom: 1.25px solid\"> 0.945 </td>\n   <td style=\"text-align:center;border-bottom: 1.25px solid\"> 0.945 </td>\n  </tr>\n</tbody>\n<tfoot>\n<tr><td style=\"padding: 0; \" colspan=\"100%\"><span style=\"font-style: italic;\">Note: </span></td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> In all models both firm and year fixed effects are controlled and in models 2 and 3 starndard errors are clustered by firm (one-way cluster) and firm and year (two-way cluster) respectively. The numbers in parentheses indicate t values.</td></tr>\n</tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n## Python\n\n\n\n\n::: {#tbl-py-multiple .cell tbl-cap='Regression of Investment on Market Value and PPE'}\n\n```{.python .cell-code}\nimport pandas as pd\nimport numpy as np\nfrom statsmodels.datasets import grunfeld\ndata = grunfeld.load_pandas().data\ndata.year = data.year.astype(np.int64)\n\n# Link for pyfixest - \n# https://py-econometrics.github.io/pyfixest/quickstart.html\nimport pyfixest as pf\nfrom pyfixest.estimation import feols\n\n# Model (1)\nfe_model1 = feols(\n  \"invest ~ value + capital | firm + year\", \n  data = data)\n#fe_model1.summary()\n#pf.etable(fe_model1)\n#fe_model1.tidy()\n#fe_model1.coefplot()\n\n\n# Model (2)\nfe_model2 = feols(\n  \"invest ~ value + capital | firm + year\",\n  vcov= {\"CRV1\": \"firm\"}, \n  data = data)\n\n# Model (3)\nfe_model3 = feols(\n  \"invest ~ value + capital | firm + year\",\n  vcov= {\"CRV1\": \"firm+year\"}, \n  data = data)\n\npf.etable([fe_model1, fe_model2, fe_model3]\n#, type = \"gt\"\n,coef_fmt= 'b \\n (t)'\n,signif_code= [0.01,0.05,0.10]\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"cppjezghpn\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>\n#cppjezghpn table {\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n          -webkit-font-smoothing: antialiased;\n          -moz-osx-font-smoothing: grayscale;\n        }\n\n#cppjezghpn thead, tbody, tfoot, tr, td, th { border-style: none; }\n tr { background-color: transparent; }\n#cppjezghpn p { margin: 0; padding: 0; }\n #cppjezghpn .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: hidden; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }\n #cppjezghpn .gt_caption { padding-top: 4px; padding-bottom: 4px; }\n #cppjezghpn .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }\n #cppjezghpn .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }\n #cppjezghpn .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }\n #cppjezghpn .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }\n #cppjezghpn .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }\n #cppjezghpn .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 0px; border-left-color: white; border-right-style: none; border-right-width: 0px; border-right-color: white; vertical-align: bottom; padding-top: 4px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }\n #cppjezghpn .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }\n #cppjezghpn .gt_column_spanner_outer:first-child { padding-left: 0; }\n #cppjezghpn .gt_column_spanner_outer:last-child { padding-right: 0; }\n #cppjezghpn .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; vertical-align: bottom; padding-top: 4px; padding-bottom: 4px; overflow-x: hidden; display: inline-block; width: 100%; }\n #cppjezghpn .gt_spanner_row { border-bottom-style: hidden; }\n #cppjezghpn .gt_group_heading { padding-top: 0px; padding-bottom: 0px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 0px; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 0.5px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; border-left-style: none; border-left-width: 1px; border-left-color: white; border-right-style: none; border-right-width: 1px; border-right-color: white; vertical-align: middle; text-align: left; }\n #cppjezghpn .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 0px; font-weight: initial; border-top-style: solid; border-top-width: 0.5px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; vertical-align: middle; }\n #cppjezghpn .gt_from_md> :first-child { margin-top: 0; }\n #cppjezghpn .gt_from_md> :last-child { margin-bottom: 0; }\n #cppjezghpn .gt_row { padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: none; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 0px; border-left-color: white; border-right-style: none; border-right-width: 0px; border-right-color: white; vertical-align: middle; overflow-x: hidden; }\n #cppjezghpn .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: hidden; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }\n #cppjezghpn .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }\n #cppjezghpn .gt_row_group_first td { border-top-width: 0.5px; }\n #cppjezghpn .gt_row_group_first th { border-top-width: 0.5px; }\n #cppjezghpn .gt_striped { background-color: rgba(128,128,128,0.05); }\n #cppjezghpn .gt_table_body { border-top-style: solid; border-top-width: 0.5px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: black; }\n #cppjezghpn .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }\n #cppjezghpn .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }\n #cppjezghpn .gt_left { text-align: left; }\n #cppjezghpn .gt_center { text-align: center; }\n #cppjezghpn .gt_right { text-align: right; font-variant-numeric: tabular-nums; }\n #cppjezghpn .gt_font_normal { font-weight: normal; }\n #cppjezghpn .gt_font_bold { font-weight: bold; }\n #cppjezghpn .gt_font_italic { font-style: italic; }\n #cppjezghpn .gt_super { font-size: 65%; }\n #cppjezghpn .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }\n #cppjezghpn .gt_asterisk { font-size: 100%; vertical-align: 0; }\n \n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n<thead>\n\n<tr class=\"gt_col_headings gt_spanner_row\">\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n  <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"3\" scope=\"colgroup\" id=\"invest\">\n    <span class=\"gt_column_spanner\">invest</span>\n  </th>\n</tr>\n<tr class=\"gt_col_headings\">\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"(1)\">(1)</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"(2)\">(2)</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"(3)\">(3)</th>\n</tr>\n</thead>\n<tbody class=\"gt_table_body\">\n  <tr class=\"gt_group_heading_row\">\n    <th class=\"gt_group_heading\" colspan=\"4\">coef</th>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">value</th>\n    <td class=\"gt_row gt_center\">0.117*** <br> (10.669)</td>\n    <td class=\"gt_row gt_center\">0.117*** <br> (10.669)</td>\n    <td class=\"gt_row gt_center\">0.117*** <br> (10.306)</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">capital</th>\n    <td class=\"gt_row gt_center\">0.351*** <br> (7.701)</td>\n    <td class=\"gt_row gt_center\">0.351*** <br> (7.701)</td>\n    <td class=\"gt_row gt_center\">0.351*** <br> (8.091)</td>\n  </tr>\n  <tr class=\"gt_group_heading_row\">\n    <th class=\"gt_group_heading\" colspan=\"4\">fe</th>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">firm</th>\n    <td class=\"gt_row gt_center\">x</td>\n    <td class=\"gt_row gt_center\">x</td>\n    <td class=\"gt_row gt_center\">x</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">year</th>\n    <td class=\"gt_row gt_center\">x</td>\n    <td class=\"gt_row gt_center\">x</td>\n    <td class=\"gt_row gt_center\">x</td>\n  </tr>\n  <tr class=\"gt_group_heading_row\">\n    <th class=\"gt_group_heading\" colspan=\"4\">stats</th>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">Observations</th>\n    <td class=\"gt_row gt_center\">220</td>\n    <td class=\"gt_row gt_center\">220</td>\n    <td class=\"gt_row gt_center\">220</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">S.E. type</th>\n    <td class=\"gt_row gt_center\">by: firm</td>\n    <td class=\"gt_row gt_center\">by: firm</td>\n    <td class=\"gt_row gt_center\">by: firm+year</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">R<sup>2</sup></th>\n    <td class=\"gt_row gt_center\">0.953</td>\n    <td class=\"gt_row gt_center\">0.953</td>\n    <td class=\"gt_row gt_center\">0.953</td>\n  </tr>\n</tbody>\n  <tfoot class=\"gt_sourcenotes\">\n  \n  <tr>\n    <td class=\"gt_sourcenote\" colspan=\"4\">Significance levels: * p &lt; 0.1, ** p &lt; 0.05, *** p &lt; 0.01. Format of coefficient cell:\nCoefficient \n (t-stats)</td>\n  </tr>\n\n</tfoot>\n\n</table>\n\n</div>\n        \n```\n\n:::\n:::\n\n:::\n:::\n\n\n::: {style=\"text-align: justify\"}\n#### Relation Between Tips and Total Bill in Restaurant  \n\n          Here we run multiple linear regression models and evaluate the model assumptions.\n:::\n \n\n::: panel-tabset\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Loading Packages \nlibrary(AER)\nlibrary(modelsummary)\nlibrary(kableExtra)\nlibrary(fixest)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# All models \nmodels_r = list()\n\n## Model ----------------------------------------- (1)\nmodels_r[[\"Model1\"]] = feols(tip ~ total_bill+size, data = tips)\n## Model ----------------------------------------- (2)\ntips = tips |> \n  mutate(Gender = if_else(sex == \"Female\", 0,1)) \n\nmodels_r[[\"Model2\"]] = feols(tip ~ total_bill+size+Gender, data = tips)\n\n ## Model ----------------------------------------- (3)\nmodels_r[[\"Model3\"]] = feols(tip ~ total_bill+size+Gender+smoker, data = tips)\n## Model ----------------------------------------- (4)\nmodels_r[[\"Model4\"]] = feols(tip ~ total_bill+size+Gender+smoker+time, data = tips)\n## Model ----------------------------------------- (5)\ntips = tips |> \n  mutate(day_Thur = if_else(day == \"Thur\", 1,0),\n        day_Fri = if_else(day == \"Fri\", 1, 0),\n        day_Sat = if_else(day == \"Sat\", 1, 0)\n        )\nmodels_r[[\"Model5\"]] = feols(tip ~ total_bill+size+Gender+smoker+time+day_Thur + day_Fri + day_Sat, data = tips)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Regression Table\nmodelsummary(models_r, fmt = 2,\n              estimate = \"{estimate}{stars}\",\n              statistic = \"statistic\"\n              ,stars = c (\"*\" = 0.10, \"**\" = 0.05, \"***\" =  0.01)\n              ,gof_map = c(\"nobs\", \"r.squared\", \"adj.r.squared\")\n              ,output = \"kableExtra\"\n            ) |> \n  footnote('Numbers in parentheses are t values.') |> \n  kable_styling(full_width = TRUE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:center;\"> Model1 </th>\n   <th style=\"text-align:center;\"> &amp;nbsp;Model2 </th>\n   <th style=\"text-align:center;\"> &amp;nbsp;Model3 </th>\n   <th style=\"text-align:center;\"> &amp;nbsp;Model4 </th>\n   <th style=\"text-align:center;\"> &amp;nbsp;Model5 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:center;\"> 0.67*** </td>\n   <td style=\"text-align:center;\"> 0.68*** </td>\n   <td style=\"text-align:center;\"> 0.72*** </td>\n   <td style=\"text-align:center;\"> 0.73*** </td>\n   <td style=\"text-align:center;\"> 0.78*** </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> (3.46) </td>\n   <td style=\"text-align:center;\"> (3.32) </td>\n   <td style=\"text-align:center;\"> (3.34) </td>\n   <td style=\"text-align:center;\"> (3.12) </td>\n   <td style=\"text-align:center;\"> (2.99) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> total_bill </td>\n   <td style=\"text-align:center;\"> 0.09*** </td>\n   <td style=\"text-align:center;\"> 0.09*** </td>\n   <td style=\"text-align:center;\"> 0.09*** </td>\n   <td style=\"text-align:center;\"> 0.09*** </td>\n   <td style=\"text-align:center;\"> 0.09*** </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> (10.17) </td>\n   <td style=\"text-align:center;\"> (10.10) </td>\n   <td style=\"text-align:center;\"> (10.00) </td>\n   <td style=\"text-align:center;\"> (9.90) </td>\n   <td style=\"text-align:center;\"> (9.84) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> size </td>\n   <td style=\"text-align:center;\"> 0.19** </td>\n   <td style=\"text-align:center;\"> 0.19** </td>\n   <td style=\"text-align:center;\"> 0.18** </td>\n   <td style=\"text-align:center;\"> 0.18** </td>\n   <td style=\"text-align:center;\"> 0.18* </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> (2.26) </td>\n   <td style=\"text-align:center;\"> (2.25) </td>\n   <td style=\"text-align:center;\"> (2.05) </td>\n   <td style=\"text-align:center;\"> (2.04) </td>\n   <td style=\"text-align:center;\"> (1.97) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gender </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> −0.03 </td>\n   <td style=\"text-align:center;\"> −0.03 </td>\n   <td style=\"text-align:center;\"> −0.03 </td>\n   <td style=\"text-align:center;\"> −0.03 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> (−0.19) </td>\n   <td style=\"text-align:center;\"> (−0.20) </td>\n   <td style=\"text-align:center;\"> (−0.20) </td>\n   <td style=\"text-align:center;\"> (−0.23) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> smokerYes </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> −0.08 </td>\n   <td style=\"text-align:center;\"> −0.08 </td>\n   <td style=\"text-align:center;\"> −0.09 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> (−0.61) </td>\n   <td style=\"text-align:center;\"> (−0.60) </td>\n   <td style=\"text-align:center;\"> (−0.59) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> timeLunch </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 0.07 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> (−0.03) </td>\n   <td style=\"text-align:center;\"> (0.15) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> day_Thur </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> −0.14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> (−0.29) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> day_Fri </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> 0.03 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> (0.08) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> day_Sat </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> −0.10 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;box-shadow: 0px 1.5px\">  </td>\n   <td style=\"text-align:center;box-shadow: 0px 1.5px\">  </td>\n   <td style=\"text-align:center;box-shadow: 0px 1.5px\">  </td>\n   <td style=\"text-align:center;box-shadow: 0px 1.5px\">  </td>\n   <td style=\"text-align:center;box-shadow: 0px 1.5px\">  </td>\n   <td style=\"text-align:center;box-shadow: 0px 1.5px\"> (−0.58) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Num.Obs. </td>\n   <td style=\"text-align:center;\"> 244 </td>\n   <td style=\"text-align:center;\"> 244 </td>\n   <td style=\"text-align:center;\"> 244 </td>\n   <td style=\"text-align:center;\"> 244 </td>\n   <td style=\"text-align:center;\"> 244 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> R2 </td>\n   <td style=\"text-align:center;\"> 0.468 </td>\n   <td style=\"text-align:center;\"> 0.468 </td>\n   <td style=\"text-align:center;\"> 0.469 </td>\n   <td style=\"text-align:center;\"> 0.469 </td>\n   <td style=\"text-align:center;\"> 0.470 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> R2 Adj. </td>\n   <td style=\"text-align:center;\"> 0.463 </td>\n   <td style=\"text-align:center;\"> 0.461 </td>\n   <td style=\"text-align:center;\"> 0.460 </td>\n   <td style=\"text-align:center;\"> 0.458 </td>\n   <td style=\"text-align:center;\"> 0.452 </td>\n  </tr>\n</tbody>\n<tfoot>\n<tr><td style=\"padding: 0; \" colspan=\"100%\"><span style=\"font-style: italic;\">Note: </span></td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Numbers in parentheses are t values.</td></tr>\n</tfoot>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#######################################################\n# Testing Model Assumptions \n#######################################################\n# 1. Linearity: Check Residual vs Fitted Plot ------------------ (1)\nplot(lm(tip ~ total_bill+size+Gender+smoker+time+day_Thur + day_Fri + day_Sat, data = tips),1)\n```\n\n::: {.cell-output-display}\n![](predictive_files/figure-html/unnamed-chunk-63-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# 2. Normality: Q-Q Plot for Residuals -------------------------- (2)\n#######################################\n# Drawing QQ Plot\n########################################\nqqPlot(augment(lm(tip ~ total_bill+size+Gender+smoker+time+day_Thur + day_Fri + day_Sat, data = tips))$.resid)\n```\n\n::: {.cell-output-display}\n![](predictive_files/figure-html/unnamed-chunk-63-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 171 173\n```\n\n\n:::\n\n```{.r .cell-code}\n# 3. Homoscedasticity: Scale-Location Plot ----------------------- (3)\n# Scale-Location Plot \nplot(lm(tip ~ total_bill+size+Gender+smoker+time+day_Thur + day_Fri + day_Sat, data = tips),3)\n```\n\n::: {.cell-output-display}\n![](predictive_files/figure-html/unnamed-chunk-63-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# 4. Independence: Durbin-Watson Test --------------------------- (4)\nlibrary(car)\ndurbinWatsonTest(lm(tip ~ total_bill+size+Gender+smoker+time+day_Thur + day_Fri + day_Sat, data = tips))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n lag Autocorrelation D-W Statistic p-value\n   1     -0.05420024      2.096103   0.612\n Alternative hypothesis: rho != 0\n```\n\n\n:::\n\n```{.r .cell-code}\n# 5. Multicollinearity: Variance Inflation Factor (VIF) ---------- (5)\n## Variance Inflation Factor (VIF)\nlibrary(car)\nvif(lm(tip ~ total_bill+size+Gender+smoker+time+day_Thur + day_Fri + day_Sat, data = tips))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntotal_bill       size     Gender     smoker       time   day_Thur    day_Fri \n  1.692370   1.679494   1.070126   1.178870   9.242900   9.808506   1.724116 \n   day_Sat \n  1.468352 \n```\n\n\n:::\n:::\n\n\n\n## Python \n\n\n::: {.cell}\n\n```{.python .cell-code}\n# loading the packages\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n# To run the regression model\nfrom scipy import stats\nimport statsmodels.api as sm\nimport statsmodels.formula.api as smf\n###################################################\n# Multiple Linear Regression Model \n###################################################\nimport pyfixest as pf\nfrom pyfixest.estimation import feols\ntips = sns.load_dataset(\"tips\")\n## Model ----------------------------------------- (1)\nfe_model1 = feols(\"tip~total_bill+size\", data = tips)\n#fe_model1.summary()\nfe_model1.tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Estimate  Std. Error    t value  Pr(>|t|)      2.5%     97.5%\nCoefficient                                                               \nIntercept    0.668945    0.193609   3.455127  0.000650  0.287562  1.050327\ntotal_bill   0.092713    0.009115  10.171867  0.000000  0.074759  0.110668\nsize         0.192598    0.085315   2.257502  0.024872  0.024540  0.360655\n```\n\n\n:::\n\n```{.python .cell-code}\n#pf.etable(fe_model1)\n#fe_model1.coefplot()\n\n## Model ----------------------------------------- (2)\n#tips['Gender'] = tips['sex'].map({'Female':0, 'Male':1})\n\nfe_model2 = feols(\"tip~total_bill+size+sex\", data = tips)\n\n#fe_model2 = feols(\"tip~total_bill+size+Gender\", data = tips)\n#fe_model2.summary()\n#fe_model2.tidy()\n#pf.etable([fe_model1, fe_model2]\n#          ,coef_fmt= 'b \\n (t)'\n#          ,signif_code= [0.01,0.05,0.10]\n#        )\n\n## Model ----------------------------------------- (3)\nfe_model3 = feols(\"tip~total_bill+size+sex+smoker\", data = tips)\n\n## Model ----------------------------------------- (4)\nfe_model4 = feols(\"tip~total_bill+size+sex+smoker+time\", data = tips)\n## Model ----------------------------------------- (5)\ntips = pd.get_dummies(tips, columns = ['day'],dtype = int) # adding the dummy variables of the day variable\n\n## Model ----------------------------------------- (4)\nfe_model5 = feols(\"tip~total_bill+size+sex+smoker+time+day_Thur + day_Fri + day_Sat\", data = tips)\n#fe_model5.summary()\n#fe_model5.tidy()\n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\npf.etable([fe_model1, fe_model2, fe_model3,fe_model4, fe_model5]\n          ,coef_fmt= 'b \\n (t)'\n          ,signif_code= [0.01,0.05,0.10]\n\n        )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"stcvpbmqdk\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>\n#stcvpbmqdk table {\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n          -webkit-font-smoothing: antialiased;\n          -moz-osx-font-smoothing: grayscale;\n        }\n\n#stcvpbmqdk thead, tbody, tfoot, tr, td, th { border-style: none; }\n tr { background-color: transparent; }\n#stcvpbmqdk p { margin: 0; padding: 0; }\n #stcvpbmqdk .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: hidden; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }\n #stcvpbmqdk .gt_caption { padding-top: 4px; padding-bottom: 4px; }\n #stcvpbmqdk .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }\n #stcvpbmqdk .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }\n #stcvpbmqdk .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }\n #stcvpbmqdk .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }\n #stcvpbmqdk .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }\n #stcvpbmqdk .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 0px; border-left-color: white; border-right-style: none; border-right-width: 0px; border-right-color: white; vertical-align: bottom; padding-top: 4px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }\n #stcvpbmqdk .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }\n #stcvpbmqdk .gt_column_spanner_outer:first-child { padding-left: 0; }\n #stcvpbmqdk .gt_column_spanner_outer:last-child { padding-right: 0; }\n #stcvpbmqdk .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; vertical-align: bottom; padding-top: 4px; padding-bottom: 4px; overflow-x: hidden; display: inline-block; width: 100%; }\n #stcvpbmqdk .gt_spanner_row { border-bottom-style: hidden; }\n #stcvpbmqdk .gt_group_heading { padding-top: 0px; padding-bottom: 0px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 0px; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 0.5px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; border-left-style: none; border-left-width: 1px; border-left-color: white; border-right-style: none; border-right-width: 1px; border-right-color: white; vertical-align: middle; text-align: left; }\n #stcvpbmqdk .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 0px; font-weight: initial; border-top-style: solid; border-top-width: 0.5px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; vertical-align: middle; }\n #stcvpbmqdk .gt_from_md> :first-child { margin-top: 0; }\n #stcvpbmqdk .gt_from_md> :last-child { margin-bottom: 0; }\n #stcvpbmqdk .gt_row { padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: none; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 0px; border-left-color: white; border-right-style: none; border-right-width: 0px; border-right-color: white; vertical-align: middle; overflow-x: hidden; }\n #stcvpbmqdk .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: hidden; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }\n #stcvpbmqdk .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }\n #stcvpbmqdk .gt_row_group_first td { border-top-width: 0.5px; }\n #stcvpbmqdk .gt_row_group_first th { border-top-width: 0.5px; }\n #stcvpbmqdk .gt_striped { background-color: rgba(128,128,128,0.05); }\n #stcvpbmqdk .gt_table_body { border-top-style: solid; border-top-width: 0.5px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: black; }\n #stcvpbmqdk .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }\n #stcvpbmqdk .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }\n #stcvpbmqdk .gt_left { text-align: left; }\n #stcvpbmqdk .gt_center { text-align: center; }\n #stcvpbmqdk .gt_right { text-align: right; font-variant-numeric: tabular-nums; }\n #stcvpbmqdk .gt_font_normal { font-weight: normal; }\n #stcvpbmqdk .gt_font_bold { font-weight: bold; }\n #stcvpbmqdk .gt_font_italic { font-style: italic; }\n #stcvpbmqdk .gt_super { font-size: 65%; }\n #stcvpbmqdk .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }\n #stcvpbmqdk .gt_asterisk { font-size: 100%; vertical-align: 0; }\n \n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n<thead>\n\n<tr class=\"gt_col_headings gt_spanner_row\">\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n  <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"5\" scope=\"colgroup\" id=\"tip\">\n    <span class=\"gt_column_spanner\">tip</span>\n  </th>\n</tr>\n<tr class=\"gt_col_headings\">\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"(1)\">(1)</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"(2)\">(2)</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"(3)\">(3)</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"(4)\">(4)</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"(5)\">(5)</th>\n</tr>\n</thead>\n<tbody class=\"gt_table_body\">\n  <tr class=\"gt_group_heading_row\">\n    <th class=\"gt_group_heading\" colspan=\"6\">coef</th>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">total_bill</th>\n    <td class=\"gt_row gt_center\">0.093*** <br> (10.172)</td>\n    <td class=\"gt_row gt_center\">0.093*** <br> (10.104)</td>\n    <td class=\"gt_row gt_center\">0.094*** <br> (9.996)</td>\n    <td class=\"gt_row gt_center\">0.094*** <br> (9.898)</td>\n    <td class=\"gt_row gt_center\">0.094*** <br> (9.841)</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">size</th>\n    <td class=\"gt_row gt_center\">0.193** <br> (2.258)</td>\n    <td class=\"gt_row gt_center\">0.193** <br> (2.253)</td>\n    <td class=\"gt_row gt_center\">0.180** <br> (2.049)</td>\n    <td class=\"gt_row gt_center\">0.180** <br> (2.045)</td>\n    <td class=\"gt_row gt_center\">0.176* <br> (1.966)</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">sex[T.Female]</th>\n    <td class=\"gt_row gt_center\"></td>\n    <td class=\"gt_row gt_center\">0.026 <br> (0.193)</td>\n    <td class=\"gt_row gt_center\">0.027 <br> (0.198)</td>\n    <td class=\"gt_row gt_center\">0.028 <br> (0.201)</td>\n    <td class=\"gt_row gt_center\">0.032 <br> (0.229)</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">smoker[T.No]</th>\n    <td class=\"gt_row gt_center\"></td>\n    <td class=\"gt_row gt_center\"></td>\n    <td class=\"gt_row gt_center\">0.084 <br> (0.605)</td>\n    <td class=\"gt_row gt_center\">0.084 <br> (0.605)</td>\n    <td class=\"gt_row gt_center\">0.086 <br> (0.589)</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">time[T.Dinner]</th>\n    <td class=\"gt_row gt_center\"></td>\n    <td class=\"gt_row gt_center\"></td>\n    <td class=\"gt_row gt_center\"></td>\n    <td class=\"gt_row gt_center\">0.005 <br> (0.033)</td>\n    <td class=\"gt_row gt_center\">-0.068 <br> (-0.153)</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">day_Thur</th>\n    <td class=\"gt_row gt_center\"></td>\n    <td class=\"gt_row gt_center\"></td>\n    <td class=\"gt_row gt_center\"></td>\n    <td class=\"gt_row gt_center\"></td>\n    <td class=\"gt_row gt_center\">-0.137 <br> (-0.290)</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">day_Fri</th>\n    <td class=\"gt_row gt_center\"></td>\n    <td class=\"gt_row gt_center\"></td>\n    <td class=\"gt_row gt_center\"></td>\n    <td class=\"gt_row gt_center\"></td>\n    <td class=\"gt_row gt_center\">0.025 <br> (0.079)</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">day_Sat</th>\n    <td class=\"gt_row gt_center\"></td>\n    <td class=\"gt_row gt_center\"></td>\n    <td class=\"gt_row gt_center\"></td>\n    <td class=\"gt_row gt_center\"></td>\n    <td class=\"gt_row gt_center\">-0.096 <br> (-0.579)</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">Intercept</th>\n    <td class=\"gt_row gt_center\">0.669*** <br> (3.455)</td>\n    <td class=\"gt_row gt_center\">0.655*** <br> (3.178)</td>\n    <td class=\"gt_row gt_center\">0.612*** <br> (2.793)</td>\n    <td class=\"gt_row gt_center\">0.608** <br> (2.531)</td>\n    <td class=\"gt_row gt_center\">0.728 <br> (1.442)</td>\n  </tr>\n  <tr class=\"gt_group_heading_row\">\n    <th class=\"gt_group_heading\" colspan=\"6\">stats</th>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">Observations</th>\n    <td class=\"gt_row gt_center\">244</td>\n    <td class=\"gt_row gt_center\">244</td>\n    <td class=\"gt_row gt_center\">244</td>\n    <td class=\"gt_row gt_center\">244</td>\n    <td class=\"gt_row gt_center\">244</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">S.E. type</th>\n    <td class=\"gt_row gt_center\">iid</td>\n    <td class=\"gt_row gt_center\">iid</td>\n    <td class=\"gt_row gt_center\">iid</td>\n    <td class=\"gt_row gt_center\">iid</td>\n    <td class=\"gt_row gt_center\">iid</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">R<sup>2</sup></th>\n    <td class=\"gt_row gt_center\">0.468</td>\n    <td class=\"gt_row gt_center\">0.468</td>\n    <td class=\"gt_row gt_center\">0.469</td>\n    <td class=\"gt_row gt_center\">0.469</td>\n    <td class=\"gt_row gt_center\">0.470</td>\n  </tr>\n</tbody>\n  <tfoot class=\"gt_sourcenotes\">\n  \n  <tr>\n    <td class=\"gt_sourcenote\" colspan=\"6\">Significance levels: * p &lt; 0.1, ** p &lt; 0.05, *** p &lt; 0.01. Format of coefficient cell:\nCoefficient \n (t-stats)</td>\n  </tr>\n\n</tfoot>\n\n</table>\n\n</div>\n        \n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\nfe_model5.coefplot()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<html lang=\"en\">\n   <head>\n       <meta charset=\"UTF-8\">\n       <style> html, body { margin: 0; padding: 0; } </style>\n       <script type=\"text/javascript\" data-lets-plot-script=\"library\" src=\"https://cdn.jsdelivr.net/gh/JetBrains/lets-plot@v4.6.1/js-package/distr/lets-plot.min.js\"></script>\n   </head>\n   <body>\n          <div id=\"4b0NXM\"></div>\n   <script type=\"text/javascript\" data-lets-plot-script=\"plot\">\n   \n   (function() {\n   // ----------\n   \n   const forceImmediateRender = false;\n   const responsive = false;\n   \n   let sizing = {\n       width_mode: \"MIN\",\n       height_mode: \"SCALED\",\n       width: null, \n       height: null \n   };\n   \n   const preferredWidth = document.body.dataset.letsPlotPreferredWidth;\n   if (preferredWidth !== undefined) {\n       sizing = {\n           width_mode: 'FIXED',\n           height_mode: 'SCALED',\n           width: parseFloat(preferredWidth)\n       };\n   }\n   \n   const containerDiv = document.getElementById(\"4b0NXM\");\n   let fig = null;\n   \n   function renderPlot() {\n       if (fig === null) {\n           const plotSpec = {\n\"data\":{\n\"Coefficient\":[\"Intercept\",\"total_bill\",\"size\",\"sex[T.Female]\",\"smoker[T.No]\",\"time[T.Dinner]\",\"day_Thur\",\"day_Fri\",\"day_Sat\"],\n\"Estimate\":[0.727615963763697,0.09448700598873899,0.1759920027535128,0.03244094033016657,0.0864083201631321,-0.06812860106154958,-0.13677853781229155,0.02548065978176648,-0.09597771660994465],\n\"2.5%\":[-0.2663380297125454,0.07557119301118578,-3.8750422719757704E-4,-0.24655059686109074,-0.20238434643267766,-0.9440727460100564,-1.0660721694245767,-0.6075113310890697,-0.42278269508904187],\n\"97.5%\":[1.7215699572399394,0.1134028189662922,0.35237150973422315,0.3114324775214239,0.37520098675894187,0.8078155438869572,0.7925150937999937,0.6584726506526027,0.2308272618691526],\n\"Model\":[\"tip~total_bill+size+sex+smoker+time+day_Thur+day_Fri+day_Sat: 95.0%\",\"tip~total_bill+size+sex+smoker+time+day_Thur+day_Fri+day_Sat: 95.0%\",\"tip~total_bill+size+sex+smoker+time+day_Thur+day_Fri+day_Sat: 95.0%\",\"tip~total_bill+size+sex+smoker+time+day_Thur+day_Fri+day_Sat: 95.0%\",\"tip~total_bill+size+sex+smoker+time+day_Thur+day_Fri+day_Sat: 95.0%\",\"tip~total_bill+size+sex+smoker+time+day_Thur+day_Fri+day_Sat: 95.0%\",\"tip~total_bill+size+sex+smoker+time+day_Thur+day_Fri+day_Sat: 95.0%\",\"tip~total_bill+size+sex+smoker+time+day_Thur+day_Fri+day_Sat: 95.0%\",\"tip~total_bill+size+sex+smoker+time+day_Thur+day_Fri+day_Sat: 95.0%\"]\n},\n\"mapping\":{\n\"x\":\"Coefficient\",\n\"y\":\"Estimate\",\n\"color\":\"Model\"\n},\n\"data_meta\":{\n\"series_annotations\":[{\n\"type\":\"int\",\n\"column\":\"level_0\"\n},{\n\"type\":\"str\",\n\"column\":\"Coefficient\"\n},{\n\"type\":\"int\",\n\"column\":\"index\"\n},{\n\"type\":\"float\",\n\"column\":\"Estimate\"\n},{\n\"type\":\"float\",\n\"column\":\"Std. Error\"\n},{\n\"type\":\"float\",\n\"column\":\"t value\"\n},{\n\"type\":\"float\",\n\"column\":\"Pr(>|t|)\"\n},{\n\"type\":\"float\",\n\"column\":\"2.5%\"\n},{\n\"type\":\"float\",\n\"column\":\"97.5%\"\n},{\n\"type\":\"str\",\n\"column\":\"Model\"\n}]\n},\n\"guides\":{\n\"y\":{\n\"title\":\"Estimate and 95.0% Confidence Interval\"\n}\n},\n\"coord\":{\n\"name\":\"flip\",\n\"flip\":true\n},\n\"ggsize\":{\n\"width\":500.0,\n\"height\":300.0\n},\n\"theme\":{\n\"axis_text_x\":{\n\"angle\":0.0,\n\"blank\":false\n}\n},\n\"kind\":\"plot\",\n\"scales\":[],\n\"layers\":[{\n\"geom\":\"point\",\n\"mapping\":{\n},\n\"position\":{\n\"name\":\"dodge\",\n\"width\":0.5\n},\n\"data_meta\":{\n},\n\"data\":{\n}\n},{\n\"geom\":\"errorbar\",\n\"mapping\":{\n\"ymin\":\"2.5%\",\n\"ymax\":\"97.5%\"\n},\n\"position\":{\n\"name\":\"dodge\",\n\"width\":0.5\n},\n\"data_meta\":{\n},\n\"width\":0.05,\n\"data\":{\n}\n},{\n\"geom\":\"hline\",\n\"mapping\":{\n},\n\"data_meta\":{\n},\n\"yintercept\":0.0,\n\"linetype\":\"dashed\",\n\"color\":\"black\",\n\"data\":{\n}\n}],\n\"metainfo_list\":[],\n\"spec_id\":\"1\"\n};\n           fig = LetsPlot.buildPlotFromProcessedSpecs(plotSpec, containerDiv, sizing);\n       } else {\n           fig.updateView({});\n       }\n   }\n   \n   const renderImmediately = \n       forceImmediateRender || (\n           sizing.width_mode === 'FIXED' && \n           (sizing.height_mode === 'FIXED' || sizing.height_mode === 'SCALED')\n       );\n   \n   if (renderImmediately) {\n       renderPlot();\n   }\n   \n   if (!renderImmediately || responsive) {\n       // Set up observer for initial sizing or continuous monitoring\n       var observer = new ResizeObserver(function(entries) {\n           for (let entry of entries) {\n               if (entry.contentBoxSize && \n                   entry.contentBoxSize[0].inlineSize > 0) {\n                   if (!responsive && observer) {\n                       observer.disconnect();\n                       observer = null;\n                   }\n                   renderPlot();\n                   if (!responsive) {\n                       break;\n                   }\n               }\n           }\n       });\n       \n       observer.observe(containerDiv);\n   }\n   \n   // ----------\n   })();\n   \n   </script>\n   </body>\n</html>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n#######################################################\n# Testing Model Assumptions \n#######################################################\nimport numpy as np\nimport pandas as pd\nimport statsmodels.api as sm\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom statsmodels.stats.outliers_influence import variance_inflation_factor\nfrom statsmodels.stats.stattools import durbin_watson\n\n# Example Data\n\nimport pandas as pd\nimport statsmodels.api as sm\n\n# Assuming your dataset is named 'tips'\n# Convert categorical variables into dummy variables\ntips = sns.load_dataset(\"tips\")\ntips = pd.get_dummies(tips, columns=['sex', 'smoker', 'day'], drop_first=True,\n                       dtype = int)\n\n# Now, you can add the constant\nX = sm.add_constant(tips[['total_bill', 'size', 'sex_Female', 'smoker_No', 'day_Fri', 'day_Sat', 'day_Sun']])\ny = tips['tip']  # Assuming 'tip' is the dependent variable\n\n# Fit the model\nmodel = sm.OLS(y, X).fit()\n\n# Print summary\nprint(model.summary())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                            OLS Regression Results                            \n==============================================================================\nDep. Variable:                    tip   R-squared:                       0.470\nModel:                            OLS   Adj. R-squared:                  0.454\nMethod:                 Least Squares   F-statistic:                     29.90\nDate:                Mon, 10 Mar 2025   Prob (F-statistic):           2.12e-29\nTime:                        23:27:49   Log-Likelihood:                -347.49\nNo. Observations:                 244   AIC:                             711.0\nDf Residuals:                     236   BIC:                             739.0\nDf Model:                           7                                         \nCovariance Type:            nonrobust                                         \n==============================================================================\n                 coef    std err          t      P>|t|      [0.025      0.975]\n------------------------------------------------------------------------------\nconst          0.5917      0.255      2.318      0.021       0.089       1.095\ntotal_bill     0.0943      0.010      9.922      0.000       0.076       0.113\nsize           0.1770      0.089      1.987      0.048       0.001       0.353\nsex_Female     0.0324      0.141      0.230      0.819      -0.246       0.311\nsmoker_No      0.0849      0.146      0.581      0.561      -0.203       0.372\nday_Fri        0.1198      0.279      0.430      0.668      -0.429       0.669\nday_Sat       -0.0261      0.175     -0.149      0.882      -0.371       0.319\nday_Sun        0.0701      0.181      0.386      0.700      -0.287       0.428\n==============================================================================\nOmnibus:                       27.933   Durbin-Watson:                   2.095\nProb(Omnibus):                  0.000   Jarque-Bera (JB):               52.677\nSkew:                           0.608   Prob(JB):                     3.64e-12\nKurtosis:                       4.924   Cond. No.                         117.\n==============================================================================\n\nNotes:\n[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n```\n\n\n:::\n\n```{.python .cell-code}\n# 1. Linearity: Check Residual vs Fitted Plot ------------------ (1)\nfitted_values = model.fittedvalues\nresiduals = model.resid\nsns.residplot(x=fitted_values, y=residuals, lowess=True, line_kws={'color': 'red'})\nplt.xlabel('Fitted values')\nplt.ylabel('Residuals')\nplt.title('Residuals vs Fitted')\nplt.axhline(0, color='black', linestyle='--')\nplt.show()\n```\n\n::: {.cell-output-display}\n![](predictive_files/figure-html/unnamed-chunk-68-1.png){width=672}\n:::\n\n```{.python .cell-code}\n# 2. Normality: Q-Q Plot for Residuals -------------------------- (2)\nsm.qqplot(residuals, line='s')\nplt.title('Q-Q Plot')\nplt.show()\n```\n\n::: {.cell-output-display}\n![](predictive_files/figure-html/unnamed-chunk-68-2.png){width=672}\n:::\n\n```{.python .cell-code}\n# 3. Homoscedasticity: Scale-Location Plot ----------------------- (3)\nstandardized_residuals = residuals / np.std(residuals)\nsns.scatterplot(x=fitted_values, y=np.sqrt(np.abs(standardized_residuals)), alpha=0.7)\nplt.xlabel('Fitted values')\nplt.ylabel('Sqrt(|Standardized Residuals|)')\nplt.title('Scale-Location Plot')\nplt.axhline(0, color='black', linestyle='--')\nplt.show()\n```\n\n::: {.cell-output-display}\n![](predictive_files/figure-html/unnamed-chunk-68-3.png){width=672}\n:::\n\n```{.python .cell-code}\n# 4. Independence: Durbin-Watson Test --------------------------- (4)\nfrom statsmodels.stats.stattools import durbin_watson\ndw_stat = durbin_watson(model.resid)\nprint(f'Durbin-Watson statistic: {dw_stat}')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nDurbin-Watson statistic: 2.094763480658097\n```\n\n\n:::\n\n```{.python .cell-code}\n# 5. Multicollinearity: Variance Inflation Factor (VIF) ---------- (5)\nvif_data = pd.DataFrame()\nvif_data[\"feature\"] = X.columns\nfrom statsmodels.stats.outliers_influence import variance_inflation_factor\nvif_data[\"VIF\"] = [variance_inflation_factor(X.values, i) for i in range(X.shape[1])]\nprint(vif_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      feature        VIF\n0       const  15.215689\n1  total_bill   1.665250\n2        size   1.670404\n3  sex_Female   1.070126\n4   smoker_No   1.173230\n5     day_Fri   1.301245\n6     day_Sat   1.644496\n7     day_Sun   1.649463\n```\n\n\n:::\n:::\n\n\n\n\n\n:::\n\n\n\n\n\n\n## Time Series Analysis\n\n## Exercises\n\n1.  Calculate a linear model between PepsiCo stock returns and S&P 500 Market index (the Ticker of S&P 500 Index is `^GSPC`)",
    "supporting": [
      "predictive_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}