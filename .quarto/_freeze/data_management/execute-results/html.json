{
  "hash": "8e3138ca39c17d8d5df895ccba86aa29",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Data Management in Accounting\"\nformat: html\n---\n\n\n### Learning Objectives of the Chapter {.unnumbered}\n\n::: {style=\"text-align: justify\"}\nAt the End of the Chapter, Students should be Able to -\n\n-   Gain an understanding about data management and its importance\n\n-   Understand the Concepts of Relational Database\n\n-   Develop a database using a Database Management System (DBMS)\n\n-   Connect Analytics Platforms Such as R or Python to the database and retrieve data\n\n-   Gain an understanding about Online Analytical Processing (OLAP) DBMS\n\n-   Create and Use OLAP DBMS\n:::\n\n## Data Management\n\n::: {style=\"text-align: justify\"}\n     Data management is the practice of collecting, keeping, and using data securely, efficiently, and cost-effectively. Data management is important for a variety of data-driven use cases including end-to-end business process execution, regulatory compliance, accurate analytics and AI, data migration, and digital transformation.\n\n     Managing digital data in an organization involves a broad range of tasks, policies, procedures, and practices. The work of data management has a wide scope, covering factors such as how to:\n\n-   Create, access, and update data across a diverse data tier\n-   Store data across multiple clouds and on premises\n-   Provide high availability and disaster recovery\n-   Use data in a growing variety of apps, analytics, and algorithms\n-   Ensure data privacy and security\n-   Archive and destroy data in accordance with retention schedules and compliance requirements\n\n     Data management systems are built on data management platforms and can include databases, data lakes and data warehouses, big data management systems, data analytics, and more.\n:::\n\n## Relational Database\n\n::: {style=\"text-align: justify\"}\n     Relational databases organize data into rows and columns, which form a table and different tables are connected to each other usign either **primary key** or **foreign key**. Here’s a simple example of two tables a small business might use to process orders for its products. The first table is a *customer info table*, so each record includes a customer’s name, address, shipping and billing information, phone number, and other contact information. Each bit of information (each attribute) is in its own column, and the database assigns a unique ID (a key) to each row. In the second table—a *customer order* table—each record includes the ID of the customer that placed the order, the product ordered, the quantity, the selected size and color, and so on—but not the customer’s name or contact information.\n\n     These two tables have only one thing in common: the ID column (the key). But because of that common column, the relational database can create a relationship between the two tables. Then, when the company’s order processing application submits an order to the database, the database can go to the customer order table, pull the correct information about the product order, and use the customer ID from that table to look up the customer’s billing and shipping information in the customer info table. The warehouse can then pull the correct product, the customer can receive timely delivery of the order, and the company can get paid.\n:::\n\n## Relational Database Management Systems (RDBMS)\n\n::: {style=\"text-align: justify\"}\n     While a relational database organizes data based off a relational data model, a relational database management system (RDBMS) is a more specific reference to the underlying database software that enables users to maintain it. These programs allow users to create, update, insert, or delete data in the system, and they provide:\n\n-   Data structure\n-   Multi-user access\n-   Privilege control\n-   Network access\n\n     Examples of popular RDBMS systems include MySQL, PostgreSQL, and IBM DB2. Additionally, a relational database system differs from a basic database management system (DBMS) in that it stores data in tables while a DBMS stores information as files.\n:::\n\n## Creating a Relational Database Using `PostgreSQL`\n\n::: {style=\"text-align: justify\"}\n     PostgreSQL is a widely used open-source Relational Database Management System (RDBMS). Since its release in 1996, PostgreSQL has carved a niche as one of the most robust and reliable database systems in the Tech industry. PostgreSQL is known for its rich feature set, reliability, scalability, and strong community support network.\n:::\n\n### Installing PostgreSQL {#sec-installPostgreSQL}\n\n::: {style=\"text-align: justify\"}\n     To install PostgreSQL locally on your computer, visit the [installer by EDB](https://www.w3schools.com/postgresql/postgresql_install.php), and download the newest version compatible with your operating system. To install PostgreSQL on Windows, you need to have administrator privileges. Below, we delineate the steps to install the PostgreSQL in windows.\n\n     **Step 01**: When the downloading is complete, double click the downloaded file and an installation wizard will appear and guide you through multiple steps. Click \"Next\" to specify directory.\n\n![Installation Wizard](images/postgresql_install_image1.png)\n\n     **Step 02**: You can specify the location of PostgreSQL, or go with the default choice\n\n![Installation Directory](images/postgresql_install_image2.png)\n\n     **Step 03**: To use PostgreSQL, you need to install PostgreSQL server. For our installation and uses purposes, we select the following servers - PostgreSQL Server, pgAdmin4, and Command Line Tools.\n\n![Server Selection](images/postgresql_install_image3.png)\n\n     **Step 04**: Then, we need to choose the storage directory. Alternatively, we can go with the default directory.\n\n![Storage Directory](images/postgresql_install_image4.png)\n\n     **Step 05**: At this point, you need to choose your passowrd. It is important to note that the password will be used to connect to the database. Therefore, you must remember your password.\n\n![Password Selection](images/postgresql_install_image5.png)\n\n     **Step 06**: Next you need to select the port. The default port number is 5432. If you change the port, you also need to remember the port number because like passowrd, you need to use the port number to connect to the database.\n\n![Port Selection](images/postgresql_install_image6.png)\n\n     **Step 07**: We also need to select the geographical location of the database server. We can go with the default choice.\n\n![Locale Selection](images/postgresql_install_image7.png)\n\nThen if everything looks ok, you can move forward by clicking 'Next'. However, it is recommended that you copy and save the information from the \"Pre Installation Summary\" in some safe place so that you can access them in future, if necessary.\n\n![Pre Installation Summary](images/postgresql_install_image8.png)\n\n     **Step 08**: Then you can click \"Next\" in 'Ready to Install' windows and the installation process will start and it will take a while to finish the installation. Once the installing is done, please click 'Finish' button on 'Complete the PostgreSQL Setup Wizard' window.\n\n![Ready to Install](images/postgresql_install_image8.png) ![Installing](images/postgresql_install_image8.png) ![Complete the PostgreSQL Setup Wizard](images/postgresql_install_image8.png)\n:::\n\n::: {.callout-tip collapse=\"true\"}\n## Tip\n\nSome good sources to learn more about PostgreSQL -\n\n1.  [W3 Schools](https://www.w3schools.com/postgresql/index.php)\n\n2.  [PostgreSQL Tutorial](https://www.postgresqltutorial.com/postgresql-getting-started/install-postgresql/)\n:::\n\n## Connecting to the Relational Database\n\n::: {style=\"text-align: justify\"}\n     In @sec-installPostgreSQL, we described the steps of installing PostgreSQL database; now, we will try to connect to that database. There are several ways to connect the database we created. These ways include -\n\n-   SQL Shell (psql)\n-   Command Shell (cmd)\n-   pgAdmin 4\n:::\n\n::: {.callout-tip collapse=\"true\"}\n## Tip\n\nTo connect to PostgreSQL Database using pgAdmin 4, pleae use the following link -\n\n1.  [Connecting using pgAdmin 4](https://www.w3schools.com/postgresql/postgresql_pgadmin4.php)\n:::\n\n### Connection using SQL Shell (`psql`)\n\n::: {style=\"text-align: justify\"}\n      First, we will discuss SQL Shell (psql) method. Basically, SQL Shell (psql) is a terminal based program where you can write and execute SQL syntax in the command-line terminal. You will find the SQL Shell (psql) in the start menu under PostgreSQL. If you do not find it please search \"psql\" on windows search box.\n\n![SQL Shell on Start Menu](images/postgresql_connect_image1.png)\n\n     Once the program is open, you should be able to see a window like below. Usually, the name of the server is localhost as shown below; however, if you choose a different server while installing the PostgreSQL, you must mention your server name. Then, click \"enter\" on your keyboard.\n\n![Server](images/postgresql_connect_image2.png)\n\n     The default name of your database is `postgres` as shown below. If you choose a different name, please enter that name. Then, click \"enter\" on your keyboard.\n\n![Database](images/postgresql_connect_image3.png)\n\n     The default port number is `5432`. If you use the default port number, then please click \"enter\" on your keyboard. Otherwise, use the port number that you used while installing PostgreSQL and click \"enter\" on your keyboard.\n\n![Port](images/postgresql_connect_image4.png)\n\n     Similarly, the default user name is `postgres`. Please click \"enter\" on your keyboard if your default name is the same.\n\n![Username](images/postgresql_connect_image5.png)\n\n     Next, you need to provide password that you set while installing the database.\n\n![Password](images/postgresql_connect_image6.png)\n:::\n\n### Connection using Command Shell (`cmd`) {#sec-cmdconnection}\n\n::: {style=\"text-align: justify\"}\n     To use the command prompt (`cmd`) to connect to PostgreSQL database, you need to use the following steps -\n\n-   Step \\# 01 - Open command prompt by writing `cmd` in windows search bar as shown below. Then command prompt will open.\n\n![Search Bar on Windows](images/cmd_1.jpg)\n\n-   Step \\# 02 - type `cd C:\\Program Files\\PostgreSQL\\16\\bin` on the command prompt and hit enter on the keyboard\n\n-   Step \\# 03 - type `psql -h localhost -p 5432 -d postgres -U postgres`\n\n-   Step \\# 04 - Now provide the password that you set while installing PostgreSQL\n\nThese steps should ensure that you are connected to the database.\n:::\n\n## Dealing with the Database {#sec-dealdatabase}\n\n::: {style=\"text-align: justify\"}\n     Once the database is created, new tables can be created. Also, different kinds of data manipulation can be performed. For example, after being connected to the database, one should check the database available by running the following code -\n\n\n::: {.cell}\n\n```{.r .cell-code}\n\\l \n\n# or \n\n\\list\n```\n:::\n\n\n     To connect to a database, one should run the following code -\n\n\n::: {.cell}\n\n```{.r .cell-code}\n\\c name_of_the_database;\n```\n:::\n\n\n     To see all tables in a database, one should run the following code -\n\n\n::: {.cell}\n\n```{.r .cell-code}\n\\dt;\n```\n:::\n\n:::\n\n### Creating a Database and Tables inside the Database {#sec-creatingdatabase}\n\n::: {style=\"text-align: justify\"}\n     To create a database (e.g., `my_database`), one can run the following code -\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCREATE DATABASE my_database;\n```\n:::\n\n\n     To create a table, following code can be run -\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# we are going to create a table called - People\n\nCREATE TABLE People (\n pid int not null,\n prefix text,\n firstName text,\n lastName text,\n suffix text,\n homeCity text,\n DOB date,\n primary key(pid)\n);\n```\n:::\n\n\n     Similarly, four more tables are created by running the following code -\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Table - Customer \n\nCREATE TABLE Customers (\n pid int not null references People(pid),\n paymentTerms text,\n discountPct decimal(5,2),\n primary key(pid)\n);\n\n# Table - Agent \n\nCREATE TABLE Agents (\n pid int not null references People(pid),\n paymentTerms text,\n commissionPct decimal(5,2),\n primary key(pid)\n);\n\n# Table - Products \n\nCREATE TABLE Products (\n prodId char(3) not null,\n name text,\n city text,\n qtyOnHand int,\n priceUSD numeric(10,2),\n primary key(prodId)\n);\n\n# Table - Orders \n\nCREATE TABLE Orders (\n orderNum int not null,\n dateOrdered date not null,\n custId int not null references Customers(pid),\n agentId int not null references Agents(pid),\n prodId char(3) not null references Products(prodId),\n  quantityOrdered integer,\n totalUSD numeric(12,2),\n primary key(orderNum)\n);\n```\n:::\n\n\n     Next, we will populate the tables with different kinds of data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Inserting records into table - People \n\nINSERT INTO People (pid, prefix, firstName, lastName, suffix, homeCity, DOB)\nVALUES\n (001, 'Dr.', 'Neil', 'Peart', 'Ph.D.', 'Toronto', '1952-09-12'),\n (002, 'Ms.', 'Regina', 'Schock', NULL, 'Toronto', '1957-08-31'),\n (003, 'Mr.', 'Bruce', 'Crump', 'Jr.', 'Jacksonville', '1957-07-17'),\n (004, 'Mr.', 'Todd', 'Sucherman', NULL, 'Chicago', '1969-05-02'),\n (005, 'Mr.', 'Bernard', 'Purdie', NULL, 'Teaneck', '1939-06-11'),\n (006, 'Ms.', 'Demetra', 'Plakas', 'Esq.', 'Santa Monica', '1960-11-09'),\n (007, 'Ms.', 'Terri Lyne', 'Carrington', NULL, 'Boston', '1965-08-04'),\n (008, 'Dr.', 'Bill', 'Bruford', 'Ph.D.', 'Kent', '1949-05-17'),\n (009, 'Mr.', 'Alan', 'White', 'III', 'Pelton', '1949-06-14')\n;\n\n# Inserting records into table - Customers \n\nINSERT INTO Customers (pid, paymentTerms, discountPct)\nVALUES\n (001, 'Net 30' , 21.12),\n (004, 'Net 15' , 4.04),\n (005, 'In Advance', 5.50),\n (007, 'On Receipt', 2.00),\n (008, 'Net 30' , 10.00)\n;\n\n# Inserting records into table - Agents \n\nINSERT INTO Agents (pid, paymentTerms, commissionPct)\nVALUES\n (002, 'Quarterly', 5.00),\n (003, 'Annually', 10.00),\n (005, 'Monthly', 2.00),\n (006, 'Weekly', 1.00)\n;\n\n# Inserting records into table - Products \n\nINSERT INTO Products( prodId, name, city, qtyOnHand, priceUSD )\nVALUES\n('p01', 'Heisenberg Compensator', 'Dallas', 47,  67.50),\n('p02', 'Universal Translator', 'Newark', 2399, 5.50 ),\n('p03', 'Commodore PET', 'Duluth', 1979, 65.02 ),\n('p04', 'LCARS module', 'Duluth', 3, 47.00 ),\n('p05', 'Remo drumhead', 'Dallas', 8675309, 16.61 ),\n('p06', 'Trapper Keeper', 'Dallas', 1982, 2.00 ),\n('p07', 'Flux Capacitor', 'Newark', 1007, 1.00 ),\n('p08', 'HAL 9000 memory core', 'Newark', 200, 1.25 ),\n('p09', 'Red Barchetta',  'Toronto', 1, 379000.47 )\n;\n\n\n# Inserting records into table - Orders \n\nINSERT INTO Orders(orderNum, dateOrdered, custId, agentId, prodId, quantityOrdered, totalUSD)\nVALUES\n(1011, '2020-01-23', 001, 002, 'p01', 1100, 58568.40),\n(1012, '2020-01-23', 004, 003, 'p03', 1200, 74871.83),\n(1015, '2020-01-23', 005, 003, 'p05', 1000, 15696.45),\n(1016, '2020-01-23', 008, 003, 'p01', 1000, 60750.00),\n(1017, '2020-02-14', 001, 003, 'p03', 500, 25643.88),\n(1018, '2020-02-14', 001, 003, 'p04', 600, 22244.16),\n(1019, '2020-02-14', 001, 002, 'p02', 400, 1735.36),\n(1020, '2020-02-14', 004, 005, 'p07', 600, 575.76),\n(1021, '2020-02-14', 004, 005, 'p01', 1000, 64773.00),\n(1022, '2020-03-15', 001, 003, 'p06', 450, 709.92),\n(1023, '2020-03-15', 001, 002, 'p05', 500, 6550.984),\n(1024, '2020-03-15', 005, 002, 'p01', 880, 56133.00),\n(1025, '2020-04-01', 008, 003, 'p07', 888, 799.20),\n(1026, '2020-05-01', 008, 005, 'p03', 808, 47282.54)\n;\n```\n:::\n\n:::\n\n### Querying the Database\n\n::: {style=\"text-align: justify\"}\n     Once the database is created, we need to retrieve data from the database for which we need to write queries. For example, we want retireve `prodid`, `name`, and `city` from the table *products*. Then, we need to write the following query -\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# SQL Query = \nSELECT prodid, name, city FROM products;\n\n# Output \n\n prodid |          name          |  city\n--------+------------------------+---------\n p01    | Heisenberg Compensator | Dallas\n p02    | Universal Translator   | Newark\n p03    | Commodore PET          | Duluth\n p04    | LCARS module           | Duluth\n p05    | Remo drumhead          | Dallas\n p06    | Trapper Keeper         | Dallas\n p07    | Flux Capacitor         | Newark\n p08    | HAL 9000 memory core   | Newark\n p09    | Red Barchetta          | Toronto\n(9 rows)\n```\n:::\n\n\n     Similarly, if we want to collect all fields from *products* table for the city *Dallas*, then we can write the following queries -\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# SQL Query = \nSELECT * FROM products WHERE city = 'Dallas';\n\n\n# Output \n\n prodid |          name          |  city  | qtyonhand | priceusd\n--------+------------------------+--------+-----------+----------\n p01    | Heisenberg Compensator | Dallas |        47 |    67.50\n p05    | Remo drumhead          | Dallas |   8675309 |    16.61\n p06    | Trapper Keeper         | Dallas |      1982 |     2.00\n(3 rows)\n```\n:::\n\n:::\n\n### Saving a Database from PostgreSQL\n\n::: {style=\"text-align: justify\"}\n     In order to share a database with stakeholders, we need to save the a particular database. Therefore, knowing how to save the database is very important. We must use the Command Prompt (`cmd`) to save a database. First, we need to open a command prompt following step \\# 01 in @sec-cmdconnection. Then we need to write the following codes on command prompt -\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# First line of code and then hit enter on the Keyboard\ncd ..\n# Second line of code and then hit enter on the Keyboard\ncd ..\n# Third line of code and then hit enter on the Keyboard\ncd \\Program Files\\PostgreSQL\\16\\bin\n# Fourth line of code and then hit enter on the Keyboard\npg_dump -h localhost -d name_of_your_database -U postgres -p 5433 -F tar >K:\\name_of_your_database.tar\n# Fifth Line of code - provide your password\n```\n:::\n\n\n::: {.callout-tip collapse=\"true\"}\n## Tip\n\nYou can watch the youtube video to learn more about how to save a database from PostgreSQL - <https://www.youtube.com/watch?v=sa5VXDG_aW8>\n:::\n\n     In the fourth line of code above - `pg_dump -h localhost -d name_of_your_database -U postgres -p 5433 -F tar >K:\\name_of_your_database.tar`- the \"`name_of_your_database`\" is the database name that you want to save to share and \"`K:\\\\`\" is the directory (folder) address (path) on which you want to save your database and \"`name_of_your_database`\" is the name of the database that you would like to assign to the saved database and \".tar\" is the file extension. It is important to note that when you run the fourth line of code above, it might show the message - \"**Access is denied**\". In such situation, you should change the path (address) of the directory in which you would like to save the database.\n:::\n\n### Uploading a Database to PostgreSQL\n\n::: {style=\"text-align: justify\"}\n     Sometimes, you might need to upload a database to PostgreSQL. Therefore, you should know how you can upload the database to PostgreSQL. First, you should create a database following the process as described in @sec-creatingdatabase. For example, we create a database called `my_database` in PostgreSQL. Assume that the database that we want to upload to PostgreSQL is in the path - `K:\\` and the name of the database is `my_database_upload`. Therefore, the complete path of the database to be uploaded is - \"`K:\\my_database_upload.tar`\". Then, you should open a command prompt as described in @sec-cmdconnection. Then run the following code -\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# First line of code and then hit enter on the Keyboard\ncd ..\n# Second line of code and then hit enter on the Keyboard\ncd ..\n# Third line of code and then hit enter on the Keyboard\ncd \\Program Files\\PostgreSQL\\16\\bin\n# Fourth line of code and then hit enter on the Keyboard\npg_restore -h localhost -p 5433 -d my_database -U postgres -v \"K:\\my_database_upload.tar\"\n# Fifth Line of code - provide your password\n```\n:::\n\n\n     In the fourth line of code above - `pg_restore -h localhost -p 5433 -d my_database -U postgres -v \"K:\\my_database_upload.tar\"`- \"`my_database`\" is the name of the database that you created on the PostgreSQL and \"`K:\\my_database_upload.tar`\" is the path of the database to be uploaded.\n\n     Once you upload the database to the PostgreSQL , you can check whether the database is uploaded by following @sec-dealdatabase.\n:::\n\n## Querying PostgreSQL Database Using `R`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Importing Necessary Packages\nlibrary(DBI)\nlibrary(RPostgres)\nlibrary(askpass)\nlibrary(tidyverse)\n```\n:::\n\n\n     In order to connect to the local postgreSQL database, you can run the following code. However, there is a problem that if you publish this connection code, your password will be shared; therefore, it is better not to share the password. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Connecting to PostgreSQL Database \ncon = dbConnect(RPostgres::Postgres()\n                 , host='localhost'\n                 , port='5433'\n                 , dbname='my_database',\n                 , user='postgres'\n                 , password=\"YourPassword\") \n```\n:::\n\n\n     For the below code, first we set the password in environment variable in R environment. Since I use IDE `Positron` (or VS Code), I get access to the environment by running the following code. Then, the password is stored by running the code - `POSTGRESS_PASSWORD=\"YOURPASSWORD\"`. Replace, the word \"YOURPASSWORD\" with your own password and save the file.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(usethis)\nusethis::edit_r_environ()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Connecting to PostgreSQL Database \ncon = dbConnect(RPostgres::Postgres()\n                 , host='localhost'\n                 , port='5433'\n                 , dbname='my_database',\n                 , user='postgres'\n                 , password= Sys.getenv(\"POSTGRESS_PASSWORD\")\n                 )\n```\n:::\n\n\n     Alternatively, you can use `askpass` package to input your password without sharing your password with third party. \n\n::: {.cell}\n\n```{.r .cell-code}\n# Connecting to PostgreSQL Database \ncon = dbConnect(RPostgres::Postgres()\n                 , host='localhost'\n                 , port='5433'\n                 , dbname='my_database',\n                 , user='postgres'\n                 , password=askpass::askpass(\"Enter your database password (R):\")\n                 )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Checking all Tables in the Database \ndbListTables(con)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"agents\"    \"customers\" \"orders\"    \"people\"    \"products\" \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# To see a table \ncon %>%\n  tbl ('orders') \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Source:   table<\"orders\"> [?? x 7]\n# Database: postgres  [postgres@localhost:5433/my_database]\n   ordernum dateordered custid agentid prodid quantityordered totalusd\n      <int> <date>       <int>   <int> <chr>            <int>    <dbl>\n 1     1011 2020-01-23       1       2 p01               1100   58568.\n 2     1012 2020-01-23       4       3 p03               1200   74872.\n 3     1015 2020-01-23       5       3 p05               1000   15696.\n 4     1016 2020-01-23       8       3 p01               1000   60750 \n 5     1017 2020-02-14       1       3 p03                500   25644.\n 6     1018 2020-02-14       1       3 p04                600   22244.\n 7     1019 2020-02-14       1       2 p02                400    1735.\n 8     1020 2020-02-14       4       5 p07                600     576.\n 9     1021 2020-02-14       4       5 p01               1000   64773 \n10     1022 2020-03-15       1       3 p06                450     710.\n# ℹ more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncon %>%\n  tbl ('orders') %>%\n  collect ()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 14 × 7\n   ordernum dateordered custid agentid prodid quantityordered totalusd\n      <int> <date>       <int>   <int> <chr>            <int>    <dbl>\n 1     1011 2020-01-23       1       2 p01               1100   58568.\n 2     1012 2020-01-23       4       3 p03               1200   74872.\n 3     1015 2020-01-23       5       3 p05               1000   15696.\n 4     1016 2020-01-23       8       3 p01               1000   60750 \n 5     1017 2020-02-14       1       3 p03                500   25644.\n 6     1018 2020-02-14       1       3 p04                600   22244.\n 7     1019 2020-02-14       1       2 p02                400    1735.\n 8     1020 2020-02-14       4       5 p07                600     576.\n 9     1021 2020-02-14       4       5 p01               1000   64773 \n10     1022 2020-03-15       1       3 p06                450     710.\n11     1023 2020-03-15       1       2 p05                500    6551.\n12     1024 2020-03-15       5       2 p01                880   56133 \n13     1025 2020-04-01       8       3 p07                888     799.\n14     1026 2020-05-01       8       5 p03                808   47283.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Selecting some columns \ncon %>%\n  tbl ('orders') %>%\n  select (ordernum, dateordered, custid, agentid)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Source:   SQL [?? x 4]\n# Database: postgres  [postgres@localhost:5433/my_database]\n   ordernum dateordered custid agentid\n      <int> <date>       <int>   <int>\n 1     1011 2020-01-23       1       2\n 2     1012 2020-01-23       4       3\n 3     1015 2020-01-23       5       3\n 4     1016 2020-01-23       8       3\n 5     1017 2020-02-14       1       3\n 6     1018 2020-02-14       1       3\n 7     1019 2020-02-14       1       2\n 8     1020 2020-02-14       4       5\n 9     1021 2020-02-14       4       5\n10     1022 2020-03-15       1       3\n# ℹ more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filtering some rows\ncon %>% \n  tbl ('products') %>%\n  filter (city == \"Dallas\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Source:   SQL [3 x 5]\n# Database: postgres  [postgres@localhost:5433/my_database]\n  prodid name                   city   qtyonhand priceusd\n  <chr>  <chr>                  <chr>      <int>    <dbl>\n1 p01    Heisenberg Compensator Dallas        47     67.5\n2 p05    Remo drumhead          Dallas   8675309     16.6\n3 p06    Trapper Keeper         Dallas      1982      2  \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# showing the SQL query\ncon %>% \n  tbl ('products') %>%\n  filter (city == \"Dallas\") %>%\n  show_query()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<SQL>\nSELECT \"products\".*\nFROM \"products\"\nWHERE (\"city\" = 'Dallas')\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Disconnecting the database \ncon %>% dbDisconnect ()\n```\n:::\n\n\n\n\n## Querying PostgreSQL Database Using `Python`\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Importing Necessary Python Packages \nimport ibis\nimport getpass\nimport os \n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n# To know more about the next line of code\n# see - https://ibis-project.org/tutorials/ibis-for-dplyr-users\nibis.options.interactive = True\n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n# to connect to the database \nconn = ibis.postgres.connect(\n    user='postgres', \n    password = 'YourPassword',\n    host = \"localhost\",\n    port = 5433,\n    database = \"my_database\" # here our database name will be 'dvdrental'\n)\n```\n:::\n\n\n     Like before, if you do not share your password, please get the password from environment. \n\n\n::: {.cell}\n\n```{.python .cell-code}\n# to connect to the database \nconn = ibis.postgres.connect(\n    user='postgres', \n    password = os.getenv(\"POSTGRESS_PASSWORD\"),\n    host = \"localhost\",\n    port = 5433,\n    database = \"dvdrental\"\n)\n```\n:::\n\n\n     If you do not know how to set the password in python environment, please follow these steps - \n\n1. Crate a `.env` file in your working directory. You can create the `.env` file using notepad, but not that the extension of the file `.txt` must be deleted. Once the `.env` file is created, then save your password as you did in R enviornment. For example - save the line - `POSTGRESS_PASSWORD=\"YOURPASSWORD\"`, where replace the word YOURPASSWORD with your own password. \n\n2. Then, if necessary, please install python package `python-dotenv` by running the code in terminal - `pip install python-dotenv`. Once the package is installed, please run the following code to get connected to your local postgreSQL database. \n\n\n::: {.cell}\n\n```{.python .cell-code}\n# load environment variable from .env file \nload_dotenv()\n\n# Connect to your PostgreSQL database \nconn = ibis.postgres.connect(\n    user='postgres',\n    password=os.getenv('POSTGRESS_PASSWORD'),\n    host='localhost',\n    port=5433,\n    database='my_database'\n)\n```\n:::\n\n\n\n     Alternatively, you can use `getpass` python package, which is very similar to `askpass` package in R.  \n\n\n::: {.cell}\n\n```{.python .cell-code}\n# to connect to the database \nconn = ibis.postgres.connect(\n    user='postgres', \n    password = getpass.getpass(\"Enter your database password (Python): \"),\n    host = \"localhost\",\n    port = 5433,\n    database = \"dvdrental\"\n)\n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n# See all tables in a database \nconn.list_tables()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n['actor', 'actor_info', 'address', 'category', 'city', 'country', 'customer', 'customer_list', 'ff48_df', 'film', 'film_actor', 'film_category', 'film_list', 'inventory', 'language', 'nicer_but_slower_film_list', 'payment', 'rental', 'sales_by_film_category', 'sales_by_store', 'staff', 'staff_list', 'store']\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n# To know the total number of rows \nconn.table('actor').count() # total rows \n```\n\n::: {.cell-output-display}\n\n```{=html}\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\nconn.table('actor').columns # name of the columns \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n['actor_id', 'first_name', 'last_name', 'last_update']\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n# To see the SQL command \nconn.table('actor').compile()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'SELECT * FROM \"actor\"'\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n# Dealing with a table \nconn.table('country')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n┌────────────┬────────────────┬─────────────────────┐\n│ country_id │ country        │ last_update         │\n├────────────┼────────────────┼─────────────────────┤\n│ !int32     │ !string        │ !timestamp(6)       │\n├────────────┼────────────────┼─────────────────────┤\n│          1 │ Afghanistan    │ 2006-02-15 09:44:00 │\n│          2 │ Algeria        │ 2006-02-15 09:44:00 │\n│          3 │ American Samoa │ 2006-02-15 09:44:00 │\n│          4 │ Angola         │ 2006-02-15 09:44:00 │\n│          5 │ Anguilla       │ 2006-02-15 09:44:00 │\n│          6 │ Argentina      │ 2006-02-15 09:44:00 │\n│          7 │ Armenia        │ 2006-02-15 09:44:00 │\n│          8 │ Australia      │ 2006-02-15 09:44:00 │\n│          9 │ Austria        │ 2006-02-15 09:44:00 │\n│         10 │ Azerbaijan     │ 2006-02-15 09:44:00 │\n│          … │ …              │ …                   │\n└────────────┴────────────────┴─────────────────────┘\n```\n\n\n:::\n\n```{.python .cell-code}\nconn.table('country').head(5).execute()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   country_id         country         last_update\n0           1     Afghanistan 2006-02-15 09:44:00\n1           2         Algeria 2006-02-15 09:44:00\n2           3  American Samoa 2006-02-15 09:44:00\n3           4          Angola 2006-02-15 09:44:00\n4           5        Anguilla 2006-02-15 09:44:00\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n## describe () or columns () equivalent to glimpse ()\nconn.table('country').describe\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<bound method Table.describe of ┌────────────┬────────────────┬─────────────────────┐\n│ country_id │ country        │ last_update         │\n├────────────┼────────────────┼─────────────────────┤\n│ !int32     │ !string        │ !timestamp(6)       │\n├────────────┼────────────────┼─────────────────────┤\n│          1 │ Afghanistan    │ 2006-02-15 09:44:00 │\n│          2 │ Algeria        │ 2006-02-15 09:44:00 │\n│          3 │ American Samoa │ 2006-02-15 09:44:00 │\n│          4 │ Angola         │ 2006-02-15 09:44:00 │\n│          5 │ Anguilla       │ 2006-02-15 09:44:00 │\n│          6 │ Argentina      │ 2006-02-15 09:44:00 │\n│          7 │ Armenia        │ 2006-02-15 09:44:00 │\n│          8 │ Australia      │ 2006-02-15 09:44:00 │\n│          9 │ Austria        │ 2006-02-15 09:44:00 │\n│         10 │ Azerbaijan     │ 2006-02-15 09:44:00 │\n│          … │ …              │ …                   │\n└────────────┴────────────────┴─────────────────────┘>\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n# filtering rows    \nconn.table('country')[conn.table('country')['country']==\"Zambia\"] \\\n    .execute()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   country_id country         last_update\n0         109  Zambia 2006-02-15 09:44:00\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n# Selecting Columns \nconn.table('country')[[\"country_id\", \"country\"]]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n┌────────────┬────────────────┐\n│ country_id │ country        │\n├────────────┼────────────────┤\n│ !int32     │ !string        │\n├────────────┼────────────────┤\n│          1 │ Afghanistan    │\n│          2 │ Algeria        │\n│          3 │ American Samoa │\n│          4 │ Angola         │\n│          5 │ Anguilla       │\n│          6 │ Argentina      │\n│          7 │ Armenia        │\n│          8 │ Australia      │\n│          9 │ Austria        │\n│         10 │ Azerbaijan     │\n│          … │ …              │\n└────────────┴────────────────┘\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n# Arrange \n\nconn.table('rental') \\\n    .order_by(['inventory_id'])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n┌───────────┬─────────────────────┬──────────────┬─────────────┬───┐\n│ rental_id │ rental_date         │ inventory_id │ customer_id │ … │\n├───────────┼─────────────────────┼──────────────┼─────────────┼───┤\n│ !int32    │ !timestamp(6)       │ !int32       │ !int16      │ … │\n├───────────┼─────────────────────┼──────────────┼─────────────┼───┤\n│      4863 │ 2005-07-08 19:03:15 │            1 │         431 │ … │\n│     11433 │ 2005-08-02 20:13:10 │            1 │         518 │ … │\n│     14714 │ 2005-08-21 21:27:43 │            1 │         279 │ … │\n│       972 │ 2005-05-30 20:21:07 │            2 │         411 │ … │\n│      2117 │ 2005-06-17 20:24:00 │            2 │         170 │ … │\n│      4187 │ 2005-07-07 10:41:31 │            2 │         161 │ … │\n│      9449 │ 2005-07-30 22:02:34 │            2 │         581 │ … │\n│     15453 │ 2005-08-23 01:01:01 │            2 │         359 │ … │\n│     10126 │ 2005-07-31 21:36:07 │            3 │          39 │ … │\n│     15421 │ 2005-08-22 23:56:37 │            3 │         541 │ … │\n│         … │ …                   │            … │           … │ … │\n└───────────┴─────────────────────┴──────────────┴─────────────┴───┘\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n# Group By\nconn.table('payment')[['payment_id', 'customer_id', 'staff_id', 'amount']] \\\n    .execute() \\\n    .groupby('customer_id').agg({'amount': 'mean'}) \\\n    .reset_index() \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     customer_id    amount\n0              1  3.823333\n1              2  4.759231\n2              3  5.448333\n3              4  3.717273\n4              5  3.847143\n..           ...       ...\n594          595  3.817586\n595          596  3.353636\n596          597  3.816087\n597          598  3.808182\n598          599  4.378889\n\n[599 rows x 2 columns]\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n# To disconnect the database \nconn.disconnect()\n```\n:::\n\n\n## Online Analytical Processing (OLAP) Database Management System\n\n## Conclusion\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}